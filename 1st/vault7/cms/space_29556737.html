<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="icon" type="image/png" href="http://localhost:6081/IMG/favicon.ico">
        <title></title>
        <link href="../../bootstrap/css/bootstrap.min.css" rel="stylesheet">
        <link href="../../bootstrap/css/cerulean.min.css" rel="stylesheet">
        <link href="../../bootstrap/css/new-gen.css" rel="stylesheet">
        <link href="../../css/leak-styles.css" rel="stylesheet">
        <link href="../../highlighter/efatmarker.css" rel="stylesheet">
        <style>
          #efm-button {margin:0 0 4px 0;padding:0 0 0 30px;position:fixed;height:48px;width:52px;bottom:0;right:0;background:transparent '/highlighter/kedit-2.png' no-repeat bottom right;cursor:pointer;opacity:0.4;z-index:99999999999}
          #efm-button:hover {opacity:1}
          #efm-button #efm-menu {margin:0 0 52px 0;border:1px outset gray;padding:0;display:none;background:#eee;position:fixed;bottom:0;right:0;width:20em;opacity:1;cursor:auto}
          #efm-button:hover #efm-menu {display:block;font-size:smaller;color:#999}
          #efm-button #efm-menu p {margin:0;padding:0 3px}
          #efm-button #efm-menu a {margin:1px;padding:3px 3px;display:block;font:12px sans-serif;white-space:nowrap;opacity:inherit;cursor:pointer}
          #efm-button #efm-menu a:hover {color:black;background-color:white;opacity:1}
          #efm-button #efm-menu a > span {color:gray;position:absolute;right:4px}
          .efm-hi {background-color:#ff8;font-weight:normal;}
        </style>
        <link href="../../bootstrap/css/submit.css" rel="stylesheet">
        <link href="main.css" rel="stylesheet">
    </head>
    <body>
        <div id="submit_wlkey" class="submit_elem">
	<div class="container">
		<div class="text-center"><div class="submit_buttons btn-group" role="group">
			<a href="space_29556737.html#submit_help_contact" class="btn-wl btn-wl-empty">How to contact WikiLeaks?</a>
			<a href="space_29556737.html#submit_help_tor" class="btn-wl btn-wl-empty">What is Tor?</a>
			<a href="space_29556737.html#submit_help_tips" class="btn-wl btn-wl-empty">Tips for Sources</a>
			<a href="space_29556737.html#submit_help_after" class="btn-wl btn-wl-empty">After Submitting</a>
		</div></div>
		<p>This key's fingerprint is A04C 5E09 ED02 B328 03EB  6116 93ED 732E 9231 8DBA</p>
		<pre>
-----BEGIN PGP PUBLIC KEY BLOCK-----

mQQNBFUoCGgBIADFLp+QonWyK8L6SPsNrnhwgfCxCk6OUHRIHReAsgAUXegpfg0b
rsoHbeI5W9s5to/MUGwULHj59M6AvT+DS5rmrThgrND8Dt0dO+XW88bmTXHsFg9K
jgf1wUpTLq73iWnSBo1m1Z14BmvkROG6M7+vQneCXBFOyFZxWdUSQ15vdzjr4yPR
oMZjxCIFxe+QL+pNpkXd/St2b6UxiKB9HT9CXaezXrjbRgIzCeV6a5TFfcnhncpO
ve59rGK3/az7cmjd6cOFo1Iw0J63TGBxDmDTZ0H3ecQvwDnzQSbgepiqbx4VoNmH
OxpInVNv3AAluIJqN7RbPeWrkohh3EQ1j+lnYGMhBktX0gAyyYSrkAEKmaP6Kk4j
/ZNkniw5iqMBY+v/yKW4LCmtLfe32kYs5OdreUpSv5zWvgL9sZ+4962YNKtnaBK3
1hztlJ+xwhqalOCeUYgc0Clbkw+sgqFVnmw5lP4/fQNGxqCO7Tdy6pswmBZlOkmH
XXfti6hasVCjT1MhemI7KwOmz/KzZqRlzgg5ibCzftt2GBcV3a1+i357YB5/3wXE
j0vkd+SzFioqdq5Ppr+//IK3WX0jzWS3N5Lxw31q8fqfWZyKJPFbAvHlJ5ez7wKA
1iS9krDfnysv0BUHf8elizydmsrPWN944Flw1tOFjW46j4uAxSbRBp284wiFmV8N
TeQjBI8Ku8NtRDleriV3djATCg2SSNsDhNxSlOnPTM5U1bmh+Ehk8eHE3hgn9lRp
2kkpwafD9pXaqNWJMpD4Amk60L3N+yUrbFWERwncrk3DpGmdzge/tl/UBldPoOeK
p3shjXMdpSIqlwlB47Xdml3Cd8HkUz8r05xqJ4DutzT00ouP49W4jqjWU9bTuM48
LRhrOpjvp5uPu0aIyt4BZgpce5QGLwXONTRX+bsTyEFEN3EO6XLeLFJb2jhddj7O
DmluDPN9aj639E4vjGZ90Vpz4HpN7JULSzsnk+ZkEf2XnliRody3SwqyREjrEBui
9ktbd0hAeahKuwia0zHyo5+1BjXt3UHiM5fQN93GB0hkXaKUarZ99d7XciTzFtye
/MWToGTYJq9bM/qWAGO1RmYgNr+gSF/fQBzHeSbRN5tbJKz6oG4NuGCRJGB2aeXW
TIp/VdouS5I9jFLapzaQUvtdmpaeslIos7gY6TZxWO06Q7AaINgr+SBUvvrff/Nl
l2PRPYYye35MDs0b+mI5IXpjUuBC+s59gI6YlPqOHXkKFNbI3VxuYB0VJJIrGqIu
Fv2CXwy5HvR3eIOZ2jLAfsHmTEJhriPJ1sUG0qlfNOQGMIGw9jSiy/iQde1u3ZoF
so7sXlmBLck9zRMEWRJoI/mgCDEpWqLX7hTTABEBAAG0x1dpa2lMZWFrcyBFZGl0
b3JpYWwgT2ZmaWNlIEhpZ2ggU2VjdXJpdHkgQ29tbXVuaWNhdGlvbiBLZXkgKFlv
dSBjYW4gY29udGFjdCBXaWtpTGVha3MgYXQgaHR0cDovL3dsY2hhdGMzcGp3cGxp
NXIub25pb24gYW5kIGh0dHBzOi8vd2lraWxlYWtzLm9yZy90YWxrKSA8Y29udGFj
dC11cy11c2luZy1vdXItY2hhdC1zeXN0ZW1Ad2lraWxlYWtzLm9yZz6JBD0EEwEK
ACcCGwMFCwkIBwMFFQoJCAsFFgIDAQACHgECF4AFAlb6cdIFCQOznOoACgkQk+1z
LpIxjbrlqh/7B2yBrryWhQMGFj+xr9TIj32vgUIMohq94XYqAjOnYdEGhb5u5B5p
BNowcqdFB1SOEvX7MhxGAqYocMT7zz2AkG3kpf9f7gOAG7qA1sRiB+R7mZtUr9Kv
fQSsRFPb6RNzqqB9I9wPNGhBh1YWusUPluLINwbjTMnHXeL96HgdLT+fIBa8ROmn
0fjJVoWYHG8QtsKiZ+lo2m/J4HyuJanAYPgL6isSu/1bBSwhEIehlQIfXZuS3j35
12SsO1Zj2BBdgUIrADdMAMLneTs7oc1/PwxWYQ4OTdkay2deg1g/N6YqM2N7rn1W
7A6tmuH7dfMlhcqw8bf5veyag3RpKHGcm7utDB6k/bMBDMnKazUnM2VQoi1mutHj
kTCWn/vF1RVz3XbcPH94gbKxcuBi8cjXmSWNZxEBsbirj/CNmsM32Ikm+WIhBvi3
1mWvcArC3JSUon8RRXype4ESpwEQZd6zsrbhgH4UqF56pcFT2ubnqKu4wtgOECsw
K0dHyNEiOM1lL919wWDXH9tuQXWTzGsUznktw0cJbBVY1dGxVtGZJDPqEGatvmiR
o+UmLKWyxTScBm5o3zRm3iyU10d4gka0dxsSQMl1BRD3G6b+NvnBEsV/+KCjxqLU
vhDNup1AsJ1OhyqPydj5uyiWZCxlXWQPk4p5WWrGZdBDduxiZ2FTj17hu8S4a5A4
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
J3x7gtxUMkTadELqwY6hrU8=
=BLTH
-----END PGP PUBLIC KEY BLOCK-----
		</pre>
	</div>
</div>

<div id="submit_help_contact" class="submit_elem">
	<div class="container">
		<div class="text-center"><div class="submit_buttons btn-group" role="group">
			<a href="space_29556737.html#submit_help_contact" class="btn-wl">How to contact WikiLeaks?</a>
			<a href="space_29556737.html#submit_help_tor" class="btn-wl btn-wl-empty">What is Tor?</a>
			<a href="space_29556737.html#submit_help_tips" class="btn-wl btn-wl-empty">Tips for Sources</a>
			<a href="space_29556737.html#submit_help_after" class="btn-wl btn-wl-empty">After Submitting</a>
		</div></div>

		<h3>Contact</h3>
		<p>If you need help using Tor you can contact WikiLeaks for assistance in setting it up using our simple webchat available at: <a href="https://wikileaks.org/talk">https://wikileaks.org/talk</a></p>
		<p>If you can use Tor, but need to contact WikiLeaks for other reasons use our secured webchat available at <b>http://wlchatc3pjwpli5r.onion</b></p>
		<p>We recommend contacting us over Tor if you can.</p>
	</div>
</div>

<div id="submit_help_tor" class="submit_elem">
	<div class="container">
		<div class="text-center"><div class="submit_buttons btn-group" role="group">
			<a href="space_29556737.html#submit_help_contact" class="btn-wl btn-wl-empty">How to contact WikiLeaks?</a>
			<a href="space_29556737.html#submit_help_tor" class="btn-wl">What is Tor?</a>
			<a href="space_29556737.html#submit_help_tips" class="btn-wl btn-wl-empty">Tips for Sources</a>
			<a href="space_29556737.html#submit_help_after" class="btn-wl btn-wl-empty">After Submitting</a>
		</div></div>

		<h3>Tor</h3>
		<p><a href="https://www.torproject.org">Tor</a> is an encrypted anonymising network that makes it harder to intercept internet communications, or see where communications are coming from or going to.</p>
		<p>In order to use the WikiLeaks public submission system as detailed above you can download the Tor Browser Bundle, which is a Firefox-like browser available for Windows, Mac OS X and GNU/Linux and pre-configured to connect using the anonymising system Tor.</p>
		<h4>Tails</h4>
		<p>If you are at high risk and you have the capacity to do so, you can also access the submission system through a secure operating system called <a href="https://tails.boum.org">Tails</a>. Tails is an operating system launched from a USB stick or a DVD that aim to leaves no traces when the computer is shut down after use and automatically routes your internet traffic through Tor. Tails will require you to have either a USB stick or a DVD at least 4GB big and a laptop or desktop computer.</p>
	</div>
</div>

<div id="submit_help_tips" class="submit_elem">
	<div class="container">
		<div class="text-center">
			<div class="submit_buttons btn-group" role="group">
				<a href="space_29556737.html#submit_help_contact" class="btn-wl btn-wl-empty">How to contact WikiLeaks?</a>
				<a href="space_29556737.html#submit_help_tor" class="btn-wl btn-wl-empty">What is Tor?</a>
				<a href="space_29556737.html#submit_help_tips" class="btn-wl">Tips for Sources</a>
				<a href="space_29556737.html#submit_help_after" class="btn-wl btn-wl-empty">After Submitting</a>
			</div>
		</div>

		<h3>Tips</h3>
		<p>Our submission system works hard to preserve your anonymity, but we recommend you also take some of your own precautions. Please review these basic guidelines. </p>
		<div>
			<h4>1. Contact us if you have specific problems</h4>
			<p>If you have a very large submission, or a submission with a complex format, or are a high-risk source, please <a href="space_29556737.html#submit_help_contact">contact us</a>. In our experience it is always possible to find a custom solution for even the most seemingly difficult situations.</p>
		</div>
		<div>
			<h4>2. What computer to use</h4>
			<p>If the computer you are uploading from could subsequently be audited in an investigation, consider using a computer that is not easily tied to you. Technical users can also use <a href="https://tails.boum.org">Tails</a> to help ensure you do not leave any records of your submission on the computer.</p>
		</div>
		<div>
			<h4>3. Do not talk about your submission to others</h4>
			<p>If you have any issues talk to WikiLeaks. We are the global experts in source protection – it is a complex field. Even those who mean well often do not have the experience or expertise to advise properly. This includes other media organisations.</p>
		</div>

	</div>
</div>

<div id="submit_help_after" class="submit_elem">
	<div class="container">
		<div class="text-center">
			<div class="submit_buttons btn-group" role="group">
				<a href="space_29556737.html#submit_help_contact" class="btn-wl btn-wl-empty">How to contact WikiLeaks?</a>
				<a href="space_29556737.html#submit_help_tor" class="btn-wl btn-wl-empty">What is Tor?</a>
				<a href="space_29556737.html#submit_help_tips" class="btn-wl btn-wl-empty">Tips for Sources</a>
				<a href="space_29556737.html#submit_help_after" class="btn-wl">After Submitting</a>
			</div>
		</div>

		<h3>After</h3>

		<div>
			<h4>1. Do not talk about your submission to others</h4>
			<p>If you have any issues talk to WikiLeaks. We are the global experts in source protection – it is a complex field. Even those who mean well often do not have the experience or expertise to advise properly. This includes other media organisations.</p>
		</div>

		<div>
			<h4>2. Act normal</h4>
			<p>If you are a high-risk source, avoid saying anything or doing anything after submitting which might promote suspicion. In particular, you should try to stick to your normal routine and behaviour.</p>
		</div>

		<div>
			<h4>3. Remove traces of your submission</h4>
			<p>If you are a high-risk source and the computer you prepared your submission on, or uploaded it from, could subsequently be audited in an investigation, we recommend that you format and dispose of the computer hard drive and any other storage media you used.</p>
			<p>In particular, hard drives retain data after formatting which may be visible to a digital forensics team and flash media (USB sticks, memory cards and SSD drives) retain data even after a secure erasure. If you used flash media to store sensitive data, it is important to destroy the media.</p>
			<p>If you do this and are a high-risk source you should make sure there are no traces of the clean-up, since such traces themselves may draw suspicion.</p>
			<div>
				<h4>4. If you face legal action</h4>
				<p>If a legal action is brought against you as a result of your submission, there are organisations that may help you. The Courage Foundation is an international organisation dedicated to the protection of journalistic sources. You can find more details at <a href="https://www.couragefound.org">https://www.couragefound.org</a>.</p>
			</div>
		</div>
	</div>
</div>

<div id="submit" class="submit_banner">
	<div class="container">
		<div class="page-header">
			<h1>Submit documents to WikiLeaks</h1>
			<a class="remove-button" href="space_29556737.html#"><span class="glyphicon glyphicon-remove-circle"></span></a>
		</div>
		<p>WikiLeaks publishes documents of political or historical importance that are censored or otherwise suppressed. We specialise in strategic global publishing and large archives.</p>
		<p>The following is the address of our secure site where you can anonymously upload your documents to WikiLeaks editors. You can only access this submissions system through Tor. (See our <a href="space_29556737.html#submit_help_tor">Tor tab</a> for more information.) We also advise you to read our <a href="space_29556737.html#submit_help_tips">tips for sources</a> before submitting.</p>

		<div class="alert alert-info">
			<div class="onion-url">wlupld3ptjvsgwqw.onion</div>
			<div>
				Copy this address into your Tor browser. Advanced users, if they wish, can also add a further layer of encryption to their submission using <a href="space_29556737.html#submit_wlkey">our public PGP key</a>.
			</div>
		</div>

		<p>If you cannot use Tor, or your submission is very large, or you have specific requirements, WikiLeaks provides several alternative methods. <a href="space_29556737.html#submit_help_contact">Contact us</a> to discuss how to proceed.</p>
	</div>
</div>
<div id="submit_help_buttons" class="submit_elem">
	<div class="container">
		<div class="text-center">
			<div class="submit_buttons btn-group" role="group">
				<a href="space_29556737.html#submit_help_contact" class="btn-wl btn-wl-empty">How to contact WikiLeaks?</a>
				<a href="space_29556737.html#submit_help_tor" class="btn-wl btn-wl-empty">What is Tor?</a>
				<a href="space_29556737.html#submit_help_tips" class="btn-wl btn-wl-empty">Tips for Sources</a>
				<a href="space_29556737.html#submit_help_after" class="btn-wl btn-wl-empty">After Submitting</a>
			</div>
		</div>
	</div>
</div>

        <div id="main">
            

<link href="../../static/css/styles_topnav.css" rel="stylesheet">
<link href="../../static/css/styles_sidenav.css" rel="stylesheet">
<div class="top-navigation">
  <nav class="navbar">
      <a href="space_29556737.html#menu" class="mobile-only hot-dog nav-element">
      </a>
    <div class="nav-logo">
      <a href="https://wikileaks.org">
        <h1>WikiLeaks</h1>
      </a>
    </div>
    <div class="action-buttons">
      <a class="button-face support-link" href="https://wikileaks.spreadshirt.com/" target="_blank">Shop</a>
      <a class="button-face donate-link" href="https://shop.wikileaks.org/donate">Donate</a>
      <a class="button-face submit-link" href="space_29556737.html#submit">Submit</a>
    </div>
    <form class="global-search" method="get" action="https://search.wikileaks.org/">
      <input type="text" name="q" placeholder="Search">
      <button class="btn-search" type="submit"></button>
    </form>
    <div class="main-nav">
      
        <ul class="first-level">
          
            <li>
              <a class=" leaks-menu-item" href="https://wikileaks.org/-Leaks-.html">Leaks</a>
            </li>
          
            <li>
              <a class=" news-menu-item" href="https://wikileaks.org/-News-.html">News</a>
            </li>
          
            <li>
              <a class=" about-menu-item" href="https://wikileaks.org/-About-66-.html">About</a>
            </li>
          
            <li>
              <a class=" partners-menu-item" href="https://wikileaks.org/-Partners-.html">Partners</a>
            </li>
          
        </ul>
      
    </div>
  </nav>
</div><nav id="menu" class="side-nav rub">
  <div class="menu-wrapper">
    <a class="close-btn nav-element" href="space_29556737.html#"></a>
    
      <ul class="first-level">
        
          <li>
            <a class=" leaks-menu-item" href="https://wikileaks.org/-Leaks-.html">Leaks</a>
            
          </li>
        
          <li>
            <a class=" news-menu-item" href="https://wikileaks.org/-News-.html">News</a>
            
          </li>
        
          <li>
            <a class=" about-menu-item" href="https://wikileaks.org/-About-66-.html">About</a>
            
          </li>
        
          <li>
            <a class=" partners-menu-item" href="https://wikileaks.org/-Partners-.html">Partners</a>
            
          </li>
        
      </ul>
    
    <aside class="friends mobile-only">
      
        <ul class="first-level">
          
            <li>
              <a href="https://www.torproject.org/" target="_blank">Tor Project</a>
            </li>
          
            <li>
              <a href="https://tails.boum.org/" target="_blank">Tails</a>
            </li>
          
            <li>
              <a href="https://www.couragefound.org/" target="_blank">Courage</a>
            </li>
          
            <li>
              <a href="https://www.bitcoin.org/" target="_blank">Bitcoin</a>
            </li>
          
        </ul>
      
    </aside>
    <aside class="social mobile-only">
      <ul>
        <li>
          <a href="https://www.facebook.com/wikileaks" class="nav-element" target="_blank" alt="Facebook">
            <img class="img-responsive" src="../../static/img/fb-logo.png" alt="Facebook" title="Facebook page" />
          </a>
        </li>
        <li>
          <a href="https://twitter.com/wikileaks" class="nav-element" target="_blank" alt="Twitter">
            <img class="img-responsive" src="../../static/img/twitter-logo.png" alt="Twitter" title="Twitter page" />
          </a>
        </li>
      </ul>
    </aside>
  </div>
</nav>

            <div class="container-fluid row-fluid">
                <div class="col-xs-12 col-sm-12 col-md-10 container-text">
                    <div class="leak-header">
                        <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body>
<div class="title-area">
    <h1 class="leak-title">Vault7: CIA Hacking Tools Revealed</h1>
    <img src="../logo.png">
</div>

</body></html>

                        <ul class="leak-navigation">
                            <a href="../index.html"><li>Releases</li></a>
                            <a href="index.html"><li class="active">Documents</li></a>
                       </ul>
                    </div>
                    <p>Navigation:  » <a href="index.html">Directory</a></p>
<hr>
                    <div id="uniquer">
                        <p>Owner: <a class="user" href="user_29491204.html"><span class="user">User #71491</span></a></p>
<h2><span class="user">User #71491</span></h2>
<table width="99%">
<tr>
<th>Pages</th>
<th width="150px">Date</th>
<th>User</th>
</tr>
<tr>
<td><div style="margin-left: 2.100000em">
<a href="page_29491203.html"><span class="user">User #71491</span>’s Home</a> <span class="pg-tag"></span>
</div></td>
</tr>
</table>
<hr>
<h3>Attachments:</h3>
<ul><li>
<p><a href="files/mach_o_segments.gif">mach_o_segments.gif</a></p>
</li></ul>
<hr>
<h4>Blog posts:</h4>
<ul>
<li class="blogpost">
<p>[<a class="user" href="user_29491204.html"><span class="user">User #71491</span></a>]: 
<b>Working on the Mac Kernel from EFI</b></p>
<p>This blog post will cover the work that I've been doing for <a href="page_21561431.html">QuarkMatter</a>  <span class="pg-tag"></span> to attempt to hook the <span class="glossary">OS<span class="glossary-tt">Operating System</span></span> X kernel from an <span class="glossary">EFI<span class="glossary-tt">Extensible Firmware Interface</span></span> driver.</p>
<p>The following sections will detail each piece needed to do things to the <span class="glossary">OS<span class="glossary-tt">Operating System</span></span> X kernel, at least as I did them. I will attempt to identify where I found information for each section so you can go look at all of this too.</p>
<h1>General Notes</h1>
<p>This post assumes that you already understand <span class="glossary">EFI<span class="glossary-tt">Extensible Firmware Interface</span></span> basics and <a href="page_36896783.html">ExitBootServices Hooking</a>  <span class="pg-tag"></span>, as this relies on those topics.</p>
<p>This post also assumes that you are working on <span class="glossary">OS<span class="glossary-tt">Operating System</span></span> X 10.8 or newer, and thus are using an X86_64 architecture. No PowerPC, please.</p>
<p>As a side note: some of the sources l list are header files, which in Yosemite, are located in /usr/include. On my <span class="user">User #?</span> machine, these headers are not in /usr/include anymore, so you will need to find them in one of the Apple SDKs or the xnu source.</p>
<h1>Finding the Mac Kernel</h1>
<p>Sources: <span class="external">DarkMatter code</span> (primarily src/EFI/Loader/*)</p>
<p>               QuarkMatter code testing (<span class="external">eficore</span>)</p>
<p>               /usr/include/mach-o/loader.h (the header file on <span class="glossary">OS<span class="glossary-tt">Operating System</span></span> X 10.10, or xnu-base/EXTERNAL_HEADERS/mach-o/loader.h, if you are browsing the xnu source)</p>
<p>               reverse.put.as (@osxreverser's blog)</p>
<p> </p>
<p>The Mac kernel is a Mach-O executable, located either at /mach_kernel (pre-10.10) or /System/Library/Kernels/kernel (10.10 and after.) As a mach-o, it starts with a mach_header_64 struct. This structure can be found in loader.h, but the important thing to know is that this structure starts with a magic number!</p>
<p>In the case of the 64-bit mach kernel, this magic number is 0xFEEDFACF. Thus, in order to find a mach-o in memory, you simply need to find that magic number. However, at ExitBootServices there may be more than one mach-o in memory, and 0xFEEDFACF is the magic number for all 64-bit mach-o's.</p>
<p>Fortunately, Apple places the Mac kernel in a somewhat predictable location. Using the Darkmatter source and osxreverser's blog, I found that the kernel is located at address (0x00200000 + (n * 0x00100000)), where 0&lt;= n &lt; 3FF. This means the kernel location can be at most 0x40000000.</p>
<p>From my tests in trying to find the kernel in QuarkMatter, I found that at least for <span class="glossary">OS<span class="glossary-tt">Operating System</span></span> X 10.8-11, the mach kernel is the only mach-o located at any of those offsets.</p>
<p>If you would like to see my code that does this, you can find it (once it has been merged) in eficore/src/MachUtil/KernelLib.c in the FindKernel() function.</p>
<p> </p>
<h1>Parsing the Kernel to Find the Symbol and String Tables</h1>
<p>Sources: DarkMatter code</p>
<p>               /usr/include/mach-o/loader.h</p>
<p>               developer.apple.com "OS X ABI Mach-O File Format Reference"</p>
<p> </p>
<p>Now that I located the kernel, I could attempt to parse it to find various structures that I'd need later. The first ones I needed to find are the symbol table and the string table, because with those, I could identify which version of the <span class="glossary">OS<span class="glossary-tt">Operating System</span></span> X kernel is about to run.</p>
<p>Below is the diagram from Apple's Mach-O file format reference page which shows the basic structure of a mach-o. Although understanding this wasn't necessary to find the kernel, it will be from here on out.</p>
<p><img src="files/mach_o_segments.gif" height="400"></p>
<p>As you can see above, the section immediately following the mach header contains <u>load commands</u> for each segment of the binary. There are multiple types of load commands, each representing its own segment type with its own unique structure.</p>
<p>The first two fields of a load command are always a struct load_command (loader.h), and contain the load command type and the command size.</p>
<p>The two specific load command types that we care about in this section are the LC_SYMTAB load command and a specific instance of the LC_SEGMENT_64 load command.</p>
<p>The LC_SYMTAB command structure is defined below.</p>
<p> </p>
<div class="code"><pre><code><div class="plain-text-body"> struct symtab_command {
        uint32_t        cmd;            /* LC_SYMTAB */
        uint32_t        cmdsize;        /* sizeof(struct symtab_command) */
        uint32_t        symoff;         /* symbol table offset */
        uint32_t        nsyms;          /* number of symbol table entries */
        uint32_t        stroff;         /* string table offset */
        uint32_t        strsize;        /* string table size in bytes */
};</div></code></pre></div>
<p>As you can see, this command contains information about the offsets of the symbol and string tables, as well as size information about each table.</p>
<p>In a normal mach-o, this offset is the offset from the beginning of the binary to the symbol table. However, for reasons I have yet to determine, this is not the case for the Mac kernel. Instead, this is an offset from a different spot of the binary, from which all offsets appear to be derived.</p>
<p>In order to calculate this offset, you will need to find the __LINKEDIT segment. To do this, you need to look for the LC_SEGMENT_64 load command with the segname of "__LINKEDIT". I have included the 64-bit segment command structure below. This __LINKEDIT segment is the segment in which the symbol table and string table reside.</p>
<div class="code"><pre><code><div class="plain-text-body"> struct segment_command_64 { /* for 64-bit architectures */
        uint32_t        cmd;            /* LC_SEGMENT_64 */
        uint32_t        cmdsize;        /* includes sizeof section_64 structs */
        char            segname[16];    /* segment name */
        uint64_t        vmaddr;         /* memory address of this segment */
        uint64_t        vmsize;         /* memory size of this segment */
        uint64_t        fileoff;        /* file offset of this segment */
        uint64_t        filesize;       /* amount to map from the file */
        vm_prot_t       maxprot;        /* maximum <span class="glossary">VM<span class="glossary-tt">Virtual Machine</span></span> protection */
        vm_prot_t       initprot;       /* initial <span class="glossary">VM<span class="glossary-tt">Virtual Machine</span></span> protection */
        uint32_t        nsects;         /* number of sections in segment */
        uint32_t        flags;          /* flags */
};</div></code></pre></div>
<p>The two fields that will help calculate the offset of the <span class="user">User #73998</span> are the vmaddr and fileoff fields. Applying the virtual to physical mask 0x0000007FFFFFFFFF to vmaddr, we can get the physical address of the segment. Because the offsets are offset from the same base address, if you subtract the offset of the LinkEdit segment (fileoff) from the offset of the symbol and string tables (symoff and stroff form the LC_SYMTAB command), you can calculate the offsets within the __LINKEDIT segment of those <span class="user">User #73998</span>, and use the physical address of the segment to find the <span class="user">User #73998</span>.</p>
<p>In summary, if  linkedit_cmd is a pointer to the LC_SEGMENT_64 load command referring to the __LINKEDIT segment, and symtab_cmd is a pointer to the LC_SYMTAB load command, and the virtual to physical mask is called V_TO_P_MASK, then:</p>
<div class="code"><pre><code><div class="plain-text-body">Symtab_addr = (linkedit_cmd-&gt;vmaddr &amp; V_TO_P_MASK) + (symtab_cmd-&gt;symoff - linkedit_cmd-&gt;fileoff)

Strtab_addr = (linkedit_cmd-&gt;vmaddr &amp; V_TO_P_MASK) + (symtab_cmd-&gt;stroff - linkedit_cmd-&gt;fileoff)</div></code></pre></div>
<p> </p>
<h1>Looking up Symbols and Identifying the OS</h1>
<p>Sources: DarkMatter code</p>
<p>               /usr/include/mach-o/nlist.h</p>
<p> </p>
<p>At this point, you now have everything you need to look up kernel symbols.</p>
<p>An entry in the symbol table is defined as a struct nlist_64, which is included below.</p>
<div class="code"><pre><code><div class="plain-text-body">struct nlist_64 {
    union {
        uint32_t  n_strx; /* index into the string table */
    } n_un;
    uint8_t n_type;        /* type flag, see below */
    uint8_t n_sect;        /* section number or NO_SECT */
    uint16_t n_desc;       /* see &lt;mach-o/stab.h&gt; */
    uint64_t n_value;      /* value of this symbol (or stab offset) */
};</div></code></pre></div>
<p>The fields that are most important for looking up kernel symbols are n_un.n_strx and n_value. n_un is a union for legacy purposes, as the 32-bit nlist struct also allowed for that value to be a pointer. However, in the 64-bit kernel, this value is always an index into the string table where the name of the symbol is located.</p>
<p>Thus, to get the name of the "entry_num" symbol in the symbol table, you simply read the string from (strtable_addr) + Symtab[entry_num].n_un.n_strx</p>
<p>Likewise, n_value will be the memory address of the symbol's value. This means that once you find the correct nlist_64 for the symbol you want to find, getting its value is trivial.</p>
<p>Because the symbol table is sorted alphabetically by symbol name (n_un.n_strx), you can use binary search (or your other favorite search algorithm) to find the symbol you are looking for fairly quickly, versus scanning the whole symbol table.</p>
<p> </p>
<p>With the ability to lookup a symbol, identifying the <span class="glossary">OS<span class="glossary-tt">Operating System</span></span> version that is about to run is fairly straightforward. One of the symbols, _osrelease, has a specific value that signifies which <span class="glossary">OS<span class="glossary-tt">Operating System</span></span> version is running. Those values for <span class="glossary">OS<span class="glossary-tt">Operating System</span></span> X 10.8-11 are below.</p>
<div class="code"><pre><code><div class="plain-text-body">MountainLion (10.8.x)  -- "12.x" #where x is the subversion (10.8.x) that I don't care about
Mavericks    (10.9.x)  -- "13.x"
Yosemite     (10.10.x) -- "14.x"
<span class="user">User #?</span>   (10.11.x) -- "15.x"</div></code></pre></div>
<p>And that's it! Find the kernel, parse the kernel, and look up the "_osrelease" symbol, and you know, from EFI, which version of <span class="glossary">OS<span class="glossary-tt">Operating System</span></span> X is about to run.</p>
<p> </p>
<h1>Loading, Linking, and Relocating a Mach-O</h1>
<p>Sources: DarkMatter code</p>
<p>                /usr/include/mach-o/loader.h</p>
<p>                /usr/include/mach-o/nlist.h</p>
<p>                /usr/include/mach-o/reloc.h</p>
<p>                /usr/include/mach-o/x86_64/reloc.h</p>
<p>This section takes a bit of a turn from the previous sections. Previously, you were dealing directly with the kernel mach-o. Now, you will move forward to how you would do dyld's job and load, link, and relocate a Mach-o into memory.</p>
<p>Note: You are still doing this from an <span class="glossary">EFI<span class="glossary-tt">Extensible Firmware Interface</span></span> driver, so you will need to make sure that all of the memory that you use is runtime services memory so it persists after the <span class="glossary">DXE<span class="glossary-tt">Driver Execution Environment</span></span> phase of the <span class="glossary">EFI<span class="glossary-tt">Extensible Firmware Interface</span></span> boot ends.</p>
<h2>Loading</h2>
<p>Similar to parsing the kernel mach-o, the first thing you need to do is find the LC_SYMTAB and LC_SEGMENT_64 (for __LINKEDIT) commands like before. In addition, you will need to find the LC_DYSYMTAB command. You can do this the same way as finding those commands earlier, by parsing the load commands.</p>
<p>Once those are located, the next step is to actually load the LC_SEGMENT_64 segments into memory. As shown in the Mach-o diagram near the top, all of the data for the mach-o is located in a segment. From looking into the DarkMatter code, it appears that you will need to allocate EfiRuntimeServicesCode, as 10.8 introduced an NX stack, and because you need it to be runtime data so it persists past the end of ExitBootServices. Also, to clarify – although you have already loaded the entire Mach-o into memory somehow (otherwise you couldn't parse it, manipulate it, etc as easily), you are now loading parts of it specifically so it will run when the <span class="glossary">OS<span class="glossary-tt">Operating System</span></span> has booted. As a result, from here on, if I mention manipulating values, you are manipulating the values that are in your recently-allocated RuntimeServicesCode memory block.</p>
<h2>Linking</h2>
<p>That is all there is to loading the mach-o. The next step is to link the executable by resolving any undefined symbols. This is where the LC_DYSYMTAB load command will be helpful. The dysymtab_command structure is provided below for reference. I included all of the comments from the header file, though we won't need all of them at all.</p>
<div class="code"><pre><code><div class="plain-text-body"> struct dysymtab_command {
    uint32_t cmd;       /* LC_DYSYMTAB */
    uint32_t cmdsize;   /* sizeof(struct dysymtab_command) */
    /*
     * The symbols indicated by symoff and nsyms of the LC_SYMTAB load command
     * are grouped into the following three groups:
     *    local symbols (further grouped by the module they are from)
     *    defined external symbols (further grouped by the module they are from)
     *    undefined symbols
     *
     * The local symbols are used only for debugging.  The dynamic binding
     * process may have to use them to indicate to the debugger the local
     * symbols for a module that is being bound.
     *
     * The last two groups are used by the dynamic binding process to do the
     * binding (indirectly through the module table and the reference symbol
     * table when this is a dynamically linked shared library file).
     */
    uint32_t ilocalsym; /* index to local symbols */
    uint32_t nlocalsym; /* number of local symbols */
    uint32_t iextdefsym;/* index to externally defined symbols */
    uint32_t nextdefsym;/* number of externally defined symbols */
    uint32_t iundefsym; /* index to undefined symbols */
    uint32_t nundefsym; /* number of undefined symbols */
    /*
     * For the for the dynamic binding process to find which module a symbol
     * is defined in the table of contents is used (analogous to the ranlib
     * structure in an archive) which maps defined external symbols to modules
     * they are defined in.  This exists only in a dynamically linked shared
     * library file.  For executable and object modules the defined external
     * symbols are sorted by name and is use as the table of contents.
     */
    uint32_t tocoff;    /* file offset to table of contents */
    uint32_t ntoc;      /* number of entries in table of contents */
    /*    * To support dynamic binding of "modules" (whole object files) the symbol
     * table must reflect the modules that the file was created from.  This is
     * done by having a module table that has indexes and counts into the merged
     * <span class="user">User #73998</span> for each module.  The module structure that these two entries
     * refer to is described below.  This exists only in a dynamically linked
     * shared library file.  For executable and object modules the file only
     * contains one module so everything in the file belongs to the module.
     */
    uint32_t modtaboff; /* file offset to module table */
    uint32_t nmodtab;   /* number of module table entries */
    /*
     * To support dynamic module binding the module structure for each module
     * indicates the external references (defined and undefined) each module
     * makes.  For each module there is an offset and a count into the
     * reference symbol table for the symbols that the module references.
     * This exists only in a dynamically linked shared library file.  For
     * executable and object modules the defined external symbols and the
     * undefined external symbols indicates the external references.
     */
    uint32_t extrefsymoff;      /* offset to referenced symbol table */
    uint32_t nextrefsyms;       /* number of referenced symbol table entries */
    /*
     * The sections that contain "symbol pointers" and "routine stubs" have
     * indexes and (implied counts based on the size of the section and fixed
     * size of the entry) into the "indirect symbol" table for each pointer
     * and stub.  For every section of these two types the index into the
     * indirect symbol table is stored in the section header in the field
     * reserved1.  An indirect symbol table entry is simply a 32bit index into
     * the symbol table to the symbol that the pointer or stub is referring to.
     * The indirect symbol table is ordered to match the entries in the section.
     */
    uint32_t indirectsymoff; /* file offset to the indirect symbol table */
    uint32_t nindirectsyms;  /* number of indirect symbol table entries */
     * To support relocating an individual module in a library file quickly the
     * external relocation entries for each module in the library need to be
     * accessed efficiently.  Since the relocation entries can't be accessed
     * through the section headers for a library file they are separated into
     * groups of local and external entries further grouped by module.  In this
     * case the presents of this load command who's extreloff, nextrel,
     * locreloff and nlocrel fields are non-zero indicates that the relocation
     * entries of non-merged sections are not referenced through the section
     * structures (and the reloff and nreloc fields in the section headers are
     * set to zero).
     *
     * Since the relocation entries are not accessed through the section headers
     * this requires the r_address field to be something other than a section
     * offset to identify the item to be relocated.  In this case r_address is
     * set to the offset from the vmaddr of the first LC_SEGMENT command.
     * For MH_SPLIT_SEGS images r_address is set to the the offset from the
     * vmaddr of the first read-write LC_SEGMENT command.
     *
     * The relocation entries are grouped by module and the module table
     * entries have indexes and counts into them for the group of external
     * relocation entries for that the module.
     *
     * For sections that are merged across modules there must not be any
     * remaining external relocation entries for them (for merged sections
     * remaining relocation entries must be local).
     */
    uint32_t extreloff; /* offset to external relocation entries */
    uint32_t nextrel;   /* number of external relocation entries */
    /*
     * All the local relocation entries are grouped together (they are not
     * grouped by their module since they are only used if the object is moved
     * from it staticly link edited address).
     */
    uint32_t locreloff; /* offset to local relocation entries */
    uint32_t nlocrel;   /* number of local relocation entries */
};      </div></code></pre></div>
<p>The first values of note are <u>iundefsym </u>and <u>nundefsym</u>. As commented in the struct, iundefsym is the index into the symbol table of the first undefined symbol, and nundefsym is the number of defined symbols.</p>
<p>As it turns out, I partially lied earlier about how the symbol table is sorted. The symbol table is sorted alphabetically, but only within each section. The undefined symbols are their own section of the symbol table. This didn't matter in the kernel, because from what I can tell, there aren't undefined symbols inside of the kernel.</p>
<p>Using iundefsym and nundefsym, you can iterate through symbols in the symbol table to list each of the undefined symbols. In addition, each undefined symbol's <u>n_type</u> value will have the N_EXT bit set to specify that it is an external symbol, and its N_TYPE bits will be equal to N_UNDF, signifying that the symbol is undefined.</p>
<p>If you'd like more clarification about those fields, please refer back to the n_list_64 struct and the constants defined in nlist.h. I've left them out of this post, because it's already becoming fairly lengthy.</p>
<p> </p>
<p>Now that you have identified each of the undefined symbols, you can look up those symbols in the kernel's symbol table. Because you can look up the kernel symbol by name and find its value, you can simply do that lookup and copy the memory address of the value into the undefined symbol's n_list_64.n_value field, and you will have resolved that undefined symbol.</p>
<p>If the symbol is not in the kernel, that may be ok. Some symbols have the N_WEAK_REF bit of the n_desc field set. If this is the case, this means that the symbol is allowed to be missing, and if it is, that the n_value is to be set to 0.</p>
<h2>Relocating (Not completed yet)</h2>
<p>At this point, you have loaded the binary into memory and done linking to resolve external symbols. The only remaining thing to do is to relocate the binary so its pointers that need to be relocated actually point in the correct places once virtual memory has been turned on and the kernel is running.</p>
<p>At least for me, this was the most complicated part of dealing with a mach-o. Fortunately, because we are only dealing with x86_64 binaries, some of the more complicated relocation types will not be encountered, so we can ignore them.</p>
<p>Before we get into specific types of relocations that we may encounter, I want to describe the two general types of relocations: local and external relocations. Local relocations are not common in x86_64 binaries, and typically just need to be turned into virtual addresses.</p>
<p>External relocations, on the other hand, rely on information in the symbol table to recalculate the address that they are to use. We will be dealing primarily with external relocations.</p>
<p> </p>
<p> </p>
<p>There are only two types of external relocations that we could potentially see in a mach-o that we're trying to load from EFI. Those types are:</p>
<p>        1) X86_64_RELOC_UNSIGNED: a relocation used for absolute addresses</p>
<p>        2) X86_64_RELOC_BRANCH: a relocation used for a call/jmp instruction with a 32-bit displacement</p>
<p> </p>
<p> </p>
</li>
</ul>
<hr>
<h3>Home pages:</h3>
<ul>
<li><a href="page_29491203.html"><span class="user">User #71491</span>’s Home</a></li>

                    </ul>
</div>
                </div>
            </div>

            <script type="text/javascript" src="../../highlighter/mootools-core-and-more.js"></script>
            <script type="text/javascript" src="../../highlighter/efatmarker.min.js"></script>
            <div id="efm-button">
            <div id="efm-menu">
                <h3 style="margin:0 0 2px 0">e-Highlighter</h3>
                <a id="efm-permalink" class="efm-need-highlight" href="space_29556737.html" style="margin-bottom:0;padding-bottom:0;"></a>
                <p style="margin-top:0;padding-top:0" class="efm-need-highlight">Click to send permalink to address bar, or right-click to copy permalink.</p>
                <p style="margin:0.5em 0;padding:0;border-top:1px dotted #ccc;height:1px"></p>
                <a id="efm-unhighlightall" class="efm-need-highlight">Un-highlight all</a>
                <a id="efm-unhighlight">Un-highlight selection<span>u</span></a>
                <a id="efm-highlight">Highlight selection<span>h</span></a>
                </div>
            </div>
            <script type="text/javascript">

            (function(){
            window.addEvent('domready', function(){

                var markerButton = $('efm-button');
                if ( markerButton ) {
                    eMarker = new EFatMarker($('uniquer'));
                    eMarker.tokenToSpans(); // apply whatever token is there
                    // need to act on mousedown or else selection disappear
                    markerButton.addEvent('mousedown', function(){
                        eMarker.interpretSelection(true);
                        return false;
                    });
                    $('efm-unhighlightall').addEvent('mousedown', function(){
                        eMarker.unhighlightAll(true);
                        return false;
                        });
                    $('efm-unhighlight').addEvent('mousedown', function(){
                        eMarker.unhighlightSelection(true);
                        return false;
                        });
                    $('efm-highlight').addEvent('mousedown', function(){
                        eMarker.highlightSelection(true);
                        return false;
                        });
                    $('efm-permalink').addEvent('mousedown', function(){
                        window.location.href = this.href;
                        return false;
                        });
                    // if Mootools Keyboard is available, use it
                    if (Keyboard) {
                        var keyboard = new Keyboard({
                            defaultEventType: 'keyup',
                            events: {
                                'h': function(){
                                    eMarker.highlightSelection(true);
                                    },
                                'u': function(){
                                    eMarker.unhighlightSelection(true);
                                    }
                                }
                            });
                        keyboard.activate();
                        }
                    eMarker.syncDOM();
                    // auto scroll to first highlight, if any
                    if (eMarker.hasSpans()) {
                        var scroll = new Fx.Scroll(window,{offset:{'x':0,'y':-100}}),
                            highlights = $$('#uniquer .efm-hi');
                        if (highlights.length > 0) {
                            scroll.toElement(highlights[0]);
                            }
                        }
                    }
                });
            })();
            </script>
            

<link href="../../static/css/styles_footer.css" rel="stylesheet">
<footer id="page-footer" class="footer-recommendations">
  <div class="footer-wrapper">
    <div class="recommendation-container">
      <a href="space_29556737.html#" class="top">Top</a>
      
        <ul class="recommendation-links">
          
            <li class="recommendation">
              <a href="https://www.torproject.org/" target="_blank">
                <div class="teaser"><img class="spip_logos" alt="" src="../../IMG/arton401.png?1461924517" width="300" height="180" /></div>
                <p>
<p>Tor is an encrypted anonymising network that makes it harder to intercept internet communications, or see where communications are coming from or going to.</p>
</p>
              </a>
            </li>
          
            <li class="recommendation">
              <a href="https://tails.boum.org/" target="_blank">
                <div class="teaser"><img class="spip_logos" alt="" src="../../IMG/arton405.png?1461924517" width="446" height="223" /></div>
                <p>
<p>Tails is a live operating system, that you can start on almost any computer from a DVD, USB stick, or SD card. It aims at preserving your privacy and anonymity.</p>
</p>
              </a>
            </li>
          
            <li class="recommendation">
              <a href="https://www.couragefound.org/" target="_blank">
                <div class="teaser"><img class="spip_logos" alt="" src="../../IMG/arton404.png?1461924517" width="357" height="50" /></div>
                <p>
<p>The Courage Foundation is an international organisation that supports those who risk life or liberty to make significant contributions to the historical record.</p>
</p>
              </a>
            </li>
          
            <li class="recommendation">
              <a href="https://www.bitcoin.org/" target="_blank">
                <div class="teaser"><img class="spip_logos" alt="" src="../../IMG/arton403.png?1461924517" width="300" height="64" /></div>
                <p>
<p>Bitcoin uses peer-to-peer technology to operate with no central authority or banks; managing transactions and the issuing of bitcoins is carried out collectively by the network.</p>
</p>
              </a>
            </li>
          
        </ul>
      
      <ul class="social-links">
        <li>
          <a href="https://www.facebook.com/wikileaks" target="_blank" alt="Facebook">
            <img src="../../static/img/fb-logo.png" alt="Facebook" title="Facebook page" />
          </a>
        </li>
        <li>
          <a href="https://twitter.com/wikileaks" target="_blank" alt="Twitter">
            <img src="../../static/img/twitter-logo.png" alt="Twitter" title="Twitter page" />
          </a>
        </li>
      </ul>
    </div>
  </div>
</footer>

        </div>

        <script src="../../bootstrap/js/jquery.min.js"></script>
        <script type="text/javascript">
        var $j = jQuery.noConflict();
        </script>
        <script src="../../bootstrap/js/bootstrap.min.js"></script>
    </body>
</html>
