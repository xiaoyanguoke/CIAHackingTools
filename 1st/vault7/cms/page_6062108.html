<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="icon" type="image/png" href="http://localhost:6081/IMG/favicon.ico">
        <title>Margarita v1.6 User Guide</title>
        <link href="../../bootstrap/css/bootstrap.min.css" rel="stylesheet">
        <link href="../../bootstrap/css/cerulean.min.css" rel="stylesheet">
        <link href="../../bootstrap/css/new-gen.css" rel="stylesheet">
        <link href="../../css/leak-styles.css" rel="stylesheet">
        <link href="../../highlighter/efatmarker.css" rel="stylesheet">
        <style>
          #efm-button {margin:0 0 4px 0;padding:0 0 0 30px;position:fixed;height:48px;width:52px;bottom:0;right:0;background:transparent '/highlighter/kedit-2.png' no-repeat bottom right;cursor:pointer;opacity:0.4;z-index:99999999999}
          #efm-button:hover {opacity:1}
          #efm-button #efm-menu {margin:0 0 52px 0;border:1px outset gray;padding:0;display:none;background:#eee;position:fixed;bottom:0;right:0;width:20em;opacity:1;cursor:auto}
          #efm-button:hover #efm-menu {display:block;font-size:smaller;color:#999}
          #efm-button #efm-menu p {margin:0;padding:0 3px}
          #efm-button #efm-menu a {margin:1px;padding:3px 3px;display:block;font:12px sans-serif;white-space:nowrap;opacity:inherit;cursor:pointer}
          #efm-button #efm-menu a:hover {color:black;background-color:white;opacity:1}
          #efm-button #efm-menu a > span {color:gray;position:absolute;right:4px}
          .efm-hi {background-color:#ff8;font-weight:normal;}
        </style>
        <link href="../../bootstrap/css/submit.css" rel="stylesheet">
        <link href="main.css" rel="stylesheet">
    </head>
    <body>
        <div id="submit_wlkey" class="submit_elem">
	<div class="container">
		<div class="text-center"><div class="submit_buttons btn-group" role="group">
			<a href="page_6062108.html#submit_help_contact" class="btn-wl btn-wl-empty">How to contact WikiLeaks?</a>
			<a href="page_6062108.html#submit_help_tor" class="btn-wl btn-wl-empty">What is Tor?</a>
			<a href="page_6062108.html#submit_help_tips" class="btn-wl btn-wl-empty">Tips for Sources</a>
			<a href="page_6062108.html#submit_help_after" class="btn-wl btn-wl-empty">After Submitting</a>
		</div></div>
		<p>This key's fingerprint is A04C 5E09 ED02 B328 03EB  6116 93ED 732E 9231 8DBA</p>
		<pre>
-----BEGIN PGP PUBLIC KEY BLOCK-----

mQQNBFUoCGgBIADFLp+QonWyK8L6SPsNrnhwgfCxCk6OUHRIHReAsgAUXegpfg0b
rsoHbeI5W9s5to/MUGwULHj59M6AvT+DS5rmrThgrND8Dt0dO+XW88bmTXHsFg9K
jgf1wUpTLq73iWnSBo1m1Z14BmvkROG6M7+vQneCXBFOyFZxWdUSQ15vdzjr4yPR
oMZjxCIFxe+QL+pNpkXd/St2b6UxiKB9HT9CXaezXrjbRgIzCeV6a5TFfcnhncpO
ve59rGK3/az7cmjd6cOFo1Iw0J63TGBxDmDTZ0H3ecQvwDnzQSbgepiqbx4VoNmH
OxpInVNv3AAluIJqN7RbPeWrkohh3EQ1j+lnYGMhBktX0gAyyYSrkAEKmaP6Kk4j
/ZNkniw5iqMBY+v/yKW4LCmtLfe32kYs5OdreUpSv5zWvgL9sZ+4962YNKtnaBK3
1hztlJ+xwhqalOCeUYgc0Clbkw+sgqFVnmw5lP4/fQNGxqCO7Tdy6pswmBZlOkmH
XXfti6hasVCjT1MhemI7KwOmz/KzZqRlzgg5ibCzftt2GBcV3a1+i357YB5/3wXE
j0vkd+SzFioqdq5Ppr+//IK3WX0jzWS3N5Lxw31q8fqfWZyKJPFbAvHlJ5ez7wKA
1iS9krDfnysv0BUHf8elizydmsrPWN944Flw1tOFjW46j4uAxSbRBp284wiFmV8N
TeQjBI8Ku8NtRDleriV3djATCg2SSNsDhNxSlOnPTM5U1bmh+Ehk8eHE3hgn9lRp
2kkpwafD9pXaqNWJMpD4Amk60L3N+yUrbFWERwncrk3DpGmdzge/tl/UBldPoOeK
p3shjXMdpSIqlwlB47Xdml3Cd8HkUz8r05xqJ4DutzT00ouP49W4jqjWU9bTuM48
LRhrOpjvp5uPu0aIyt4BZgpce5QGLwXONTRX+bsTyEFEN3EO6XLeLFJb2jhddj7O
DmluDPN9aj639E4vjGZ90Vpz4HpN7JULSzsnk+ZkEf2XnliRody3SwqyREjrEBui
9ktbd0hAeahKuwia0zHyo5+1BjXt3UHiM5fQN93GB0hkXaKUarZ99d7XciTzFtye
/MWToGTYJq9bM/qWAGO1RmYgNr+gSF/fQBzHeSbRN5tbJKz6oG4NuGCRJGB2aeXW
TIp/VdouS5I9jFLapzaQUvtdmpaeslIos7gY6TZxWO06Q7AaINgr+SBUvvrff/Nl
l2PRPYYye35MDs0b+mI5IXpjUuBC+s59gI6YlPqOHXkKFNbI3VxuYB0VJJIrGqIu
Fv2CXwy5HvR3eIOZ2jLAfsHmTEJhriPJ1sUG0qlfNOQGMIGw9jSiy/iQde1u3ZoF
so7sXlmBLck9zRMEWRJoI/mgCDEpWqLX7hTTABEBAAG0x1dpa2lMZWFrcyBFZGl0
b3JpYWwgT2ZmaWNlIEhpZ2ggU2VjdXJpdHkgQ29tbXVuaWNhdGlvbiBLZXkgKFlv
dSBjYW4gY29udGFjdCBXaWtpTGVha3MgYXQgaHR0cDovL3dsY2hhdGMzcGp3cGxp
NXIub25pb24gYW5kIGh0dHBzOi8vd2lraWxlYWtzLm9yZy90YWxrKSA8Y29udGFj
dC11cy11c2luZy1vdXItY2hhdC1zeXN0ZW1Ad2lraWxlYWtzLm9yZz6JBD0EEwEK
ACcCGwMFCwkIBwMFFQoJCAsFFgIDAQACHgECF4AFAlb6cdIFCQOznOoACgkQk+1z
LpIxjbrlqh/7B2yBrryWhQMGFj+xr9TIj32vgUIMohq94XYqAjOnYdEGhb5u5B5p
BNowcqdFB1SOEvX7MhxGAqYocMT7zz2AkG3kpf9f7gOAG7qA1sRiB+R7mZtUr9Kv
fQSsRFPb6RNzqqB9I9wPNGhBh1YWusUPluLINwbjTMnHXeL96HgdLT+fIBa8ROmn
0fjJVoWYHG8QtsKiZ+lo2m/J4HyuJanAYPgL6isSu/1bBSwhEIehlQIfXZuS3j35
12SsO1Zj2BBdgUIrADdMAMLneTs7oc1/PwxWYQ4OTdkay2deg1g/N6YqM2N7rn1W
7A6tmuH7dfMlhcqw8bf5veyag3RpKHGcm7utDB6k/bMBDMnKazUnM2VQoi1mutHj
kTCWn/vF1RVz3XbcPH94gbKxcuBi8cjXmSWNZxEBsbirj/CNmsM32Ikm+WIhBvi3
1mWvcArC3JSUon8RRXype4ESpwEQZd6zsrbhgH4UqF56pcFT2ubnqKu4wtgOECsw
K0dHyNEiOM1lL919wWDXH9tuQXWTzGsUznktw0cJbBVY1dGxVtGZJDPqEGatvmiR
o+UmLKWyxTScBm5o3zRm3iyU10d4gka0dxsSQMl1BRD3G6b+NvnBEsV/+KCjxqLU
vhDNup1AsJ1OhyqPydj5uyiWZCxlXWQPk4p5WWrGZdBDduxiZ2FTj17hu8S4a5A4
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
J3x7gtxUMkTadELqwY6hrU8=
=BLTH
-----END PGP PUBLIC KEY BLOCK-----
		</pre>
	</div>
</div>

<div id="submit_help_contact" class="submit_elem">
	<div class="container">
		<div class="text-center"><div class="submit_buttons btn-group" role="group">
			<a href="page_6062108.html#submit_help_contact" class="btn-wl">How to contact WikiLeaks?</a>
			<a href="page_6062108.html#submit_help_tor" class="btn-wl btn-wl-empty">What is Tor?</a>
			<a href="page_6062108.html#submit_help_tips" class="btn-wl btn-wl-empty">Tips for Sources</a>
			<a href="page_6062108.html#submit_help_after" class="btn-wl btn-wl-empty">After Submitting</a>
		</div></div>

		<h3>Contact</h3>
		<p>If you need help using Tor you can contact WikiLeaks for assistance in setting it up using our simple webchat available at: <a href="https://wikileaks.org/talk">https://wikileaks.org/talk</a></p>
		<p>If you can use Tor, but need to contact WikiLeaks for other reasons use our secured webchat available at <b>http://wlchatc3pjwpli5r.onion</b></p>
		<p>We recommend contacting us over Tor if you can.</p>
	</div>
</div>

<div id="submit_help_tor" class="submit_elem">
	<div class="container">
		<div class="text-center"><div class="submit_buttons btn-group" role="group">
			<a href="page_6062108.html#submit_help_contact" class="btn-wl btn-wl-empty">How to contact WikiLeaks?</a>
			<a href="page_6062108.html#submit_help_tor" class="btn-wl">What is Tor?</a>
			<a href="page_6062108.html#submit_help_tips" class="btn-wl btn-wl-empty">Tips for Sources</a>
			<a href="page_6062108.html#submit_help_after" class="btn-wl btn-wl-empty">After Submitting</a>
		</div></div>

		<h3>Tor</h3>
		<p><a href="https://www.torproject.org">Tor</a> is an encrypted anonymising network that makes it harder to intercept internet communications, or see where communications are coming from or going to.</p>
		<p>In order to use the WikiLeaks public submission system as detailed above you can download the Tor Browser Bundle, which is a Firefox-like browser available for Windows, Mac OS X and GNU/Linux and pre-configured to connect using the anonymising system Tor.</p>
		<h4>Tails</h4>
		<p>If you are at high risk and you have the capacity to do so, you can also access the submission system through a secure operating system called <a href="https://tails.boum.org">Tails</a>. Tails is an operating system launched from a USB stick or a DVD that aim to leaves no traces when the computer is shut down after use and automatically routes your internet traffic through Tor. Tails will require you to have either a USB stick or a DVD at least 4GB big and a laptop or desktop computer.</p>
	</div>
</div>

<div id="submit_help_tips" class="submit_elem">
	<div class="container">
		<div class="text-center">
			<div class="submit_buttons btn-group" role="group">
				<a href="page_6062108.html#submit_help_contact" class="btn-wl btn-wl-empty">How to contact WikiLeaks?</a>
				<a href="page_6062108.html#submit_help_tor" class="btn-wl btn-wl-empty">What is Tor?</a>
				<a href="page_6062108.html#submit_help_tips" class="btn-wl">Tips for Sources</a>
				<a href="page_6062108.html#submit_help_after" class="btn-wl btn-wl-empty">After Submitting</a>
			</div>
		</div>

		<h3>Tips</h3>
		<p>Our submission system works hard to preserve your anonymity, but we recommend you also take some of your own precautions. Please review these basic guidelines. </p>
		<div>
			<h4>1. Contact us if you have specific problems</h4>
			<p>If you have a very large submission, or a submission with a complex format, or are a high-risk source, please <a href="page_6062108.html#submit_help_contact">contact us</a>. In our experience it is always possible to find a custom solution for even the most seemingly difficult situations.</p>
		</div>
		<div>
			<h4>2. What computer to use</h4>
			<p>If the computer you are uploading from could subsequently be audited in an investigation, consider using a computer that is not easily tied to you. Technical users can also use <a href="https://tails.boum.org">Tails</a> to help ensure you do not leave any records of your submission on the computer.</p>
		</div>
		<div>
			<h4>3. Do not talk about your submission to others</h4>
			<p>If you have any issues talk to WikiLeaks. We are the global experts in source protection – it is a complex field. Even those who mean well often do not have the experience or expertise to advise properly. This includes other media organisations.</p>
		</div>

	</div>
</div>

<div id="submit_help_after" class="submit_elem">
	<div class="container">
		<div class="text-center">
			<div class="submit_buttons btn-group" role="group">
				<a href="page_6062108.html#submit_help_contact" class="btn-wl btn-wl-empty">How to contact WikiLeaks?</a>
				<a href="page_6062108.html#submit_help_tor" class="btn-wl btn-wl-empty">What is Tor?</a>
				<a href="page_6062108.html#submit_help_tips" class="btn-wl btn-wl-empty">Tips for Sources</a>
				<a href="page_6062108.html#submit_help_after" class="btn-wl">After Submitting</a>
			</div>
		</div>

		<h3>After</h3>

		<div>
			<h4>1. Do not talk about your submission to others</h4>
			<p>If you have any issues talk to WikiLeaks. We are the global experts in source protection – it is a complex field. Even those who mean well often do not have the experience or expertise to advise properly. This includes other media organisations.</p>
		</div>

		<div>
			<h4>2. Act normal</h4>
			<p>If you are a high-risk source, avoid saying anything or doing anything after submitting which might promote suspicion. In particular, you should try to stick to your normal routine and behaviour.</p>
		</div>

		<div>
			<h4>3. Remove traces of your submission</h4>
			<p>If you are a high-risk source and the computer you prepared your submission on, or uploaded it from, could subsequently be audited in an investigation, we recommend that you format and dispose of the computer hard drive and any other storage media you used.</p>
			<p>In particular, hard drives retain data after formatting which may be visible to a digital forensics team and flash media (USB sticks, memory cards and SSD drives) retain data even after a secure erasure. If you used flash media to store sensitive data, it is important to destroy the media.</p>
			<p>If you do this and are a high-risk source you should make sure there are no traces of the clean-up, since such traces themselves may draw suspicion.</p>
			<div>
				<h4>4. If you face legal action</h4>
				<p>If a legal action is brought against you as a result of your submission, there are organisations that may help you. The Courage Foundation is an international organisation dedicated to the protection of journalistic sources. You can find more details at <a href="https://www.couragefound.org">https://www.couragefound.org</a>.</p>
			</div>
		</div>
	</div>
</div>

<div id="submit" class="submit_banner">
	<div class="container">
		<div class="page-header">
			<h1>Submit documents to WikiLeaks</h1>
			<a class="remove-button" href="page_6062108.html#"><span class="glyphicon glyphicon-remove-circle"></span></a>
		</div>
		<p>WikiLeaks publishes documents of political or historical importance that are censored or otherwise suppressed. We specialise in strategic global publishing and large archives.</p>
		<p>The following is the address of our secure site where you can anonymously upload your documents to WikiLeaks editors. You can only access this submissions system through Tor. (See our <a href="page_6062108.html#submit_help_tor">Tor tab</a> for more information.) We also advise you to read our <a href="page_6062108.html#submit_help_tips">tips for sources</a> before submitting.</p>

		<div class="alert alert-info">
			<div class="onion-url">wlupld3ptjvsgwqw.onion</div>
			<div>
				Copy this address into your Tor browser. Advanced users, if they wish, can also add a further layer of encryption to their submission using <a href="page_6062108.html#submit_wlkey">our public PGP key</a>.
			</div>
		</div>

		<p>If you cannot use Tor, or your submission is very large, or you have specific requirements, WikiLeaks provides several alternative methods. <a href="page_6062108.html#submit_help_contact">Contact us</a> to discuss how to proceed.</p>
	</div>
</div>
<div id="submit_help_buttons" class="submit_elem">
	<div class="container">
		<div class="text-center">
			<div class="submit_buttons btn-group" role="group">
				<a href="page_6062108.html#submit_help_contact" class="btn-wl btn-wl-empty">How to contact WikiLeaks?</a>
				<a href="page_6062108.html#submit_help_tor" class="btn-wl btn-wl-empty">What is Tor?</a>
				<a href="page_6062108.html#submit_help_tips" class="btn-wl btn-wl-empty">Tips for Sources</a>
				<a href="page_6062108.html#submit_help_after" class="btn-wl btn-wl-empty">After Submitting</a>
			</div>
		</div>
	</div>
</div>

        <div id="main">
            

<link href="../../static/css/styles_topnav.css" rel="stylesheet">
<link href="../../static/css/styles_sidenav.css" rel="stylesheet">
<div class="top-navigation">
  <nav class="navbar">
      <a href="page_6062108.html#menu" class="mobile-only hot-dog nav-element">
      </a>
    <div class="nav-logo">
      <a href="https://wikileaks.org">
        <h1>WikiLeaks</h1>
      </a>
    </div>
    <div class="action-buttons">
      <a class="button-face support-link" href="https://wikileaks.spreadshirt.com/" target="_blank">Shop</a>
      <a class="button-face donate-link" href="https://shop.wikileaks.org/donate">Donate</a>
      <a class="button-face submit-link" href="page_6062108.html#submit">Submit</a>
    </div>
    <form class="global-search" method="get" action="https://search.wikileaks.org/">
      <input type="text" name="q" placeholder="Search">
      <button class="btn-search" type="submit"></button>
    </form>
    <div class="main-nav">
      
        <ul class="first-level">
          
            <li>
              <a class=" leaks-menu-item" href="https://wikileaks.org/-Leaks-.html">Leaks</a>
            </li>
          
            <li>
              <a class=" news-menu-item" href="https://wikileaks.org/-News-.html">News</a>
            </li>
          
            <li>
              <a class=" about-menu-item" href="https://wikileaks.org/-About-66-.html">About</a>
            </li>
          
            <li>
              <a class=" partners-menu-item" href="https://wikileaks.org/-Partners-.html">Partners</a>
            </li>
          
        </ul>
      
    </div>
  </nav>
</div><nav id="menu" class="side-nav rub">
  <div class="menu-wrapper">
    <a class="close-btn nav-element" href="page_6062108.html#"></a>
    
      <ul class="first-level">
        
          <li>
            <a class=" leaks-menu-item" href="https://wikileaks.org/-Leaks-.html">Leaks</a>
            
          </li>
        
          <li>
            <a class=" news-menu-item" href="https://wikileaks.org/-News-.html">News</a>
            
          </li>
        
          <li>
            <a class=" about-menu-item" href="https://wikileaks.org/-About-66-.html">About</a>
            
          </li>
        
          <li>
            <a class=" partners-menu-item" href="https://wikileaks.org/-Partners-.html">Partners</a>
            
          </li>
        
      </ul>
    
    <aside class="friends mobile-only">
      
        <ul class="first-level">
          
            <li>
              <a href="https://www.torproject.org/" target="_blank">Tor Project</a>
            </li>
          
            <li>
              <a href="https://tails.boum.org/" target="_blank">Tails</a>
            </li>
          
            <li>
              <a href="https://www.couragefound.org/" target="_blank">Courage</a>
            </li>
          
            <li>
              <a href="https://www.bitcoin.org/" target="_blank">Bitcoin</a>
            </li>
          
        </ul>
      
    </aside>
    <aside class="social mobile-only">
      <ul>
        <li>
          <a href="https://www.facebook.com/wikileaks" class="nav-element" target="_blank" alt="Facebook">
            <img class="img-responsive" src="../../static/img/fb-logo.png" alt="Facebook" title="Facebook page" />
          </a>
        </li>
        <li>
          <a href="https://twitter.com/wikileaks" class="nav-element" target="_blank" alt="Twitter">
            <img class="img-responsive" src="../../static/img/twitter-logo.png" alt="Twitter" title="Twitter page" />
          </a>
        </li>
      </ul>
    </aside>
  </div>
</nav>

            <div class="container-fluid row-fluid">
                <div class="col-xs-12 col-sm-12 col-md-10 container-text">
                    <div class="leak-header">
                        <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body>
<div class="title-area">
    <h1 class="leak-title">Vault7: CIA Hacking Tools Revealed</h1>
    <img src="../logo.png">
</div>

</body></html>

                        <ul class="leak-navigation">
                            <a href="../index.html"><li>Releases</li></a>
                            <a href="index.html"><li class="active">Documents</li></a>
                       </ul>
                    </div>
                    <p>Navigation:  » <a href="page_2064603.html">Latest version</a></p>
<hr>
                    <div id="uniquer">
                        <p>Owner: <a class="user" href="user_1179751.html"><span class="user">User #1179751</span></a></p>
<h2>Margarita v1.6 User Guide</h2>
<p><br class="atl-forced-newline"><a name="_Toc147910064"></a><br class="atl-forced-newline"><br class="atl-forced-newline"><br class="atl-forced-newline"><br class="atl-forced-newline"><br class="atl-forced-newline"><br class="atl-forced-newline"><br class="atl-forced-newline"><br class="atl-forced-newline"><img src="files/worddavee6f60453facef52a755009da40153a9.png" height="272" width="272"><br class="atl-forced-newline"><br class="atl-forced-newline"><br class="atl-forced-newline"><br class="atl-forced-newline"><br class="atl-forced-newline"><br class="atl-forced-newline"><br class="atl-forced-newline"><br class="atl-forced-newline">
Engineering Development Group
<br class="atl-forced-newline"><em>Margarita</em> <em>v1.3</em><br>
User Guide
<br class="atl-forced-newline">
Rev. A<br>
29 Nov 2011
<br class="atl-forced-newline"><br class="atl-forced-newline"><br class="atl-forced-newline"><br class="atl-forced-newline"><br class="atl-forced-newline"><br class="atl-forced-newline"><br class="atl-forced-newline"><br class="atl-forced-newline"><br class="atl-forced-newline">
Classified By: 2259322<br>
Derived From: COL S-06<br>
Reason: 1.4 (c)<br>
Declassify on: 20350629*Change Log*
<br class="atl-forced-newline"></p>
<table><tbody>
<tr>
<th><p><strong>Doc</strong> <br class="atl-forced-newline"><strong>Rev</strong></p></th>
<th><p><strong>Doc</strong> <br class="atl-forced-newline"><strong>Date</strong></p></th>
<th><p><strong>Rev</strong> <br class="atl-forced-newline"><strong>By</strong></p></th>
<th><p><strong>Change Description</strong></p></th>
<th><p><strong>Reference</strong></p></th>
<th><p><strong>Authority/</strong> <br class="atl-forced-newline"><strong>Approval Date</strong></p></th>
</tr>
<tr>
<td><p>New</p></td>
<td><p>01-24-11</p></td>
<td><p>VGY</p></td>
<td><p>New</p></td>
<td><p> </p></td>
<td><p> </p></td>
</tr>
<tr>
<td><p>V1.1</p></td>
<td><p>02-25-11</p></td>
<td><p>VGY</p></td>
<td><p>Updates for version 1.1</p></td>
<td><p> </p></td>
<td><p> </p></td>
</tr>
<tr>
<td><p>V1.2</p></td>
<td><p>06-02-11</p></td>
<td><p>VGY</p></td>
<td><p>Updates for version 1.2</p></td>
<td><p> </p></td>
<td><p> </p></td>
</tr>
<tr>
<td><p>V1.3</p></td>
<td><p>11-29-11</p></td>
<td><p>VGY</p></td>
<td><p>Updates for version 1.3</p></td>
<td><p> </p></td>
<td><p> </p></td>
</tr>
<tr>
<td><p>V1.6</p></td>
<td><p>03-24-2013</p></td>
<td><p>SDP</p></td>
<td><p>Updates for version 1.6</p></td>
<td><p> </p></td>
<td><p> </p></td>
</tr>
<tr>
<td><p> </p></td>
<td><p> </p></td>
<td><p> </p></td>
<td><p> </p></td>
<td><p> </p></td>
<td><p> </p></td>
</tr>
</tbody></table>

<p><br class="atl-forced-newline">
 <strong>Table of Contents</strong><br class="atl-forced-newline"></p>
<div class="link-body">
<strong>1.</strong> <strong>(U) Scope</strong> </div>
<br><div class="link-body">1.1 (U) System Overview and Description </div>
<br><div class="link-body">1.2 (U) Assumptions and Constraints </div>
<br><div class="link-body">
<strong>2.</strong> <strong>(U) Applicable Documents</strong> </div>
<br><div class="link-body">
<strong>3.</strong> <strong>(U) System Description</strong> </div>
<br><div class="link-body">3.1 (U) System Concepts and Capabilities </div>
<br><div class="link-body">3.2 Prerequisites </div>
<br><div class="link-body">
<strong>4.</strong> <strong>(U) Operation</strong> </div>
<br><div class="link-body">4.1 (U) Installation and Setup </div>
<br><div class="link-body">4.2 (U) Preparing a Margarita </div>
<br><div class="link-body">4.2.1 (U) Initial Setup </div>
<br><div class="link-body">4.2.2 (U) Additional Notes </div>
<br><div class="link-body">4.2.3 (U) Application Configuration </div>
<br><div class="link-body">4.3 (S) Initiating a Session on the Target System </div>
<br><div class="link-body">4.4 (U) Stopping and Suspending Work </div>
<br><div class="link-body">4.5 (U) Assistance and Problem Reporting </div>
<br><div class="link-body">
<strong>5.</strong> <strong>(U) Additional Operational Procedures</strong> </div>
<br><div class="link-body">5.1 (U) Post Processing </div>
<br><div class="link-body">5.2 (U) Viewing the results </div>
<br><div class="link-body">
<strong>6.</strong> <strong>(U) Release Notes</strong> </div>
<br><div class="link-body">6.1 (U) Updates from previous versions </div>
<br><div class="link-body">6.2 (U) Known <span class="glossary">PSP<span class="glossary-tt">Personal Security Product (Anti-Virus)</span></span> issues </div>

<p><br class="atl-forced-newline"></p>
<h1>
<a name="_Toc199831545"></a><a name="_Toc286388965"></a>(U) Scope</h1>

<p>(U) This document establishes the User Guide for Margarita v1.6.</p>
<h2>
<a name="_Toc286388966"></a><em>(U) System Overview and Description</em>
</h2>
<p><a name="_Toc200432980"></a>(S) The BARTENDER program is a set of <span class="glossary">IOC<span class="glossary-tt">Information Operation Center</span></span> tools and concepts of operations that are specifically tailored for "blended" operations and rely on social engineering as well as technical sophistication for success.  Tools for BARTENDER operations will be highly configurable, produce standardized results, will not require HQS interaction for deployment in most cases, and will not leave significant artifacts on the target computer.  <br>
(S) The BARTENDER program will use a common interface to configure the survey and will produce a common result regardless of the exploitation vector.  The platform will be easy to use but also allow advanced users to detail robust surveys.  The survey platform will include all features from EZCheese 5.0.  Results of surveys will be stored on the same device that the survey was launched from and will be hidden and/or protected in order to allow the NOC freedom of movement.<br>
(S) BARTENDER will also have a suite of tools that launch from a thumb drive and require the NOC to engineer a circumstance to view particular files.  BARTENDER tools may trigger pop up messages from operations systems and personal security products.  These messages will be part o the concept of operations.  The NOC will be trained to expect them, allay the fears of the target, and guide the target to allow the survey to function.</p>
<h2>
<a name="_Toc286388967"></a><em>(U) Assumptions and Constraints</em>
</h2>
<p>(S) As mentioned above, in order for Margarita to collect files the NOC will be required to have some interaction with the target computer.  Depending on the execution vector this may result in pop up messages.  
<br class="atl-forced-newline">
(S) Margarita requires .Net 4.5 on the computer that does the configuration.
<br class="atl-forced-newline"></p>
<h1>
<a name="_Toc43542053"></a><a name="_Toc43599342"></a><a name="_Toc44226062"></a><a name="_Toc44226152"></a><a name="_Toc44303399"></a><a name="_Toc99155206"></a><a name="_Toc115249817"></a><a name="_Toc115513238"></a><a name="_Toc115580144"></a><a name="_Toc140892899"></a><a name="_Toc141068034"></a><a name="_Toc142123818"></a><a name="_Toc142124895"></a><a name="_Toc153678615"></a><a name="_Ref166559460"></a><a name="_Toc199831546"></a><a name="_Toc286388968"></a>(U) Applicable Documents</h1>
<p>(S) The following documents pertain to this tool.  In the event of a conflict between the documents referenced below, the contents of this document will be considered binding.  </p>
<ul>
	<li>Margarita v1.6 User Guide.doc (S)</li>
	<li>Margarita v1.6 TDR.ppt (S)</li>
</ul>


<p> <br class="atl-forced-newline"></p>
<h1>
<a name="_Toc286388969"></a>(U) System Description</h1>
<h2>
<a name="_Toc199831548"></a><a name="_Toc286388970"></a> <em>(U) System Concepts and Capabilities</em>
</h2>
<ul>
	<li>(S) The Margarita configures an executable that will be used to perform a survey and/or do file collection.</li>
</ul>


<h2>
<a name="_Toc286388971"></a><em>Prerequisites</em>
</h2>
<ul>
	<li>(S) (S) Margarita requires .Net 4.5 on the configuration computer.</li>
</ul>


<h1>
<a name="_Toc286388972"></a>(U) Operation</h1>
<h2>
<a name="_Toc286388973"></a><em>(U) Installation and Setup</em>
</h2>
<ol>
	<li>(S) The Margarita v1.6 <span class="glossary">GUI<span class="glossary-tt">Graphical User Interface</span></span> configures various parameters of the survey and file collection.  Various environment variables (such as %temp%) can be used in collection and output fields.  Additionally, where output is being written, three additional variables are recognized that can be used to direct multiple surveys and collection to the same location:
	<ol>
		<li>%GUID% - a unique id string, changed for every launch</li>
		<li>%ft% - a hex string derived from the current time</li>
		<li>%st% - a readable time/date string</li>
		<li>%drive% - the drive letter of the flash drive (Ex: F:)</li>
	</ol>
	</li>
</ol>


<h2>
<a name="_Toc207007718"></a><a name="_Toc286388974"></a> <em>(U) Preparing a Margarita</em>
</h2>
<h3>
<a name="_Toc286388975"></a>(U) Initial Setup</h3>
<p>(S) Prior to use, a license key needs to be generated.  In the Admin folder is a program called licencesgen.exe.  Run this program and create a key with a valid start and end date.  In addition to the start and end date, it should be decided if the payload tab should be shown.  Once license.txt has be generated, but that file in the same folder as MargaritaWizard.exe
  <br class="atl-forced-newline">
(S) The following instructions provide information on how to configure the Margarita tool in the Station by a NOC.
<br class="atl-forced-newline">
(U) Double-click on MargaritaWizard.exe. The following user interface will appear:
<br class="atl-forced-newline"><img src="files/worddav58fe5ddb5fcc4c555232e7686f12ff68.png" height="382" width="576"><br><a name="_Toc245207017"></a><strong>Figure 1: (S) Margarita v1.6</strong> <strong>–</strong> <strong>Main Tab</strong><br class="atl-forced-newline">
(S) The interface will guide the user through the necessary configuration steps, and is laid out in a way that the user must click through all the pages before configuring the drive.
<br class="atl-forced-newline">
(S) The first tab (seen above) is the main tab. This tab allows the user to select the device or devices that they wish to configure, or post process (covered later).  On this tab simply select one or more of the drives listed and hit next.  If the device you wish to use isn't listed, ensure it is plugged in and hit refresh.
<br class="atl-forced-newline"><img src="files/worddavc903af330282fe1f1cacf0ebb6b39332.png" height="382" width="576"><br><strong>Figure 2: (S) Margarita v1.6 – Verification Tab</strong><br class="atl-forced-newline">
(S) The next tab, verifies the drives selected previously to ensure that the user has selected the proper device.  
<br class="atl-forced-newline">
(S) Furthermore, if the user desires to load a configuration that had been created previously the "Load Config" button can be selected.  If this is selected the subsequent boxes will be populated with data from the previous configuration.  The user will still be required to click through all this information, and can make any necessary changes.
<br class="atl-forced-newline"><img src="files/worddav37eb8dc44962dbe14233be561f5fc328.png" height="382" width="576"><br><strong>Figure 3: (S) Margarita v1.6 – Time out / indicator file / space to leave free</strong> 
<br class="atl-forced-newline">
(S) The next tab covers three options, the time out, indicator file, and space to leave free. 
<br class="atl-forced-newline">
(S) If desired, the user can select an applicable timeout.  This timeout will ensure that the survey and file collection will not run longer than the specified time.  Note, that if the timeout is hit, any file collection of survey data not collected will not be written to disk, and the program will just end.
<br class="atl-forced-newline">
(S) If a visual file indicating the successful and full completion of the survey and file collection is desired and indicator file can be requested.  This file will be a zero byte file created in the case of the all files and survey data being successfully collected.  Note, if the timeout is hit, a log file will not be created.
<br class="atl-forced-newline">
(S) Space to leave free is a required number, and must be set.  This ensure that the thumb drive doesn't become unusable for overt functions.  This value is the amount of space that will remain available for overt use, and must be at least 0.1 GB.  In addition, the amount of space available for file collection and survey data (i.e. total size – space to leave free) must be greater than 1 GB.  Drives not large enough to support this, are no longer supported.
<br class="atl-forced-newline"><br class="atl-forced-newline"><img src="files/worddavcc511d2b5ffc873880dba6f507b3d84d.png" height="382" width="576"><br><strong>Figure 4: (S) Survey Tab</strong><br class="atl-forced-newline">
(S) The next tab is for Survey options. Clicking the Enable survey options checkbox will enable the screen.  Below the "Enable Survey Options" checkbox is a field to specify the survey output directory. The survey output directory will be the location where the collection program will save the survey information. If the output directory is intended for the <span class="glossary">USB<span class="glossary-tt">Universal Serial Bus</span></span> drive, begin the path with a backslash. For example: <strong>\surveyOutput\surveydata.dat</strong>. <strong>Note: If a drive letter is included, the application will attempt to write the survey results to the exact path provided - it will not adjust to the drive letter of the <span class="glossary">USB<span class="glossary-tt">Universal Serial Bus</span></span> drive on the target machine.</strong> 
<br class="atl-forced-newline">
(S)Now the user can select specific survey options to run on the target. The first section is a set of canned Windows Management Instrumentation queries. 
<br class="atl-forced-newline">
(S)Note that the Browser survey collects information on Internet Explorer, Firefox, Chrome, Safari, and Opera such as bookmarks and history.  This option can be slow.
<br class="atl-forced-newline"><img src="files/worddav485e2ed17078ae0394a51771ccdcd6b5.png" height="382" width="576"><br><strong>Figure 5: (S) File Collection Tab</strong><br class="atl-forced-newline">
(S) The third tab allows for configurable File Collection. Again, the user must check the Enable file pattern collection check box to enable the screen. For each file pattern entered, collection criteria is created and saved as a row in the collection priorities table. Wildcards may be used in the file pattern field. For example, a file pattern of *<strong>.doc</strong> will collect all Microsoft Word docs off of all fixed drives in the system. A file pattern of <strong>C:*.doc</strong> will collect all Microsoft Word docs off of the C drive. Note that 2007 Office docs have an <strong>x</strong> on the extension, so to include all 2007 Word docs search with <strong>C:*.docx or C:*.doc</strong><strong>. To search for specific files, enter the entire path to the file: *C:\Program Files\sample.txt</strong>. 
<br class="atl-forced-newline">
(S) To enable the date controls and the min/max file size fields, the appropriate check boxes must be selected. Also for each file pattern, an output filename must be specified. This should be the full path to the file on the <span class="glossary">USB<span class="glossary-tt">Universal Serial Bus</span></span> drive, minus the drive letter (i.e. it should always start with a backslash such as "<strong>\output\outputFile.dat"</strong>). 
<br class="atl-forced-newline">
(S) Under the "Advanced Editor" clicking the new button will add a row to the table on the lower part of the screen. To add additional file patterns with different collection criteria, change the entries in the Collection Criteria area of the screen.  "Copy" will make a copy of the highlighted row and select it for editing.
 <br class="atl-forced-newline">
(S) Entries may be moved up and down within the table by clicking on the row of interest to move (it will be highlighted once it is selected), and then clicking the <strong>Up</strong> and <strong>Down</strong> buttons until the row is in the desired position. Note that collection will occur based on the priority of entries in the table, with the highest priority collection set starting at the top. Each collection set will run individually. So the application will run through the list starting at the beginning of the table. Once all files in the first collection set have been saved, it will move to the next row of the table and so on, until the <span class="glossary">USB<span class="glossary-tt">Universal Serial Bus</span></span> drive is filled to the limit.    
<br class="atl-forced-newline">
(S) To delete a row in the table, click on a row, (again it will be highlighted when selected), and then hit the <strong>Delete Row</strong> button or the red "X" on the side of the table.  
<br class="atl-forced-newline">
(S) There are checkboxes on the "File Collection" tab to make configuration easier.  Selecting any of the checkboxes will configure Margarita to collect the files listed to the right of the checkbox.  These files will be put in the folder that you type in the box below the checkboxes.  So if you specify "\Backup\MonthYear\" and the Office Docs and Mail checkboxes, Margarita will save the files collected to \Backup\MonthYear\doc and \Backup\MonthYear\mail respectively.  
<br class="atl-forced-newline"><img src="files/worddavdb4088078ccece20716bf3d087f4f6fd.png" width="576" height="382"><br><strong>Figure 6: (S) Additional collection details</strong><br class="atl-forced-newline">
(S) The next tab covers areas where you want Margarita to <strong>NOT</strong> collect files.  These directories are relative to each drive, so do not give a drive letter.  The paths allow wild cards, so you can specify \Windows\ and Margarita will not collect from Windows, or you could specify \Program Files* and on a 64-bit system Margarita would skip both \Program Files\ and Program Files (x86)\.  Margarita will still do a directory listing of the folders that are ignored.
<br class="atl-forced-newline">
(S) In addition, a previous hashfile can be loaded.  During execution the file collection piece creates a hash of any files collected.  This enables the drive to not collect files that were previously collected on subsequent runs.  During post processing these files are collected and saved.  If desired, the user can load a file from a previous collection to protect against duplication of work.
<br class="atl-forced-newline"><img src="files/worddavb613d3bae56c1ae7e0159c2a265de2f9.png" height="382" width="576"><br><strong>Figure 7: (S) Payload</strong><br class="atl-forced-newline"><br class="atl-forced-newline">
(S) The fourth tab, Payload, allows the user to specify a payload to drop on the target machine: See <strong>Figure 4</strong>. To select a payload click on the <strong>"…"</strong> button. A folder dialog will appear. Simply browse to the location of the payload file, and then click <strong>Open</strong>. The path to the payload may also be manually entered in the text box located to the right of the <strong>Find Payload</strong> button.  Any arguments used when launching the payload should be entered in the <strong>Payload Arguments</strong> text field. For example, if ipconfig is used as a payload it takes command line arguments such as <strong>/all</strong>. So at the command line a user would type:
<br class="atl-forced-newline">
 <strong>ipconfig /all</strong><br class="atl-forced-newline">
(S) To include command line arguments using Margarita v1.0, only the arguments are needed, so the user would enter only <strong>/all</strong> in the <strong>Payload Arguments</strong> text field.
<br class="atl-forced-newline">
(S) Only one path is needed on the target machine: the fully qualified path to the location where Margarita should drop the payload. 
<br class="atl-forced-newline"><img src="files/worddav438138a78dccbfa5c150784c52a369ab.png" height="382" width="576"><br><strong>Figure 8: (S) Blacklist Tab</strong><br class="atl-forced-newline">
(S) The Blacklist tab allows for a quick bailout if a targeted process is present.  While the program will still execute, it will quickly exit, thus hopefully avoiding any pop up alerts.  We tried to include all the major <span class="glossary">AV<span class="glossary-tt">Anti-Virus</span></span> vendors, and if selected all the listed processes will be added to the blacklist.  If any additional items are desired they can be added in the bottom box on the tab.
<br class="atl-forced-newline"><img src="files/worddavd3683740c95688a52a730d38e1d53ae8.png" height="382" width="576"><br><strong>Figure 9: (S) Execution Vector Tab</strong><br class="atl-forced-newline">
(S) The execution vectors tab allows the user to specify an execution vectors for Margarita.  
<br class="atl-forced-newline">
(S) Kamikaze is a configured binary that isn't meant to be used with a cover application.  This executable would be used in a situation where you are not under scrutiny and can just browse to the <span class="glossary">USB<span class="glossary-tt">Universal Serial Bus</span></span> drive and double click on the file.  In the "execution path" box enter the full path for the executable, starting with the drive letter.  <strong>For example, to put the file directly on the <span class="glossary">USB<span class="glossary-tt">Universal Serial Bus</span></span> drive, you might use E:\MargaritaPath\files\Margarita.exe.</strong>  The filename can be anything as long as it has a .exe extension.
<br class="atl-forced-newline">
(S) ScrewDriver is an encryption program called UPE that is similar to WinZip or WinRAR.  When files with specially configured names are added to the archive they will be automatically executed when the archive is opened.  See the ScrewDriver Guide for more details.
<br class="atl-forced-newline">
(S) Openbar is an ability to Trojan most publically available executable.  See the Openbar User's Guide for more details.
<br class="atl-forced-newline">
(S) ScrewDriver and Openbar can drop and run Margarita from different locations.  In the "execution path" box enter the directory on the <span class="glossary">USB<span class="glossary-tt">Universal Serial Bus</span></span> where you want to run Margarita, starting with a backslash, not the drive letter.  <strong>For example, \MargaritaPath\files\Margarita.exe.</strong>  The filename can be anything as long as it has a .exe extension.  
<br class="atl-forced-newline"></p>
<h3>
<a name="_Toc286388976"></a>(U) Additional Notes</h3>
<p>(S) Shortcut variables may also be used in the path names for the target entries and the file patterns.  For example, %temp%\dir1\dir2\payload.exe would be expanded as a payload executable directory.  Three additional environment variables are expanded if entered on the <span class="glossary">GUI<span class="glossary-tt">Graphical User Interface</span></span> for the "Survey output filename" and the "Specify output file" fields, as follows:
<br class="atl-forced-newline"></p>
<ul>
	<li>%GUID% - adds a <span class="glossary">GUID<span class="glossary-tt">Globally Unique Identifier</span></span> in the filepath</li>
	<li>%ft% - adds the filetime to the filepath</li>
	<li>%st% - adds the systemtime to the filepath</li>
</ul>


<p><br class="atl-forced-newline">
(S) So an example entry would be:</p>
<ul>
	<li>\Windows\System32%GUID%</li>
</ul>


<p><br class="atl-forced-newline">
(S) The <span class="glossary">GUI<span class="glossary-tt">Graphical User Interface</span></span> now allows for a user to save and/or load configuration files. The user must simply navigate to the file menu and select either "Load Configuration" or "Save Configuration" based on the action desired. The file menu also allows for individual tabs to be cleared, if necessary.</p>
<h3>
<a name="_Toc286388977"></a>(U) Application Configuration</h3>
<p>(S) Once all desired collection sets are in the table, and the exploit parameters are set, the user must navigate to the file menu, then select <strong>Configure Exploit</strong>, to configure the tool. The application now forces the user to save a configuration file before proceeding. Once configured, the tool will create the configured executable(s).  If an execution vector has been selected the file will be created in the same directory as the executable specified in the Main tab.
<br class="atl-forced-newline"></p>
<h2>
<a name="_Toc286388978"></a><em>(S) Initiating a Session on the Target System</em>
</h2>
<p>(S) Margarita will be executed on the target system via the NOC's execution vector of choice.  If no execution vector was chosen in the Execution Vector tab, Margarita will still output a basic, configured executable using the filename supplied in the Main tab.  This file could be double clicked on the target computer to run the survey.
<br class="atl-forced-newline"><strong>(S) IMPORTANT:  The collection process may take several minutes.</strong> <strong>If the drive is removed from the system before the collection completes, some survey/collection</strong> <strong>data may</strong> <strong>not be written to the thumb drive.  The user should allow the tool to complete the survey/collection and stop activity to the thumb drive.  There is no other visible indication that the process is finished.</strong> </p>
<h2>
<a name="_Toc286388979"></a><em>(U) Stopping and Suspending Work</em>
</h2>
<p>(S) The Margarita tool cannot be stopped once it is initiated. If the drive is removed while the tool is still running, it will terminate gracefully but only complete a partial collection.</p>
<h2>
<a name="_Toc286388980"></a> <em>(U) Assistance and Problem Reporting</em>
</h2>
<p>(S) Please contact EDG/AED/OSB for assistance.</p>
<h1>
<a name="_Toc286388981"></a>(U) Additional Operational Procedures</h1>
<h2>
<a name="_Toc286388982"></a><em>(U) Post Processing</em>
</h2>
<p><br class="atl-forced-newline">
(S) The following guidelines should be used to post process any survey/collection results from the Margarita tool:
<br class="atl-forced-newline"></p>
<ol>
	<li>(S) Plug the target thumb drive into an appropriately classified, controlled computer.  Note the letter assigned to the drive.</li>
</ol>


<p><br class="atl-forced-newline"></p>
<ol>
	<li>(S) Double click on MargaritaWizard.</li>
</ol>


<p><br class="atl-forced-newline"></p>
<ol>
	<li>(S) Click "Post Process!" and select "Next".</li>
</ol>


<p><br class="atl-forced-newline"><img src="files/worddav8c7a8245af1e1255058dbb1287b02104.png" height="382" width="576"><br><strong>Figure 10. Rehab post processing tool</strong><br class="atl-forced-newline">
(S) The collected data will be extracted to the current directory.  The system information will be extracted and sent to Internet Explorer to display.  (Note: often, the information collected contains data that invalidates the XML, so another <span class="glossary">XML<span class="glossary-tt">Extensible Markup Language</span></span> viewer such as Firefox may be desired).  The following directories and files will be created:
<br class="atl-forced-newline"></p>
<ul>
	<li>Directory Listing.txt</li>
	<li>SysInfo.xsl</li>
	<li>Arp Table.txt</li>
	<li>Routing Table.txt</li>
	<li>IP config.txt</li>
</ul>


<p><br class="atl-forced-newline"></p>
<ul>
	<li>Firefox information:
	<ul>
		<li>FirefoxBookmarks*</li>
		<li>bookmarks.html</li>
		<li>cookies.txt</li>
		<li>places.sqlite</li>
		<li>Firefox Cookies.txt</li>
		<li>Firefox History.txt</li>
	</ul>
	</li>
</ul>


<p><br class="atl-forced-newline"></p>
<ul>
	<li>Internet Explorer information:
	<ul>
		<li>IECookies*</li>
		<li>IEFavorites*</li>
		<li>IE History.txt</li>
	</ul>
	</li>
</ul>


<p><br class="atl-forced-newline"></p>
<h2>
<a name="_Toc286388983"></a>(U) Viewing the results</h2>
<p><br class="atl-forced-newline">
(S) The DirectoryListProcessor can be used to view the dirlist.txt files created by Rehab.  This will give you a Windows Explorer type view of the directory list.
<br class="atl-forced-newline">
(S) To run the tool, click "File" at the top of the screen and select "Open".  Browse to the dirlist.txt file created by Rehab and open it.  After a few minutes you will see a the directory list in an explorer type view.<br><img src="files/worddav785bbb24573ed384db49177fe696f060.png" height="481" width="576"><br><strong>Figure 6. Initial view</strong><br class="atl-forced-newline"><img src="files/worddavc14617ec974f5ac9b021c460d7df8d09.png" height="481" width="576"><br><strong>Figure 7. DirectoryListProcessor</strong><br class="atl-forced-newline"></p>
<h1>
<a name="_Toc286388984"></a>(U) Release Notes</h1>
<p><br class="atl-forced-newline"></p>
<h2>
<a name="_Toc286388985"></a>(U) Updates from previous v1.2 to v1.3</h2>
<ol>
	<li>Fixed a bug that caused the generic collection to happen before specific file collection.</li>
	<li>Added Martini compatability.</li>
	<li>Added MS Office and <span class="glossary">MRU<span class="glossary-tt">Most Recently Used</span></span> registry entries to the survey.</li>
	<li>Removed the requirement that you specify a logging file.</li>
	<li>Added error checking on output filenames.</li>
	<li>Fixed a bug that didn't save filetimes on the target system when post-processing.</li>
	<li>Fixed a bug that changed the file access time on files collected on <span class="glossary">XP<span class="glossary-tt">Windows operating system (Version)</span></span> machines.</li>
	<li>Moved the default location of configured ScrewDriver and Martini files to subfolders "ScrewDriver" and "Martini".</li>
	<li>Fixed a bug in Kamikaze creation.  If the path to the specified Kamikaze file didn't exist v1.2 would crash.  Now it tries to create the path.</li>
</ol>


<h2>(U) Updates from previous v1.2 to v1.3</h2>
<ol>
	<li>Added the "Do Not Walk" functionality to skip collecting files from specified directories.</li>
	<li>Added a dialog box for choosing the Kamikaze output.</li>
	<li>Rearranged text boxes so they lined up better.</li>
	<li>Added "Generic File Collection" capability.</li>
	<li>Added "Next" and "Back" buttons for navigating the configation.</li>
	<li>Added ability to re-prioritize the file collection table.</li>
	<li>Added ability to edit the file collection table in-place.</li>
	<li>Added the ability to create a file showing collection finished.</li>
</ol>


<h2>(U) Updates from previous v1.0 to v1.1</h2>
<ol>
	<li>Fixed a bug causing crashes during post-processing Browser data</li>
	<li>Fixed a bug in the Internet Explorer history collection</li>
	<li>Added code to avoid Kaspersky alerting on out of the box settings</li>
	<li>Fixed some dialog in the tool tips.</li>
	<li>Moved the executable path from the main tab to "Kamkaze" under the execution vectors</li>
	<li>Moved the survey output text box to be closer to where the file output text box is on the file collection tab</li>
	<li>Added the DirectoryListProcessing tool.</li>
</ol>


<p><br class="atl-forced-newline"><br class="atl-forced-newline"></p>
<h2>
<a name="_Toc286388986"></a>(U) Known <span class="glossary">PSP<span class="glossary-tt">Personal Security Product (Anti-Virus)</span></span> issues</h2>
<ol>
	<li>Kasperksy will pop yellow dialog boxes if it has been configured with high detection settings.</li>
	<li>If collecting *.evt files (event log files) Margarita does not collect all the files.</li>
</ol>


<p><br class="atl-forced-newline"><br class="atl-forced-newline"></p>
                    </div>
                </div>
            </div>

            <script type="text/javascript" src="../../highlighter/mootools-core-and-more.js"></script>
            <script type="text/javascript" src="../../highlighter/efatmarker.min.js"></script>
            <div id="efm-button">
            <div id="efm-menu">
                <h3 style="margin:0 0 2px 0">e-Highlighter</h3>
                <a id="efm-permalink" class="efm-need-highlight" href="page_6062108.html" style="margin-bottom:0;padding-bottom:0;"></a>
                <p style="margin-top:0;padding-top:0" class="efm-need-highlight">Click to send permalink to address bar, or right-click to copy permalink.</p>
                <p style="margin:0.5em 0;padding:0;border-top:1px dotted #ccc;height:1px"></p>
                <a id="efm-unhighlightall" class="efm-need-highlight">Un-highlight all</a>
                <a id="efm-unhighlight">Un-highlight selection<span>u</span></a>
                <a id="efm-highlight">Highlight selection<span>h</span></a>
                </div>
            </div>
            <script type="text/javascript">

            (function(){
            window.addEvent('domready', function(){

                var markerButton = $('efm-button');
                if ( markerButton ) {
                    eMarker = new EFatMarker($('uniquer'));
                    eMarker.tokenToSpans(); // apply whatever token is there
                    // need to act on mousedown or else selection disappear
                    markerButton.addEvent('mousedown', function(){
                        eMarker.interpretSelection(true);
                        return false;
                    });
                    $('efm-unhighlightall').addEvent('mousedown', function(){
                        eMarker.unhighlightAll(true);
                        return false;
                        });
                    $('efm-unhighlight').addEvent('mousedown', function(){
                        eMarker.unhighlightSelection(true);
                        return false;
                        });
                    $('efm-highlight').addEvent('mousedown', function(){
                        eMarker.highlightSelection(true);
                        return false;
                        });
                    $('efm-permalink').addEvent('mousedown', function(){
                        window.location.href = this.href;
                        return false;
                        });
                    // if Mootools Keyboard is available, use it
                    if (Keyboard) {
                        var keyboard = new Keyboard({
                            defaultEventType: 'keyup',
                            events: {
                                'h': function(){
                                    eMarker.highlightSelection(true);
                                    },
                                'u': function(){
                                    eMarker.unhighlightSelection(true);
                                    }
                                }
                            });
                        keyboard.activate();
                        }
                    eMarker.syncDOM();
                    // auto scroll to first highlight, if any
                    if (eMarker.hasSpans()) {
                        var scroll = new Fx.Scroll(window,{offset:{'x':0,'y':-100}}),
                            highlights = $$('#uniquer .efm-hi');
                        if (highlights.length > 0) {
                            scroll.toElement(highlights[0]);
                            }
                        }
                    }
                });
            })();
            </script>
            

<link href="../../static/css/styles_footer.css" rel="stylesheet">
<footer id="page-footer" class="footer-recommendations">
  <div class="footer-wrapper">
    <div class="recommendation-container">
      <a href="page_6062108.html#" class="top">Top</a>
      
        <ul class="recommendation-links">
          
            <li class="recommendation">
              <a href="https://www.torproject.org/" target="_blank">
                <div class="teaser"><img class="spip_logos" alt="" src="../../IMG/arton401.png?1461924517" width="300" height="180" /></div>
                <p>
<p>Tor is an encrypted anonymising network that makes it harder to intercept internet communications, or see where communications are coming from or going to.</p>
</p>
              </a>
            </li>
          
            <li class="recommendation">
              <a href="https://tails.boum.org/" target="_blank">
                <div class="teaser"><img class="spip_logos" alt="" src="../../IMG/arton405.png?1461924517" width="446" height="223" /></div>
                <p>
<p>Tails is a live operating system, that you can start on almost any computer from a DVD, USB stick, or SD card. It aims at preserving your privacy and anonymity.</p>
</p>
              </a>
            </li>
          
            <li class="recommendation">
              <a href="https://www.couragefound.org/" target="_blank">
                <div class="teaser"><img class="spip_logos" alt="" src="../../IMG/arton404.png?1461924517" width="357" height="50" /></div>
                <p>
<p>The Courage Foundation is an international organisation that supports those who risk life or liberty to make significant contributions to the historical record.</p>
</p>
              </a>
            </li>
          
            <li class="recommendation">
              <a href="https://www.bitcoin.org/" target="_blank">
                <div class="teaser"><img class="spip_logos" alt="" src="../../IMG/arton403.png?1461924517" width="300" height="64" /></div>
                <p>
<p>Bitcoin uses peer-to-peer technology to operate with no central authority or banks; managing transactions and the issuing of bitcoins is carried out collectively by the network.</p>
</p>
              </a>
            </li>
          
        </ul>
      
      <ul class="social-links">
        <li>
          <a href="https://www.facebook.com/wikileaks" target="_blank" alt="Facebook">
            <img src="../../static/img/fb-logo.png" alt="Facebook" title="Facebook page" />
          </a>
        </li>
        <li>
          <a href="https://twitter.com/wikileaks" target="_blank" alt="Twitter">
            <img src="../../static/img/twitter-logo.png" alt="Twitter" title="Twitter page" />
          </a>
        </li>
      </ul>
    </div>
  </div>
</footer>

        </div>

        <script src="../../bootstrap/js/jquery.min.js"></script>
        <script type="text/javascript">
        var $j = jQuery.noConflict();
        </script>
        <script src="../../bootstrap/js/bootstrap.min.js"></script>
    </body>
</html>
