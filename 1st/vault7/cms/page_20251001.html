<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="icon" type="image/png" href="http://localhost:6081/IMG/favicon.ico">
        <title>12. Bonus: Capture The Flag</title>
        <link href="../../bootstrap/css/bootstrap.min.css" rel="stylesheet">
        <link href="../../bootstrap/css/cerulean.min.css" rel="stylesheet">
        <link href="../../bootstrap/css/new-gen.css" rel="stylesheet">
        <link href="../../css/leak-styles.css" rel="stylesheet">
        <link href="../../highlighter/efatmarker.css" rel="stylesheet">
        <style>
          #efm-button {margin:0 0 4px 0;padding:0 0 0 30px;position:fixed;height:48px;width:52px;bottom:0;right:0;background:transparent '/highlighter/kedit-2.png' no-repeat bottom right;cursor:pointer;opacity:0.4;z-index:99999999999}
          #efm-button:hover {opacity:1}
          #efm-button #efm-menu {margin:0 0 52px 0;border:1px outset gray;padding:0;display:none;background:#eee;position:fixed;bottom:0;right:0;width:20em;opacity:1;cursor:auto}
          #efm-button:hover #efm-menu {display:block;font-size:smaller;color:#999}
          #efm-button #efm-menu p {margin:0;padding:0 3px}
          #efm-button #efm-menu a {margin:1px;padding:3px 3px;display:block;font:12px sans-serif;white-space:nowrap;opacity:inherit;cursor:pointer}
          #efm-button #efm-menu a:hover {color:black;background-color:white;opacity:1}
          #efm-button #efm-menu a > span {color:gray;position:absolute;right:4px}
          .efm-hi {background-color:#ff8;font-weight:normal;}
        </style>
        <link href="../../bootstrap/css/submit.css" rel="stylesheet">
        <link href="main.css" rel="stylesheet">
    </head>
    <body>
        <div id="submit_wlkey" class="submit_elem">
	<div class="container">
		<div class="text-center"><div class="submit_buttons btn-group" role="group">
			<a href="page_20251001.html#submit_help_contact" class="btn-wl btn-wl-empty">How to contact WikiLeaks?</a>
			<a href="page_20251001.html#submit_help_tor" class="btn-wl btn-wl-empty">What is Tor?</a>
			<a href="page_20251001.html#submit_help_tips" class="btn-wl btn-wl-empty">Tips for Sources</a>
			<a href="page_20251001.html#submit_help_after" class="btn-wl btn-wl-empty">After Submitting</a>
		</div></div>
		<p>This key's fingerprint is A04C 5E09 ED02 B328 03EB  6116 93ED 732E 9231 8DBA</p>
		<pre>
-----BEGIN PGP PUBLIC KEY BLOCK-----

mQQNBFUoCGgBIADFLp+QonWyK8L6SPsNrnhwgfCxCk6OUHRIHReAsgAUXegpfg0b
rsoHbeI5W9s5to/MUGwULHj59M6AvT+DS5rmrThgrND8Dt0dO+XW88bmTXHsFg9K
jgf1wUpTLq73iWnSBo1m1Z14BmvkROG6M7+vQneCXBFOyFZxWdUSQ15vdzjr4yPR
oMZjxCIFxe+QL+pNpkXd/St2b6UxiKB9HT9CXaezXrjbRgIzCeV6a5TFfcnhncpO
ve59rGK3/az7cmjd6cOFo1Iw0J63TGBxDmDTZ0H3ecQvwDnzQSbgepiqbx4VoNmH
OxpInVNv3AAluIJqN7RbPeWrkohh3EQ1j+lnYGMhBktX0gAyyYSrkAEKmaP6Kk4j
/ZNkniw5iqMBY+v/yKW4LCmtLfe32kYs5OdreUpSv5zWvgL9sZ+4962YNKtnaBK3
1hztlJ+xwhqalOCeUYgc0Clbkw+sgqFVnmw5lP4/fQNGxqCO7Tdy6pswmBZlOkmH
XXfti6hasVCjT1MhemI7KwOmz/KzZqRlzgg5ibCzftt2GBcV3a1+i357YB5/3wXE
j0vkd+SzFioqdq5Ppr+//IK3WX0jzWS3N5Lxw31q8fqfWZyKJPFbAvHlJ5ez7wKA
1iS9krDfnysv0BUHf8elizydmsrPWN944Flw1tOFjW46j4uAxSbRBp284wiFmV8N
TeQjBI8Ku8NtRDleriV3djATCg2SSNsDhNxSlOnPTM5U1bmh+Ehk8eHE3hgn9lRp
2kkpwafD9pXaqNWJMpD4Amk60L3N+yUrbFWERwncrk3DpGmdzge/tl/UBldPoOeK
p3shjXMdpSIqlwlB47Xdml3Cd8HkUz8r05xqJ4DutzT00ouP49W4jqjWU9bTuM48
LRhrOpjvp5uPu0aIyt4BZgpce5QGLwXONTRX+bsTyEFEN3EO6XLeLFJb2jhddj7O
DmluDPN9aj639E4vjGZ90Vpz4HpN7JULSzsnk+ZkEf2XnliRody3SwqyREjrEBui
9ktbd0hAeahKuwia0zHyo5+1BjXt3UHiM5fQN93GB0hkXaKUarZ99d7XciTzFtye
/MWToGTYJq9bM/qWAGO1RmYgNr+gSF/fQBzHeSbRN5tbJKz6oG4NuGCRJGB2aeXW
TIp/VdouS5I9jFLapzaQUvtdmpaeslIos7gY6TZxWO06Q7AaINgr+SBUvvrff/Nl
l2PRPYYye35MDs0b+mI5IXpjUuBC+s59gI6YlPqOHXkKFNbI3VxuYB0VJJIrGqIu
Fv2CXwy5HvR3eIOZ2jLAfsHmTEJhriPJ1sUG0qlfNOQGMIGw9jSiy/iQde1u3ZoF
so7sXlmBLck9zRMEWRJoI/mgCDEpWqLX7hTTABEBAAG0x1dpa2lMZWFrcyBFZGl0
b3JpYWwgT2ZmaWNlIEhpZ2ggU2VjdXJpdHkgQ29tbXVuaWNhdGlvbiBLZXkgKFlv
dSBjYW4gY29udGFjdCBXaWtpTGVha3MgYXQgaHR0cDovL3dsY2hhdGMzcGp3cGxp
NXIub25pb24gYW5kIGh0dHBzOi8vd2lraWxlYWtzLm9yZy90YWxrKSA8Y29udGFj
dC11cy11c2luZy1vdXItY2hhdC1zeXN0ZW1Ad2lraWxlYWtzLm9yZz6JBD0EEwEK
ACcCGwMFCwkIBwMFFQoJCAsFFgIDAQACHgECF4AFAlb6cdIFCQOznOoACgkQk+1z
LpIxjbrlqh/7B2yBrryWhQMGFj+xr9TIj32vgUIMohq94XYqAjOnYdEGhb5u5B5p
BNowcqdFB1SOEvX7MhxGAqYocMT7zz2AkG3kpf9f7gOAG7qA1sRiB+R7mZtUr9Kv
fQSsRFPb6RNzqqB9I9wPNGhBh1YWusUPluLINwbjTMnHXeL96HgdLT+fIBa8ROmn
0fjJVoWYHG8QtsKiZ+lo2m/J4HyuJanAYPgL6isSu/1bBSwhEIehlQIfXZuS3j35
12SsO1Zj2BBdgUIrADdMAMLneTs7oc1/PwxWYQ4OTdkay2deg1g/N6YqM2N7rn1W
7A6tmuH7dfMlhcqw8bf5veyag3RpKHGcm7utDB6k/bMBDMnKazUnM2VQoi1mutHj
kTCWn/vF1RVz3XbcPH94gbKxcuBi8cjXmSWNZxEBsbirj/CNmsM32Ikm+WIhBvi3
1mWvcArC3JSUon8RRXype4ESpwEQZd6zsrbhgH4UqF56pcFT2ubnqKu4wtgOECsw
K0dHyNEiOM1lL919wWDXH9tuQXWTzGsUznktw0cJbBVY1dGxVtGZJDPqEGatvmiR
o+UmLKWyxTScBm5o3zRm3iyU10d4gka0dxsSQMl1BRD3G6b+NvnBEsV/+KCjxqLU
vhDNup1AsJ1OhyqPydj5uyiWZCxlXWQPk4p5WWrGZdBDduxiZ2FTj17hu8S4a5A4
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
J3x7gtxUMkTadELqwY6hrU8=
=BLTH
-----END PGP PUBLIC KEY BLOCK-----
		</pre>
	</div>
</div>

<div id="submit_help_contact" class="submit_elem">
	<div class="container">
		<div class="text-center"><div class="submit_buttons btn-group" role="group">
			<a href="page_20251001.html#submit_help_contact" class="btn-wl">How to contact WikiLeaks?</a>
			<a href="page_20251001.html#submit_help_tor" class="btn-wl btn-wl-empty">What is Tor?</a>
			<a href="page_20251001.html#submit_help_tips" class="btn-wl btn-wl-empty">Tips for Sources</a>
			<a href="page_20251001.html#submit_help_after" class="btn-wl btn-wl-empty">After Submitting</a>
		</div></div>

		<h3>Contact</h3>
		<p>If you need help using Tor you can contact WikiLeaks for assistance in setting it up using our simple webchat available at: <a href="https://wikileaks.org/talk">https://wikileaks.org/talk</a></p>
		<p>If you can use Tor, but need to contact WikiLeaks for other reasons use our secured webchat available at <b>http://wlchatc3pjwpli5r.onion</b></p>
		<p>We recommend contacting us over Tor if you can.</p>
	</div>
</div>

<div id="submit_help_tor" class="submit_elem">
	<div class="container">
		<div class="text-center"><div class="submit_buttons btn-group" role="group">
			<a href="page_20251001.html#submit_help_contact" class="btn-wl btn-wl-empty">How to contact WikiLeaks?</a>
			<a href="page_20251001.html#submit_help_tor" class="btn-wl">What is Tor?</a>
			<a href="page_20251001.html#submit_help_tips" class="btn-wl btn-wl-empty">Tips for Sources</a>
			<a href="page_20251001.html#submit_help_after" class="btn-wl btn-wl-empty">After Submitting</a>
		</div></div>

		<h3>Tor</h3>
		<p><a href="https://www.torproject.org">Tor</a> is an encrypted anonymising network that makes it harder to intercept internet communications, or see where communications are coming from or going to.</p>
		<p>In order to use the WikiLeaks public submission system as detailed above you can download the Tor Browser Bundle, which is a Firefox-like browser available for Windows, Mac OS X and GNU/Linux and pre-configured to connect using the anonymising system Tor.</p>
		<h4>Tails</h4>
		<p>If you are at high risk and you have the capacity to do so, you can also access the submission system through a secure operating system called <a href="https://tails.boum.org">Tails</a>. Tails is an operating system launched from a USB stick or a DVD that aim to leaves no traces when the computer is shut down after use and automatically routes your internet traffic through Tor. Tails will require you to have either a USB stick or a DVD at least 4GB big and a laptop or desktop computer.</p>
	</div>
</div>

<div id="submit_help_tips" class="submit_elem">
	<div class="container">
		<div class="text-center">
			<div class="submit_buttons btn-group" role="group">
				<a href="page_20251001.html#submit_help_contact" class="btn-wl btn-wl-empty">How to contact WikiLeaks?</a>
				<a href="page_20251001.html#submit_help_tor" class="btn-wl btn-wl-empty">What is Tor?</a>
				<a href="page_20251001.html#submit_help_tips" class="btn-wl">Tips for Sources</a>
				<a href="page_20251001.html#submit_help_after" class="btn-wl btn-wl-empty">After Submitting</a>
			</div>
		</div>

		<h3>Tips</h3>
		<p>Our submission system works hard to preserve your anonymity, but we recommend you also take some of your own precautions. Please review these basic guidelines. </p>
		<div>
			<h4>1. Contact us if you have specific problems</h4>
			<p>If you have a very large submission, or a submission with a complex format, or are a high-risk source, please <a href="page_20251001.html#submit_help_contact">contact us</a>. In our experience it is always possible to find a custom solution for even the most seemingly difficult situations.</p>
		</div>
		<div>
			<h4>2. What computer to use</h4>
			<p>If the computer you are uploading from could subsequently be audited in an investigation, consider using a computer that is not easily tied to you. Technical users can also use <a href="https://tails.boum.org">Tails</a> to help ensure you do not leave any records of your submission on the computer.</p>
		</div>
		<div>
			<h4>3. Do not talk about your submission to others</h4>
			<p>If you have any issues talk to WikiLeaks. We are the global experts in source protection – it is a complex field. Even those who mean well often do not have the experience or expertise to advise properly. This includes other media organisations.</p>
		</div>

	</div>
</div>

<div id="submit_help_after" class="submit_elem">
	<div class="container">
		<div class="text-center">
			<div class="submit_buttons btn-group" role="group">
				<a href="page_20251001.html#submit_help_contact" class="btn-wl btn-wl-empty">How to contact WikiLeaks?</a>
				<a href="page_20251001.html#submit_help_tor" class="btn-wl btn-wl-empty">What is Tor?</a>
				<a href="page_20251001.html#submit_help_tips" class="btn-wl btn-wl-empty">Tips for Sources</a>
				<a href="page_20251001.html#submit_help_after" class="btn-wl">After Submitting</a>
			</div>
		</div>

		<h3>After</h3>

		<div>
			<h4>1. Do not talk about your submission to others</h4>
			<p>If you have any issues talk to WikiLeaks. We are the global experts in source protection – it is a complex field. Even those who mean well often do not have the experience or expertise to advise properly. This includes other media organisations.</p>
		</div>

		<div>
			<h4>2. Act normal</h4>
			<p>If you are a high-risk source, avoid saying anything or doing anything after submitting which might promote suspicion. In particular, you should try to stick to your normal routine and behaviour.</p>
		</div>

		<div>
			<h4>3. Remove traces of your submission</h4>
			<p>If you are a high-risk source and the computer you prepared your submission on, or uploaded it from, could subsequently be audited in an investigation, we recommend that you format and dispose of the computer hard drive and any other storage media you used.</p>
			<p>In particular, hard drives retain data after formatting which may be visible to a digital forensics team and flash media (USB sticks, memory cards and SSD drives) retain data even after a secure erasure. If you used flash media to store sensitive data, it is important to destroy the media.</p>
			<p>If you do this and are a high-risk source you should make sure there are no traces of the clean-up, since such traces themselves may draw suspicion.</p>
			<div>
				<h4>4. If you face legal action</h4>
				<p>If a legal action is brought against you as a result of your submission, there are organisations that may help you. The Courage Foundation is an international organisation dedicated to the protection of journalistic sources. You can find more details at <a href="https://www.couragefound.org">https://www.couragefound.org</a>.</p>
			</div>
		</div>
	</div>
</div>

<div id="submit" class="submit_banner">
	<div class="container">
		<div class="page-header">
			<h1>Submit documents to WikiLeaks</h1>
			<a class="remove-button" href="page_20251001.html#"><span class="glyphicon glyphicon-remove-circle"></span></a>
		</div>
		<p>WikiLeaks publishes documents of political or historical importance that are censored or otherwise suppressed. We specialise in strategic global publishing and large archives.</p>
		<p>The following is the address of our secure site where you can anonymously upload your documents to WikiLeaks editors. You can only access this submissions system through Tor. (See our <a href="page_20251001.html#submit_help_tor">Tor tab</a> for more information.) We also advise you to read our <a href="page_20251001.html#submit_help_tips">tips for sources</a> before submitting.</p>

		<div class="alert alert-info">
			<div class="onion-url">wlupld3ptjvsgwqw.onion</div>
			<div>
				Copy this address into your Tor browser. Advanced users, if they wish, can also add a further layer of encryption to their submission using <a href="page_20251001.html#submit_wlkey">our public PGP key</a>.
			</div>
		</div>

		<p>If you cannot use Tor, or your submission is very large, or you have specific requirements, WikiLeaks provides several alternative methods. <a href="page_20251001.html#submit_help_contact">Contact us</a> to discuss how to proceed.</p>
	</div>
</div>
<div id="submit_help_buttons" class="submit_elem">
	<div class="container">
		<div class="text-center">
			<div class="submit_buttons btn-group" role="group">
				<a href="page_20251001.html#submit_help_contact" class="btn-wl btn-wl-empty">How to contact WikiLeaks?</a>
				<a href="page_20251001.html#submit_help_tor" class="btn-wl btn-wl-empty">What is Tor?</a>
				<a href="page_20251001.html#submit_help_tips" class="btn-wl btn-wl-empty">Tips for Sources</a>
				<a href="page_20251001.html#submit_help_after" class="btn-wl btn-wl-empty">After Submitting</a>
			</div>
		</div>
	</div>
</div>

        <div id="main">
            

<link href="../../static/css/styles_topnav.css" rel="stylesheet">
<link href="../../static/css/styles_sidenav.css" rel="stylesheet">
<div class="top-navigation">
  <nav class="navbar">
      <a href="page_20251001.html#menu" class="mobile-only hot-dog nav-element">
      </a>
    <div class="nav-logo">
      <a href="https://wikileaks.org">
        <h1>WikiLeaks</h1>
      </a>
    </div>
    <div class="action-buttons">
      <a class="button-face support-link" href="https://wikileaks.spreadshirt.com/" target="_blank">Shop</a>
      <a class="button-face donate-link" href="https://shop.wikileaks.org/donate">Donate</a>
      <a class="button-face submit-link" href="page_20251001.html#submit">Submit</a>
    </div>
    <form class="global-search" method="get" action="https://search.wikileaks.org/">
      <input type="text" name="q" placeholder="Search">
      <button class="btn-search" type="submit"></button>
    </form>
    <div class="main-nav">
      
        <ul class="first-level">
          
            <li>
              <a class=" leaks-menu-item" href="https://wikileaks.org/-Leaks-.html">Leaks</a>
            </li>
          
            <li>
              <a class=" news-menu-item" href="https://wikileaks.org/-News-.html">News</a>
            </li>
          
            <li>
              <a class=" about-menu-item" href="https://wikileaks.org/-About-66-.html">About</a>
            </li>
          
            <li>
              <a class=" partners-menu-item" href="https://wikileaks.org/-Partners-.html">Partners</a>
            </li>
          
        </ul>
      
    </div>
  </nav>
</div><nav id="menu" class="side-nav rub">
  <div class="menu-wrapper">
    <a class="close-btn nav-element" href="page_20251001.html#"></a>
    
      <ul class="first-level">
        
          <li>
            <a class=" leaks-menu-item" href="https://wikileaks.org/-Leaks-.html">Leaks</a>
            
          </li>
        
          <li>
            <a class=" news-menu-item" href="https://wikileaks.org/-News-.html">News</a>
            
          </li>
        
          <li>
            <a class=" about-menu-item" href="https://wikileaks.org/-About-66-.html">About</a>
            
          </li>
        
          <li>
            <a class=" partners-menu-item" href="https://wikileaks.org/-Partners-.html">Partners</a>
            
          </li>
        
      </ul>
    
    <aside class="friends mobile-only">
      
        <ul class="first-level">
          
            <li>
              <a href="https://www.torproject.org/" target="_blank">Tor Project</a>
            </li>
          
            <li>
              <a href="https://tails.boum.org/" target="_blank">Tails</a>
            </li>
          
            <li>
              <a href="https://www.couragefound.org/" target="_blank">Courage</a>
            </li>
          
            <li>
              <a href="https://www.bitcoin.org/" target="_blank">Bitcoin</a>
            </li>
          
        </ul>
      
    </aside>
    <aside class="social mobile-only">
      <ul>
        <li>
          <a href="https://www.facebook.com/wikileaks" class="nav-element" target="_blank" alt="Facebook">
            <img class="img-responsive" src="../../static/img/fb-logo.png" alt="Facebook" title="Facebook page" />
          </a>
        </li>
        <li>
          <a href="https://twitter.com/wikileaks" class="nav-element" target="_blank" alt="Twitter">
            <img class="img-responsive" src="../../static/img/twitter-logo.png" alt="Twitter" title="Twitter page" />
          </a>
        </li>
      </ul>
    </aside>
  </div>
</nav>

            <div class="container-fluid row-fluid">
                <div class="col-xs-12 col-sm-12 col-md-10 container-text">
                    <div class="leak-header">
                        <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body>
<div class="title-area">
    <h1 class="leak-title">Vault7: CIA Hacking Tools Revealed</h1>
    <img src="../logo.png">
</div>

</body></html>

                        <ul class="leak-navigation">
                            <a href="../index.html"><li>Releases</li></a>
                            <a href="index.html"><li class="active">Documents</li></a>
                       </ul>
                    </div>
                    <p>Navigation:  » <a href="page_16385438.html">Latest version</a></p>
<hr>
                    <div id="uniquer">
                        <h2>12. Bonus: Capture The Flag</h2>
<div class="warning"><p style="text-align: center;"><strong>SECRET//NOFORN</strong></p></div>
<p> </p>
<h1 style="text-align: center;"><strong>Capture The Flag</strong></h1>
<p><strong><br></strong></p>
<p><strong><img src="files/image2015-5-7&#32;14:56:56.png" width="400" align="center"></strong></p>
<p> </p>
<p> </p>
<p><i>('excerpt' missing)</i></p> <h2><span style="color: rgb(0,51,102);">Setup</span></h2>
<p>On the share (\\FS-01\share\NewDeveloperExercises\CaptureTheFlag) there is a <span class="glossary">VM<span class="glossary-tt">Virtual Machine</span></span> titled "New Developer <span class="glossary">CTF<span class="glossary-tt">Capture the Flag</span></span> Windows 8.1 x64.zip". Copy the zip to your local machine and extract the VM. If VMWare asks, you copied it. The <span class="glossary">CTF<span class="glossary-tt">Capture the Flag</span></span> snapshot sets the baseline for the challenge. If you ever run into issues with the state of the <span class="glossary">VM<span class="glossary-tt">Virtual Machine</span></span> you can always revert to this snapshot and contiue the challenges. Next, you will want to register on the <span class="glossary">CTF<span class="glossary-tt">Capture the Flag</span></span> website. Once you have finished registering, you can submit flags as well as view the current scoreboard. </p>
<h2><span style="color: rgb(0,51,102);">Submitting Answers</span></h2>
<p>To submit answers, go to the <span class="glossary">CTF<span class="glossary-tt">Capture the Flag</span></span> website and copy the SHA-256 string into the flag submission form. If the SHA-256 is correct you'll see your score updated. If it is incorrect, you'll be notified of the invalid submission.</p>
<p> </p>
<h2><span style="color: rgb(0,51,102);">Challenge 1: Survey</span></h2>
<p><span style="color: rgb(0,51,102);"><br></span></p>
<div class="panel"><div class="rich-text-body">
<p>For this challenge you will be collecting information about the target machine (<span class="glossary">CTF<span class="glossary-tt">Capture the Flag</span></span> <span class="glossary">VM<span class="glossary-tt">Virtual Machine</span></span>). This is useful for understanding future deployments against a machine. Surveys can reveal many things about a machine and its network.</p>
<p><strong>Challenge 1</strong>: To capture this flag you will need to collect the following information about the <span class="glossary">CTF<span class="glossary-tt">Capture the Flag</span></span> VM. All strings should be wide character.</p>
<ol>
<li><p>Machine GUID</p></li>
<li>User Name<br><br>
</li>
<li>Computer Name<br><br>
</li>
<li><p>Installed Applications</p></li>
<li><p>Network Card <span class="glossary">MAC<span class="glossary-tt">Apple Operating System</span></span> Addresses</p></li>
<li>List of all mounted volumes<br><br>
</li>
<li><p>Process List</p></li>
</ol>
<p> </p>
<p>Now, have your tool output the survey data (raw) into a file in Desktop\Results\Survey\Survet.txt. Shortly after, you'll have your first flag! </p>
<div class="emoticon-smile"></div>
</div></div>
<p> </p>
<h2><span style="color: rgb(0,51,102);">Challenge 2: File Collection</span></h2>
<p><span style="color: rgb(0,51,102);"><br></span></p>
<div class="panel"><div class="rich-text-body">
<p>File Collection is also an important part of what we do. Remember the main goal is to enable the collection of FI. In this line of work we run into limitations that aren't always a problem for normal software developers. Unfortunately, we often run into bandwitdth and/or time constraints when trying to retreive information from a target computer. Thus, when designing or configuring a tool, compression, throttling, collection prioritization, and file flattening are things you should consider.</p>
<p><strong>Challenge 2</strong>: Collect all of the files from <span><span class="user">User #?</span>'s user directory (C:\Users\<span class="user">User #?</span>) with the extensions *.doc, *.docx, *.xlsx, and *.pdf. You will then need to reconstruct the collected files in the Results\File Collection folder on the Desktop. Maintain all file timestamps.</span></p>
<p>For example, let's say I collected the following files:</p>
<p>C:\Users\<span class="user">User #?</span>\Desktop\Passwords.xlsx</p>
<p>C:\Users\<span class="user">User #?</span>\Pictures\MyContacts.docx</p>
<p>C:\Users\<span class="user">User #?</span>\AppData\Local\Temp\WhereIKeepMyNukes.pdf</p>
<p> </p>
<p>Then, the folder structure in the Results\File Collection directory would look like this:</p>
<p> </p>
<p>_C</p>
<p style="margin-left: 30.0px;">Users</p>
<p style="margin-left: 60.0px;"><span class="user">User #?</span></p>
<p style="margin-left: 90.0px;">Desktop</p>
<p style="margin-left: 120.0px;">Passwords.xlsx</p>
<p style="margin-left: 90.0px;">Pictures</p>
<p style="margin-left: 120.0px;">MyContacts.docx</p>
<p style="margin-left: 90.0px;">AppData</p>
<p style="margin-left: 120.0px;">Local</p>
<p style="margin-left: 150.0px;">Temp</p>
<p style="margin-left: 180.0px;">WhereIKeepMyNukes.pdf</p>
<p style="margin-left: 180.0px;"> </p>
<p>**NOTE** Notice that the the results folder on the Desktop is underneath C:\Users\<span class="user">User #?</span>. Therefore, you will need to make sure you exclude the Results folder from your file collection.</p>
<p>Do not compress or encrypt any of the collected files. When you are done, signal the watcher that all files are collected by setting an event with the name {DEC334AC-E1E3-4582-9D4D-75A6201F053B} (See MSDN: OpenEvent and SetEvent). After your files are validated, your second flag should then appear!</p>
</div></div>
<p> </p>
<h2><span style="color: rgb(0,51,102);">Challenge 3: Compression and Encryption</span></h2>
<p><span style="color: rgb(0,51,102);"><br></span></p>
<div class="panel"><div class="rich-text-body">
<p>Almost all of our tools utilize some combination of compression and encryption. Whenever we're sending data back over the internet, or storing the data for later exfil, it needs to be protected. The type of compression and encryption used is dependent upon many factors and should be decided on a per tool basis. SecureBuffer (or the buffer library) is a library of readily available compression and encryption algorithms (there should never be a need to roll your own compression or encryption - these are very signaturable things). So, for this challenge you will need to download the attached files (ImprovedDummy.exe, PubKey.pem).</p>
<p><strong>Challenge 3</strong>: Compress and encrypt the dummy payload to retrieve the flag.</p>
<ul style="list-style-type: square;">
<li>Download the attached files (ImprovedDummy.exe, PubKey.pem)</li>
<li>Use SecureBuffer/Buffers Library) to compress the binary using ZLIB compression.</li>
<li>Encrypt the buffer using <span class="glossary">RSA<span class="glossary-tt">Encryption algorithm</span></span> 4096/AES 256 and the supplied public key</li>
<li>Dump the buffer into a file (raw) named ImprovedDummy.exe.enc in Results\Compression and Encryption</li>
</ul>
<p> </p>
<p> </p>
<p>The watcher on the wall will give you the third flag upon completion.</p>
<p> </p>
<p><a href="files/ImprovedDummy.exe.pdf">ImprovedDummy.exe</a> | <a href="files/publicKey.pem">publicKey.pem</a></p>
</div></div>
<p> </p>
<h2><span style="color: rgb(0,51,102);">Challenge 4: Payload Deployment</span></h2>
<p><span style="color: rgb(0,51,102);"><br></span></p>
<div class="panel"><div class="rich-text-body">
<p>Many of our tools utilize other processes on the machine (sometimes our own). Since we develop tools to do specific tasks, it is important that many of our tools have the ability to load/kick off other tools.</p>
<p><strong>Challenge 4</strong>: Use Windows Management Instrumentation to execute a command.</p>
<ul>
<li>See <span class="glossary">MSDN<span class="glossary-tt">Microsoft Developer Network</span></span> Win32_Process and Win32_ProcessStartup</li>
<li>Take a look at some of the examples of <span class="glossary">WMI<span class="glossary-tt">Windows Management Instrumentation</span></span> online</li>
<li>Now, execute the process C:\Test\CTF\Dummy.exe with the args Give Me The Flag (4 args) using WMI. You must also execute the command with the Error Mode (Win32_ProcessStartup -&gt; ErrorMode) set to 1 (SEM_FAILCRITICALERRORS).</li>
<li>Upon executing correctly, your flag should appear.</li>
</ul>
<p style="margin-left: 30.0px;"> </p>
</div></div>
<p> </p>
<h2><span style="color: rgb(0,51,102);">Challenge 5: System Monitoring &amp; Manipulation</span></h2>
<p><span style="color: rgb(0,51,102);"><br></span></p>
<div class="panel"><div class="rich-text-body">
<p>Sometimes our implants need to react to what is happening on target. This could be recording actions the target is taking or changing what the implant itself does (only exfil data when the target is browsing the internet). Windows often utilizes messages and events to notify stakeholders of certain actions (like if a removable media device has been plugged in).</p>
<p><strong>Challenge 5</strong>: Set up a notification hook for HKEY_CURRENT_USER\Software\CTF.</p>
<ul>
<li>Set up a notification hook to receive notifications for any new subkeys</li>
<li>Every 30 seconds a subkey is generated and is deleted 5 seconds later</li>
<li>Once you receive the notification, enumerate the <span class="glossary">CTF<span class="glossary-tt">Capture the Flag</span></span> subkeys to find a new value on one of the keys with the key name of "FLAG". The flag is the default value of the FLAG key.</li>
</ul>
<p style="margin-left: 30.0px;"> </p>
</div></div>
<p><span style="color: rgb(0,51,102);"><br></span></p>
<h2><span style="color: rgb(0,51,102);">Challenge 6: Persistence</span></h2>
<p><span style="color: rgb(0,51,102);"><br></span></p>
<div class="panel"><div class="rich-text-body">
<p>To maintain access to a machine we want to modify the target machine in a way that our code/binary is re-run after it has been stopped (reboot, logoff, possibly even wiped). To do this we can take advantage of mechanisms that Windows itself uses as well as flaws found in the startup process.</p>
<p><strong>Challenge 6</strong>: Use the Task Scheduler, a well-known persistence mechanism, to persist ImprovedDummy across logon/logoff.</p>
<ul style="list-style-type: square;">
<li>See <span class="glossary">MSDN<span class="glossary-tt">Microsoft Developer Network</span></span> ITaskScheduler (v1.0)</li>
<li>The ITaskScheduler is a COM interface (a big part of Windows object-oriented design).</li>
<li>Create a scheduled task that persists C:\Users\<span class="user">User #?</span>\AppData\Roaming\Persist.exe</li>
<li>Name the task CTF</li>
<li>Create a trigger so that the command is run everytime a logon event occurs for <span class="user">User #?</span>.</li>
<li>Although not required, try to go through and understand all that is happening with the COM calls that are required.</li>
</ul>
<p style="margin-left: 30.0px;"> </p>
<p>To retrieve the flag, restart the VM.</p>
</div></div>
<p> </p>
<h2><span style="color: rgb(0,51,102);">Challenge 7: Data Transfer</span></h2>
<p><span style="color: rgb(0,51,102);"><br></span></p>
<div class="panel"><div class="rich-text-body">
<p>Once we have taken our surveys and collect our files the next step is getting that data back to IOC. There is no common interface for transferring data. Sometimes it's storing data on removable media and sometimes it's mimicking web traffic. In some cases, we can send data to another process so that it can exfil.</p>
<p><strong>Challenge 7</strong>: Assume that the watcher process has a cool technique for mimicking web traffic. Anything that it receives over its named pipe it will forward to the <span class="glossary">LP<span class="glossary-tt">Listening Post</span></span> (listening post) via the internet to an <span class="glossary">IOC<span class="glossary-tt">Information Operation Center</span></span> LP.</p>
<ul style="list-style-type: square;">
<li>Use the survey code from Challenge 1.</li>
<li>Connect to the named pipe \\.\pipe\{5A426ADB-11B3-4492-8602-380317833226}</li>
<li>Send the survey data over the named pipe.<br>** To complete successfully you need to write bytes to the pipe that are read from Survey.txt rather than writing the survey data directly to the pipe **</li>
</ul>
<p>Once the data is received by the LP, the first half of the flag will appear.</p>
<p>To obtain the second half of the flag you will use the Windows Sockets <span class="glossary">API<span class="glossary-tt">Application Programming Interface</span></span> to send the survey data to a real LP.</p>
<ul style="list-style-type: square;">
<li>Read through the Windows Sockets <span class="glossary">API<span class="glossary-tt">Application Programming Interface</span></span> (Specifically WinSock2)</li>
<li>Connect and send data to 127.0.0.1 port 27015 (<span class="glossary">TCP<span class="glossary-tt">Transport Control Protocol</span></span>)</li>
<li>Once verified, the <span class="glossary">LP<span class="glossary-tt">Listening Post</span></span> will send you "tasking" the tasking is the second half of the flag.</li>
</ul>
<p style="margin-left: 30.0px;"> </p>
</div></div>
<p> </p>
<h2><span style="color: rgb(0,51,102);">Challenge 8: <span class="glossary">PSP<span class="glossary-tt">Personal Security Product (Anti-Virus)</span></span> Evasion</span></h2>
<p><span style="color: rgb(0,51,102);"><br></span></p>
<div class="panel"><div class="rich-text-body">
<p>Since our code is malicious in nature, PSPs (personal security products) are looking for us. There are many different types of signatures that PSPs use to try to determine whether a binary is attempting to do something malicious. In many cases, we can evade detection by PSPs by understanding how they catch us and creating workarounds that accomplish the same tasks.</p>
<p><strong>Challenge 8</strong>: Modify the source of our program so it no longer is caught by the PSP</p>
<ul style="list-style-type: square;">
<li>Download the attached project, open and compile it.</li>
<li>Take the compiled release version of the binary and put it on the <span class="glossary">CTF<span class="glossary-tt">Capture the Flag</span></span> <span class="glossary">VM<span class="glossary-tt">Virtual Machine</span></span> and run it. Note that it is caught by Windows Defender immediately.</li>
<li>Modify the source (to complete the same goal), and bypass the Windows Defender sandbox.</li>
<li>Once you have passed all of the PSPs checks, running the program should cause your flag to appear.</li>
<li>Note: It is often simple to defeat PSPs. Especially if you can pinpoint what exactly it is they are flagging you for.</li>
</ul>
<p><a href="files/PSPEvasion.zip.pdf">PSPEvasion.zip</a></p>
</div></div>
<p> </p>
<h2><span style="color: rgb(0,51,102);">Challenge 9: Execution Vectors</span></h2>
<p><span style="color: rgb(0,51,102);"><br></span></p>
<div class="panel"><div class="rich-text-body">
<p>Gaining execution on a machine can be one of the most difficult aspects of a computer operation. Sometimes we'll have exploits that let us gain access without any target interaction and other times we will engineer scenarios in which we can bait the target into allowing us access.</p>
<p><strong>Challenge 9</strong>: In this scenario you will perform a <span class="glossary">DLL<span class="glossary-tt">Dynamic Link Library</span></span> Hijack on a portable third-party application.</p>
<ul style="list-style-type: square;">
<li>Grab a copy of the Sumatra <span class="glossary">PDF<span class="glossary-tt">Portable Document Format</span></span> application (attached)</li>
<li>Analyze the application using PEBear and/or ProcMon to find the vulnerable <span class="glossary">DLL<span class="glossary-tt">Dynamic Link Library</span></span> name (find a <span class="glossary">DLL<span class="glossary-tt">Dynamic Link Library</span></span> that is looked for in the local/current directory first and has only a few imports).</li>
<li>Generate your own <span class="glossary">DLL<span class="glossary-tt">Dynamic Link Library</span></span> to use as a hijack for the application.</li>
<li>Your <span class="glossary">DLL<span class="glossary-tt">Dynamic Link Library</span></span> should also drop and run C:\Test\CTF\DummyDLL.dll using the attached DummyDLL file. Run the <span class="glossary">DLL<span class="glossary-tt">Dynamic Link Library</span></span> by calling LoadLibrary inside of the Sumatra <span class="glossary">PDF<span class="glossary-tt">Portable Document Format</span></span> application.</li>
<li>Embed Dummy <span class="glossary">DLL<span class="glossary-tt">Dynamic Link Library</span></span> in your Hijack <span class="glossary">DLL<span class="glossary-tt">Dynamic Link Library</span></span> by placing it in the resources (Raptor) or as a byte array in a header file (Melomy).</li>
<li>Run the Sumatra <span class="glossary">PDF<span class="glossary-tt">Portable Document Format</span></span> application to receive your flag</li>
</ul>
<p><a href="files/SumatraPDF.exe">SumatraPDF.exe</a> | <a href="files/DummyDLL.dll">DummyDLL.dll</a></p>
</div></div>
<p> </p>
<h2><span style="color: rgb(0,51,102);">Challenge 10: Privilege Escalation</span></h2>
<p><span style="color: rgb(0,51,102);"><br></span></p>
<div class="panel"><div class="rich-text-body">
<p>Depending on our execution vector, the context our code is running in when we first gain access to a target may be at a privilege level that blocks us from doing things or obtaining information. That means that we'll need to pair our execution vector with another "exploit" to get us to the privilege level we need.</p>
<p><strong>Challenge 10</strong>: In this challenge you will be given background information that describes a vulnerability (known and unpatched by Microsoft) that allows you to bypass <span class="glossary">UAC<span class="glossary-tt">User Account Control</span></span> (go from User level privileges to Administrator level privileges without notifying the user). Use your new-found knowledge of the vulnerability to have your User privileged code gain Administrator privileges.</p>
<p style="margin-left: 30.0px;"> </p>
<p style="margin-left: 30.0px;">Background Information</p>
<p style="margin-left: 30.0px;"> </p>
<p style="margin-left: 60.0px;"><strong style="line-height: 1.4285;">UAC Bypasses</strong><span style="line-height: 1.4285;">: When working with <span class="glossary">UAC<span class="glossary-tt">User Account Control</span></span> Bypasses for Windows 7+ there are a couple of requirements for the target machine. The first requirement is that the user your code will be running as is an Administrator user (not limited, and not a guest), The second requirement is that the <span class="glossary">UAC<span class="glossary-tt">User Account Control</span></span> (User Account Control) level must be at default or below. You will note that both these things are true on the <span class="glossary">CTF<span class="glossary-tt">Capture the Flag</span></span> VM.</span></p>
<p> </p>
<div class="panel"><div class="rich-text-body"><p><img src="files/image2015-5-20&#32;12:8:8.png" align="center" width="500"><img src="files/image2015-5-20&#32;12:9:3.png" align="center" width="500"></p></div></div>
<p><br><br></p>
<p> </p>
<p style="margin-left: 30.0px;"> </p>
<p style="margin-left: 30.0px;"><strong>Auto-Elevated Processes</strong>: Since Windows Vista, Microsoft made modifications to the security process in an attempt to reduce the number of <span class="glossary">UAC<span class="glossary-tt">User Account Control</span></span> prompts. One of the ways it did this was by allowing some processes to be automatically elevated. These auto-elevated process were limited to a select few Microsoft processes. These process must be signed by a specific Microsoft certificate, must specify auto-elevation in their manifest, and must reside in a specific set of locations. When executed by the user, the processes automatically are given Administrator privileges. The user calling the process does not get a return handle to the process it just created (they didn't want to make it that easy).</p>
<p> </p>
<div class="panel"><div class="rich-text-body">
<p><img src="files/image2015-5-20&#32;12:15:0.png" align="center" width="700"></p>
<p> </p>
</div></div>
<p> </p>
<p style="margin-left: 30.0px;"><strong>Artillery</strong><br><br>To implement the Artillery <span class="glossary">UAC<span class="glossary-tt">User Account Control</span></span> Bypass (In-House name) we take advantage of the Windows Update Standalone Installer (wusa.exe). This is an auto-elevated process provided to us by Microsoft in System32. The wusa.exe allows for command line options, one of which allows you to extract a CAB file to an arbitrary location. With a little research, we have also discovered that if printui.exe (another auto-elevated process) is moved from System32 to another directory, it has a vulnerability in its <span class="glossary">DLL<span class="glossary-tt">Dynamic Link Library</span></span> loading process. When looking for CryptBase.dll the auto-elevate process looks in its local directory first before looking in System32. <br><br>Putting this together we know we can do the following to get the auto-elevated process to load our shim DLL:</p>
<ol>
<li style="margin-left: 30.0px;"><p>Write our shim to a user accessible location</p></li>
<li style="margin-left: 30.0px;"><p>Write a copy of printui.exe to a user accessible location</p></li>
<li style="margin-left: 30.0px;"><p>Call makecab to put each of these files into a cab format</p></li>
<li style="margin-left: 30.0px;"><p>Call wusa.exe to extract both files to System32\MUI</p></li>
<li style="margin-left: 30.0px;">
<p>Call System32\MUI\printui.exe</p>
<p><br><br><br></p>
</li>
</ol>
<p> </p>
<p>Now, to complete the challenge:</p>
<ul style="list-style-type: square;">
<li>Download a copy of the "Shim" DLL</li>
<li>Embed the shim in your tool - Keep it as a byte array in a header file (Melomy) or in your binary's resources (Raptor)</li>
<li>Using your knowledge of the vulnerability, move the shim and any other required files to there appropriate locations</li>
<li>Execute the privilege escalation to see your flag.</li>
</ul>
<p> </p>
<p><a href="files/PrivEscShim.dll.pdf">PrivEscShim.dll</a></p>
</div></div>
<p> </p>
<p> </p>
<h2><span style="color: rgb(0,51,102);">Finishing Up</span></h2>
<p>As we go on, we remember, all the time we...</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<div class="warning"><p style="text-align: center;"><strong>SECRET//NOFORN</strong></p></div>
                    </div>
                </div>
            </div>

            <script type="text/javascript" src="../../highlighter/mootools-core-and-more.js"></script>
            <script type="text/javascript" src="../../highlighter/efatmarker.min.js"></script>
            <div id="efm-button">
            <div id="efm-menu">
                <h3 style="margin:0 0 2px 0">e-Highlighter</h3>
                <a id="efm-permalink" class="efm-need-highlight" href="page_20251001.html" style="margin-bottom:0;padding-bottom:0;"></a>
                <p style="margin-top:0;padding-top:0" class="efm-need-highlight">Click to send permalink to address bar, or right-click to copy permalink.</p>
                <p style="margin:0.5em 0;padding:0;border-top:1px dotted #ccc;height:1px"></p>
                <a id="efm-unhighlightall" class="efm-need-highlight">Un-highlight all</a>
                <a id="efm-unhighlight">Un-highlight selection<span>u</span></a>
                <a id="efm-highlight">Highlight selection<span>h</span></a>
                </div>
            </div>
            <script type="text/javascript">

            (function(){
            window.addEvent('domready', function(){

                var markerButton = $('efm-button');
                if ( markerButton ) {
                    eMarker = new EFatMarker($('uniquer'));
                    eMarker.tokenToSpans(); // apply whatever token is there
                    // need to act on mousedown or else selection disappear
                    markerButton.addEvent('mousedown', function(){
                        eMarker.interpretSelection(true);
                        return false;
                    });
                    $('efm-unhighlightall').addEvent('mousedown', function(){
                        eMarker.unhighlightAll(true);
                        return false;
                        });
                    $('efm-unhighlight').addEvent('mousedown', function(){
                        eMarker.unhighlightSelection(true);
                        return false;
                        });
                    $('efm-highlight').addEvent('mousedown', function(){
                        eMarker.highlightSelection(true);
                        return false;
                        });
                    $('efm-permalink').addEvent('mousedown', function(){
                        window.location.href = this.href;
                        return false;
                        });
                    // if Mootools Keyboard is available, use it
                    if (Keyboard) {
                        var keyboard = new Keyboard({
                            defaultEventType: 'keyup',
                            events: {
                                'h': function(){
                                    eMarker.highlightSelection(true);
                                    },
                                'u': function(){
                                    eMarker.unhighlightSelection(true);
                                    }
                                }
                            });
                        keyboard.activate();
                        }
                    eMarker.syncDOM();
                    // auto scroll to first highlight, if any
                    if (eMarker.hasSpans()) {
                        var scroll = new Fx.Scroll(window,{offset:{'x':0,'y':-100}}),
                            highlights = $$('#uniquer .efm-hi');
                        if (highlights.length > 0) {
                            scroll.toElement(highlights[0]);
                            }
                        }
                    }
                });
            })();
            </script>
            

<link href="../../static/css/styles_footer.css" rel="stylesheet">
<footer id="page-footer" class="footer-recommendations">
  <div class="footer-wrapper">
    <div class="recommendation-container">
      <a href="page_20251001.html#" class="top">Top</a>
      
        <ul class="recommendation-links">
          
            <li class="recommendation">
              <a href="https://www.torproject.org/" target="_blank">
                <div class="teaser"><img class="spip_logos" alt="" src="../../IMG/arton401.png?1461924517" width="300" height="180" /></div>
                <p>
<p>Tor is an encrypted anonymising network that makes it harder to intercept internet communications, or see where communications are coming from or going to.</p>
</p>
              </a>
            </li>
          
            <li class="recommendation">
              <a href="https://tails.boum.org/" target="_blank">
                <div class="teaser"><img class="spip_logos" alt="" src="../../IMG/arton405.png?1461924517" width="446" height="223" /></div>
                <p>
<p>Tails is a live operating system, that you can start on almost any computer from a DVD, USB stick, or SD card. It aims at preserving your privacy and anonymity.</p>
</p>
              </a>
            </li>
          
            <li class="recommendation">
              <a href="https://www.couragefound.org/" target="_blank">
                <div class="teaser"><img class="spip_logos" alt="" src="../../IMG/arton404.png?1461924517" width="357" height="50" /></div>
                <p>
<p>The Courage Foundation is an international organisation that supports those who risk life or liberty to make significant contributions to the historical record.</p>
</p>
              </a>
            </li>
          
            <li class="recommendation">
              <a href="https://www.bitcoin.org/" target="_blank">
                <div class="teaser"><img class="spip_logos" alt="" src="../../IMG/arton403.png?1461924517" width="300" height="64" /></div>
                <p>
<p>Bitcoin uses peer-to-peer technology to operate with no central authority or banks; managing transactions and the issuing of bitcoins is carried out collectively by the network.</p>
</p>
              </a>
            </li>
          
        </ul>
      
      <ul class="social-links">
        <li>
          <a href="https://www.facebook.com/wikileaks" target="_blank" alt="Facebook">
            <img src="../../static/img/fb-logo.png" alt="Facebook" title="Facebook page" />
          </a>
        </li>
        <li>
          <a href="https://twitter.com/wikileaks" target="_blank" alt="Twitter">
            <img src="../../static/img/twitter-logo.png" alt="Twitter" title="Twitter page" />
          </a>
        </li>
      </ul>
    </div>
  </div>
</footer>

        </div>

        <script src="../../bootstrap/js/jquery.min.js"></script>
        <script type="text/javascript">
        var $j = jQuery.noConflict();
        </script>
        <script src="../../bootstrap/js/bootstrap.min.js"></script>
    </body>
</html>
